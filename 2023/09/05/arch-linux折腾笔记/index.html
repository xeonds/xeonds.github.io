<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Arch Linux折腾笔记 - 神社的储物间</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="神社的储物间"><meta name="msapplication-TileImage" content="/img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="神社的储物间"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Btw I use arch.jpg"><meta property="og:type" content="blog"><meta property="og:title" content="Arch Linux折腾笔记"><meta property="og:url" content="https://mxts.jiujiuer.xyz/2023/09/05/arch-linux%E6%8A%98%E8%85%BE%E7%AC%94%E8%AE%B0/"><meta property="og:site_name" content="神社的储物间"><meta property="og:description" content="Btw I use arch.jpg"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://mxts.jiujiuer.xyz/img/89596288_p0_master1200.jpg"><meta property="article:published_time" content="2023-09-05T13:39:57.000Z"><meta property="article:modified_time" content="2025-03-15T13:28:39.210Z"><meta property="article:author" content="xeonds"><meta property="article:tag" content="Linux"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://mxts.jiujiuer.xyz/img/89596288_p0_master1200.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://mxts.jiujiuer.xyz/2023/09/05/arch-linux%E6%8A%98%E8%85%BE%E7%AC%94%E8%AE%B0/"},"headline":"Arch Linux折腾笔记","image":["https://mxts.jiujiuer.xyz/img/89596288_p0_master1200.jpg"],"datePublished":"2023-09-05T13:39:57.000Z","dateModified":"2025-03-15T13:28:39.210Z","author":{"@type":"Person","name":"xeonds"},"publisher":{"@type":"Organization","name":"神社的储物间","logo":{"@type":"ImageObject","url":"https://mxts.jiujiuer.xyz/img/favicon.ico"}},"description":"Btw I use arch.jpg"}</script><link rel="canonical" href="https://mxts.jiujiuer.xyz/2023/09/05/arch-linux%E6%8A%98%E8%85%BE%E7%AC%94%E8%AE%B0/"><link rel="alternate" href="/atom.xml" title="神社的储物间" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Oxanium:wght@300;400;600&amp;family=Roboto+Mono"><link rel="stylesheet" href="/css/cyberpunk.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?59fd9f709f6626bf608f0b08415e0283";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/favicon.ico" alt="神社的储物间" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archive</a><a class="navbar-item" href="/categories">Category</a><a class="navbar-item" href="/tags">Tag</a><a class="navbar-item" href="/links">Link</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="My GitHub" href="https://github.com/xeonds"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="/img/89596288_p0_master1200.jpg" alt="Arch Linux折腾笔记"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-09-05T13:39:57.000Z" title="9/5/2023, 1:39:57 PM">2023-09-05</time>发表</span><span class="level-item"><time dateTime="2025-03-15T13:28:39.210Z" title="3/15/2025, 1:28:39 PM">2025-03-15</time>更新</span><span class="level-item"> xeonds </span><span class="level-item">1 小时读完 (大约12303个字)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">Arch Linux折腾笔记</h1><div class="content"><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>参考 Arch Wiki 或者参考这个简化版教程：<a target="_blank" rel="noopener" href="https://arch.icekylin.online/">https://arch.icekylin.online/</a>。过程按照教程一步步折腾就ok，只要注意区分清楚各个分区，别不小心把数据分区给格式化了就行。联网是安装Arch的必须项，所以请保持网络畅通。另外，建议<strong>安装镜像最好在安装完成后继续保留着</strong>，应急情况下（比如滚挂了）可以用<code>arch-chroot</code>来应急重装内核之类的。</p>
<blockquote>
<p>至于Arch经常被吐槽滚挂了的原因，主要是源自Arch的更新策略比较激进，更新完成后，会直接删除老内核，比起一般的更新策略更容易出现依赖问题造成“滚挂了“。</p>
</blockquote>
<p>桌面环境、cn源、透明代理之类的配置，也可以参考上面的教程。关于透明代理，也可以参考<a target="_blank" rel="noopener" href="https://blog.linioi.com/posts/clash-on-arch/">这篇文章</a>。</p>
<h3 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h3><ul>
<li>为了使用timeshift恢复时正常启动，建议删除&#x2F;etc&#x2F;fstab里的subvolid部分：<code>sudo sed -i -E &#39;s/(subvolid=[0-9]+,)|(,subvolid=[0-9]+)//g&#39; /etc/fstab</code></li>
</ul>
<h2 id="美化"><a href="#美化" class="headerlink" title="美化"></a>美化</h2><p>这点上因人而异。我装了layan主题之后，再换个壁纸，装个latte就差不多了。我的原则是，美化差不多就行，但是前提是别影响到系统性能。</p>
<h3 id="稍微详细点"><a href="#稍微详细点" class="headerlink" title="稍微详细点"></a>稍微详细点</h3><p>首先是图标主题，这两个我是Tela+Layan；其次是上下两个任务栏，都设置了：</p>
<ul>
<li>Alignment-Center</li>
<li>Width-Fill width&#x2F;Center</li>
<li>Opacity-Translucent</li>
<li>Style-Floating</li>
</ul>
<p>上面的任务栏用spacer分为了三段，左边单独一个Global Menu，中间一堆仪表盘，右边System Tray；下面的部分，用Latte Seperator分割三段，左边Application Dashbaord，中间Icons-only Task Manager，右边PlasMusic Toolbar。</p>
<p>壁纸可以用静态壁纸，也可以用视频当视频壁纸。</p>
<p>完成之后效果应该不错。</p>
<h2 id="显示适配"><a href="#显示适配" class="headerlink" title="显示适配"></a>显示适配</h2><p>单显示器的配置很简单，改下dpi缩放就基本ok。如果是多显示器的话，就会复杂一些。参考下面的公式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 假设HiDPI显示器的分辨率是AxB，普通分辨率显示器的分辨率是CxD </span></span><br><span class="line"><span class="comment"># 并且外置显示器的缩放比率是ExF</span></span><br><span class="line">xrandr --output eDP-1 --auto --output HDMI-1 --auto --panning [C*E]x[D*F]+[A]+0 --scale [E]x[F] --right-of eDP-1</span><br></pre></td></tr></table></figure>

<p>根据上面的公式来设置，基本上能搞定。当然，如果想调整的是内置HiDPI显示器分辨率，就得调整最后<code>panning</code>的A为Ax[A的缩放比率]。</p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul>
<li><input checked="" disabled="" type="checkbox"> <a target="_blank" rel="noopener" href="https://nmgit.net/2020/139/">Barry的笔记</a></li>
<li>[2] <a target="_blank" rel="noopener" href="https://harttle.land/2019/12/24/auto-xrandr.html">X11 多显示器配置：玩转 XRandR</a></li>
</ul>
<h2 id="pacman入门"><a href="#pacman入门" class="headerlink" title="pacman入门"></a>pacman入门</h2><p>问了问GPT，大概做了下笔记如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Sy                     <span class="comment"># 更新软件包数据库</span></span><br><span class="line">sudo pacman -S package_name         <span class="comment"># 安装软件包，可批量安装</span></span><br><span class="line">sudo pacman -R package_name         <span class="comment"># 删除软件包但保留配置</span></span><br><span class="line">sudo pacman -Rn package_name        <span class="comment"># 删除包和配置</span></span><br><span class="line">sudo pacman -Syu                    <span class="comment"># 升级所有已安装的包</span></span><br><span class="line">sudo pacman -Sc                     <span class="comment"># 清理pacman缓存的旧包</span></span><br><span class="line">sudo pacman -Ss search_term         <span class="comment"># 查找软件包</span></span><br><span class="line">sudo pacman -Si package_name        <span class="comment"># 查找软件包信息</span></span><br><span class="line">sudo pacman -Rns $(pacman -Qdtq)    <span class="comment"># 删除未使用依赖包</span></span><br></pre></td></tr></table></figure>

<p>另外，<code>Syu</code>和<code>Syyu</code>的区别在于后者强制刷新了软件仓库缓存。后者虽然更新比较及时，但是用得多对于软件源仓库并不友好，而且浪费资源，不宜过于频繁使用。</p>
<p>最底下那个移除孤儿包的操作少用，用的时候手动确认是否包括重要依赖。</p>
<p>另外还有个操作，就是完整备份安装过的包列表，然后在新的系统上重新安装，这个用<code>pacman</code>可以做到。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pacman -Qqe &gt; installed_packages.txt                <span class="comment"># 备份当前系统上所有已经明确安装的包</span></span><br><span class="line">sudo pacman -S --needed - &lt; installed_packages.txt  <span class="comment"># 只安装其中没有安装过的包</span></span><br></pre></td></tr></table></figure>

<p>不过使用这个操作的时候，记得得保证清单的实时性，因为arch滚动更新，系统一直是新的，备份列表太久没更新的话在新系统上安装会有依赖，兼容等等问题。</p>
<h2 id="启用外部ssh连接"><a href="#启用外部ssh连接" class="headerlink" title="启用外部ssh连接"></a>启用外部ssh连接</h2><p>如果想从外部连接到Arch的电脑上，只要安装了openssh就行。Arch默认不会启动<code>sshd</code>，所以我们得手动开启：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start sshd</span><br></pre></td></tr></table></figure>
<h2 id="在命令行连接Wi-Fi"><a href="#在命令行连接Wi-Fi" class="headerlink" title="在命令行连接Wi-Fi"></a>在命令行连接Wi-Fi</h2><p>在完成安装后，启动NetworkManager：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> --now NetworkManager</span><br></pre></td></tr></table></figure>

<p>然后使用<code>nmcli</code>来连接Wi-Fi：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nmcli dev wifi list</span><br><span class="line"><span class="comment"># 后面的password部分不指定的话，会自动要求输入</span></span><br><span class="line">nmcli dev wifi connect <span class="string">&quot;SSID&quot;</span> password <span class="string">&quot;password&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="使用TimeShift备份系统"><a href="#使用TimeShift备份系统" class="headerlink" title="使用TimeShift备份系统"></a>使用TimeShift备份系统</h2><p>TimeShift是一个很好用的系统备份软件，特别是结合了btrfs之后，备份的体积比借助<code>rsync</code>时更小。</p>
<p>折腾系统时不时可能滚挂，这种时候有个定期创建的映像就很有用了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo timeshift --list <span class="comment"># 获取快照列表</span></span><br><span class="line">sudo timeshift --restore --snapshot <span class="string">&#x27;20XX-XX-XX_XX-XX-XX&#x27;</span> --skip-grub <span class="comment"># 选择一个快照进行还原，并跳过 GRUB 安装，一般来说 GRUB 不需要重新安装</span></span><br></pre></td></tr></table></figure>

<p>如果恢复后无法使用，用安装盘通过<code>arch-chroot</code>进去系统，然后手动更改<code>subvolid</code>来手动修复，或者直接删除<code>subvolid</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取subvolid</span></span><br><span class="line">sudo btrfs sub list -u /</span><br><span class="line"><span class="comment"># 编辑,根据自己情况，修复</span></span><br><span class="line">vim /etc/fstab</span><br></pre></td></tr></table></figure>

<h2 id="重启显示管理器（Xorg-x2F-Wayland）"><a href="#重启显示管理器（Xorg-x2F-Wayland）" class="headerlink" title="重启显示管理器（Xorg&#x2F;Wayland）"></a>重启显示管理器（Xorg&#x2F;Wayland）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart display-manager</span><br></pre></td></tr></table></figure>

<h2 id="Vim"><a href="#Vim" class="headerlink" title="Vim"></a>Vim</h2><p>装上Arch之后我很快就把Vim装上了。结果发现没法和系统剪贴板联动。在Vim里边检查<code>has(clipboard)</code>之后发现，好像这个Vim不支持剪贴板。</p>
<p>解决方法：装<code>gvim</code>：<code>sudo pacman -S gvim</code>。会提示你是否卸载Vim，选是，配置不会删除所以放心删。安装完了之后你就会发现Vim还能用，而且剪贴板功能好了：</p>
<p><img src="/img/Pasted%20image%2020230926210217.png"></p>
<h2 id="桌面目录映射"><a href="#桌面目录映射" class="headerlink" title="桌面目录映射"></a>桌面目录映射</h2><p>今天看到群里一个老哥家目录下的文件都堆到桌面了，顺便了解了一下关于桌面目录映射的问题。因为有时候中文模式创建的家目录下的文件夹都是中文，那个老哥就是改成英文目录的时候遇到了这个问题。</p>
<p><code>XDG_DESKTOP_DIR</code>这个环境变量的介绍，在archWiki上也能翻到。</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/XDG_Base_Directory">XDG_DESKTOP_DIR是一个环境变量，用于指定用户的桌面文件夹的位置。它是XDG Base Directory规范</a><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/XDG_Base_Directory">1</a><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/XDG_user_directories">的一部分，该规范定义了一些标准的用户目录，如音乐、图片、下载等，以及一些用于存储配置、缓存、数据和状态的目录。XDG_DESKTOP_DIR的默认值是$HOME&#x2F;Desktop，但用户可以通过编辑~&#x2F;.config&#x2F;user-dirs.dirs文件或使用xdg-user-dirs-update命令来修改它</a><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/XDG_user_directories">2</a>。</p>
<p><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Desktop_entries">KDE桌面环境遵循XDG Base Directory规范，并使用XDG_DESKTOP_DIR变量来确定桌面文件夹的位置。如果用户更改了XDG_DESKTOP_DIR的值，KDE会自动更新桌面设置，并将桌面文件夹更改为新的位置。这样，用户可以灵活地管理自己的桌面文件夹，而不影响其他应用程序或桌面环境</a><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Desktop_entries">3</a>。</p>
</blockquote>
<p>所以出问题的话看看<code>.config</code>底下配置炸没炸就行。</p>
<h2 id="添加多系统启动项"><a href="#添加多系统启动项" class="headerlink" title="添加多系统启动项"></a>添加多系统启动项</h2><p>在安装Arch的时候，会发现中间有一步是<code>sudo vim /etc/default/grub</code>然后<code>grub-mkconfig -o /boot/grub/grub.cfg</code>。这一步就是先编辑grub的配置，然后生成grub文件到<code>/boot/grub/</code>下的配置文件中。因此，我们如果突然心血来潮想装个Windows玩玩<del>谁装啊</del>，就可以改改grub配置让它为我们添加启动项。</p>
<p>因为最终的配置项是由<code>grub-mkconfig</code>生成的，所以并不推荐直接修改这个文件。更好的做法是安装<code>os-prober</code>，然后挂载其他系统的分区，并编辑grub配置文件启用os探测，最后再用<code>grub-mkconfig</code>生成新的grub启动项文件。</p>
<blockquote>
<p>至于为啥grub现在默认禁用掉了os-prober，注释里边说的是因为安全问题所以禁用掉了。</p>
</blockquote>
<h2 id="代理配置"><a href="#代理配置" class="headerlink" title="代理配置"></a>代理配置</h2><p>既然都上Arch了，那代理软件不得整个自由点的？直接扔了cfw，拥抱clash-core。具体配置教程参考<a target="_blank" rel="noopener" href="https://blog.linioi.com/posts/clash-on-arch/">这篇</a>，我给个简洁版的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 实在懒得sudo了</span></span><br><span class="line"><span class="comment"># 不过记得看清命令再回车</span></span><br><span class="line">sudo su</span><br><span class="line">pacman -S clash</span><br><span class="line"><span class="built_in">mkdir</span> -p /etc/clash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 然后从provider那里下载yaml配置文件</span></span><br><span class="line"><span class="comment"># 假设文件名为config.yaml</span></span><br><span class="line"><span class="built_in">mv</span> ./config.yaml /etc/clash/</span><br><span class="line"><span class="comment"># 设置控制面板路径</span></span><br><span class="line"><span class="comment"># 我这里的控制面板路径在/etc/clash/clash-dashboard</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;external-ui: clash-dashboard&#x27;</span> &gt;&gt; /etc/clash/config.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置环境变量，配完了记得重启/重新登陆一下</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt;&gt; /etc/environment</span></span><br><span class="line"><span class="string">https_proxy=http://127.0.0.1:7890</span></span><br><span class="line"><span class="string">http_proxy=http://127.0.0.1:7890</span></span><br><span class="line"><span class="string">all_proxy=http://127.0.0.1:7890</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置systemd服务项</span></span><br><span class="line"><span class="comment"># 配完了就能开机自启动了哦</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt; /etc/systemd/system/clash.service</span></span><br><span class="line"><span class="string">[Unit]</span></span><br><span class="line"><span class="string">Description=Clash daemon, A rule-based proxy in Go.</span></span><br><span class="line"><span class="string">After=network.target</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Service]</span></span><br><span class="line"><span class="string">Type=simple</span></span><br><span class="line"><span class="string">Restart=always</span></span><br><span class="line"><span class="string">ExecStart=/usr/bin/clash -d /etc/clash # /usr/bin/clash 为绝对路径，请根据你实际情况修改</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Install]</span></span><br><span class="line"><span class="string">WantedBy=multi-user.target</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###############</span></span><br><span class="line"><span class="comment"># clash，启动！</span></span><br><span class="line"><span class="comment">###############</span></span><br><span class="line">systemctl <span class="built_in">enable</span> --now clash.service</span><br></pre></td></tr></table></figure>

<p>里边比较重要的一步是配置环境变量env，上回配置的时候忘了加<code>http</code>前缀，结果系统里边啥玩意都不认我的代理设置。</p>
<p>哦对，配置完成之后还得在系统里边设置好代理：</p>
<p><img src="/img/Pasted%20image%2020231023164736.png"></p>
<blockquote>
<p>悲：cfw跑路之后clash-core也跑路了<br>然后所有client都跑路了<br>为clash家族 + 1s<br>以及我的评价是：<br><img src="/img/Pasted%20image%2020231103203831.png"><br>以及某作者的睿频：<br>最适合这个民族的其实是一群小<br>白围着大大转，大大通过小白的夸奖获得自我满足，然后小白的吃喝拉撒都包给大大解决的模式。通过这个项目我感觉我已经彻底认识到这个民族的前面为什么会有一堵墙了。没有墙哪来的大大。所以到处都是什么附件回帖可见，等级多少用户组可见，一个论坛一个大大供小白跪舔，不需要政府造墙，网民也会自发造墙。这尼玛连做个翻墙软件都要造墙，真是令人叹为观止。这是一个造了几干年墙的保守的农耕民族，缺乏对别人的基本尊重，不愿意分享，喜欢遮遮掩掩，喜欢小圈子抱团，大概这些传统是改不掉了吧。</p>
</blockquote>
<p>另外还有一个，就是切换节点必须得使用clash的控制端口（在<code>config.yaml</code>中给出，一般是<code>9090</code>），所以还必须得有个控制面板。一般Windows平台都是用<del>已经似了的</del>Clash For Windows作为控制面板的，而Linux这边使用<a target="_blank" rel="noopener" href="https://clash.razord.top/">https://clash.razord.top/</a>也就是<del>也已经似了的</del><a target="_blank" rel="noopener" href="https://github.com/Dreamacro/clash-dashboard/">Clash的官方控制面板</a>作为控制面板的。实在不行了可以用命令行下的TUI工具<code>clashctl</code>来手动切换节点，应该也能用。</p>
<h3 id="eXtended：通过RESTfulAPI操作clash-core"><a href="#eXtended：通过RESTfulAPI操作clash-core" class="headerlink" title="eXtended：通过RESTfulAPI操作clash-core"></a>eXtended：通过RESTfulAPI操作clash-core</h3><p>研究一下<code>clash-dashboard</code>和<code>clash</code>的源代码就能看得出来了。其他的我就不说了，这里只说最常用的几个操作：</p>
<ul>
<li>节点列表 <code>GET http://localhost:9097/providers/proxies</code></li>
<li>切换节点 <code>PUT http://localhost:9097/proxies/组名 name=节点名</code></li>
<li>测速 <code>GET http://localhost:9097/proxies/节点名/delay</code></li>
<li>Clash版本 <code>GET http://localhost:9097/version</code></li>
</ul>
<p>一个简单的cli实现：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">BASE_URL=<span class="string">&quot;http://localhost:9097&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">get_proxies</span></span>() &#123;</span><br><span class="line">    curl -s <span class="string">&quot;<span class="variable">$&#123;BASE_URL&#125;</span>/providers/proxies&quot;</span> | jq .</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">switch_proxy</span></span>() &#123;</span><br><span class="line">    <span class="built_in">local</span> group_name=<span class="variable">$1</span></span><br><span class="line">    <span class="built_in">local</span> node_name=<span class="variable">$2</span></span><br><span class="line">    curl -s -X PUT -d <span class="string">&quot;name=<span class="variable">$&#123;node_name&#125;</span>&quot;</span> <span class="string">&quot;<span class="variable">$&#123;BASE_URL&#125;</span>/proxies/<span class="variable">$&#123;group_name&#125;</span>&quot;</span> | jq .</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">get_delay</span></span>() &#123;</span><br><span class="line">    <span class="built_in">local</span> node_name=<span class="variable">$1</span></span><br><span class="line">    curl -s <span class="string">&quot;<span class="variable">$&#123;BASE_URL&#125;</span>/proxies/<span class="variable">$&#123;node_name&#125;</span>/delay&quot;</span> | jq .</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">get_clash_version</span></span>() &#123;</span><br><span class="line">    curl -s <span class="string">&quot;<span class="variable">$&#123;BASE_URL&#125;</span>/version&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="keyword">in</span></span><br><span class="line">    list)</span><br><span class="line">        get_proxies</span><br><span class="line">        ;;</span><br><span class="line">    switch)</span><br><span class="line">        <span class="keyword">if</span> [[ -z <span class="string">&quot;<span class="variable">$2</span>&quot;</span> || -z <span class="string">&quot;<span class="variable">$3</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">echo</span> <span class="string">&quot;Usage: <span class="variable">$0</span> switch &lt;group_name&gt; &lt;node_name&gt;&quot;</span></span><br><span class="line">            <span class="built_in">exit</span> 1</span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        switch_proxy <span class="string">&quot;<span class="variable">$2</span>&quot;</span> <span class="string">&quot;<span class="variable">$3</span>&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">    delay)</span><br><span class="line">        <span class="keyword">if</span> [[ -z <span class="string">&quot;<span class="variable">$2</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">echo</span> <span class="string">&quot;Usage: <span class="variable">$0</span> delay &lt;node_name&gt;&quot;</span></span><br><span class="line">            <span class="built_in">exit</span> 1</span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        get_delay <span class="string">&quot;<span class="variable">$2</span>&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">    version)</span><br><span class="line">        get_clash_version</span><br><span class="line">        ;;</span><br><span class="line">    *)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Usage: <span class="variable">$0</span> &#123;list|switch|delay|version&#125;&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">        ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>

<h3 id="FAQ-常见代理连接失败问题"><a href="#FAQ-常见代理连接失败问题" class="headerlink" title="FAQ:常见代理连接失败问题"></a>FAQ:常见代理连接失败问题</h3><ul>
<li>检查本机时间是否同步：<code>sudo timedatectl set-ntp true</code></li>
<li>检查ISP提供的配置文件是否失效</li>
<li>检查本地互联网连接</li>
</ul>
<h2 id="RDP连接Windows"><a href="#RDP连接Windows" class="headerlink" title="RDP连接Windows"></a>RDP连接Windows</h2><p>用Arch多了，有时候得偶尔远程一下Windows。配置了半天<code>Remmina</code>+<code>freerdp</code>，可能这玩意和我风水不合吧，半天跑不起来。遂尝试了下<code>rdesktop</code>，秒连（也不知道为啥）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S rdesktop</span><br><span class="line">rdesktop 114.5.1.4</span><br></pre></td></tr></table></figure>

<p>然后输账号密码登陆就行了。因为暂时这样就够用所以就没咋折腾。</p>
<h2 id="scrcpy连接android"><a href="#scrcpy连接android" class="headerlink" title="scrcpy连接android"></a>scrcpy连接android</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S scrcpy</span><br><span class="line">adb connect 114.5.1.4:1919</span><br><span class="line">scrcpy</span><br></pre></td></tr></table></figure>

<p>测试延迟相当低，比各家的流转效果都好。支持键盘和鼠标输入。</p>
<h2 id="X11迁移Wayland"><a href="#X11迁移Wayland" class="headerlink" title="X11迁移Wayland"></a>X11迁移Wayland</h2><p>主要动机：支持一下双屏不同缩放的功能，不然一个高分屏+一个普通1080p的组合太痛苦了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pacman -Qi wayland  <span class="comment"># 已安装则继续，否则安装</span></span><br><span class="line">sudo pacman -S --needed wayland</span><br><span class="line">yay -S sddm-git     <span class="comment"># 必须得是sddm-git，其他版本好像没完善的Wayland支持</span></span><br><span class="line">pacman -S --needed xorg-xwayland xorg-xlsclients qt5-wayland glfw-wayland</span><br><span class="line">pacman -S --needed plasma kde-applications</span><br><span class="line">pacman -S --needed plasma-wayland-session</span><br></pre></td></tr></table></figure>
<p>按照<a target="_blank" rel="noopener" href="https://linux.cn/article-16171-1.html">这里</a>给出的流程，装完上面的包之后，Logout之后应该就能在左下角看到登陆<code>Plasma(Wayland)</code>的提示了。</p>
<blockquote>
<p>你还能通过查看 <code>$XDG_SESSION_TYPE</code> 变量来 核实你是否在运行 <code>Wayland</code>。</p>
</blockquote>
<p>先去装了，一会回来记录。</p>
<p>装完了，兼容性没啥大问题，我甚至没重启，只是重新登陆了下。就是<code>latte-dock</code>的图标缩放看着怪怪的，而且桌面小组件也乱飞了。以及，输入法好像不太对劲，在firefox以外的地方皮肤会丢失。</p>
<p>刚重新设置了下屏幕排列，现在能单独设置两块屏幕的缩放了，爽。就是高分屏看着有点糊，以及字体缩放问题，还有这个fcitx也不太对劲。</p>
<p>关于fcitx，系统给了一段报错：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Fcitx should be launched by KWin under KDE Wayland in order to use Wayland input method frontend. This can improve the experience when using Fcitx on Wayland. To configure this, you need to go to &quot;System Settings&quot; -&gt; &quot;Virtual keyboard&quot; and select &quot;Fcitx 5&quot; from it. You may also need to disable tools that launches input method, such as imsettings on Fedora, or im-config on Debian/Ubuntu. For more details see https://fcitx-im.org/wiki/Using_Fcitx_5_on_Wayland#KDE_Plasma </span><br></pre></td></tr></table></figure>

<p>先重启下看看吧。</p>
<p>草了，重启回来变回x11 seession了。找找默认值在哪保存着吧。</p>
<p>找到了，在<code>/usr/lib/sddm/sddm.conf.d/default.conf</code>里边，有一个<code>DisplayServer=x11</code>的项，把<code>x11</code>改为<code>wayland</code>应该就行了。重启看看。</p>
<p>好像不太行，而且现在切不过去Wayland了，坏。</p>
<p>把设置都改回去了，现在好像能进去了。但是还是默认进入x11的plasma桌面。</p>
<p>哎，把用户空间的那个sddm configuration改了一下，删了里边的[Autologin]底下的session&#x3D;的值，重启下试试。以及又得到了一段关于fcitx的建议：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Detect GTK_IM_MODULE and QT_IM_MODULE being set and Wayland Input method frontend is working. It is recommended to unset GTK_IM_MODULE and QT_IM_MODULE and use Wayland input method frontend instead. For more details see https://fcitx-im.org/wiki/Using_Fcitx_5_on_Wayland#KDE_Plasma</span><br></pre></td></tr></table></figure>

<p>好好好搞定了。按照上面的设置先屏蔽了俩环境变量，然后删除了默认值，现在系统已经处于完全可用的状态。回头有时间了整理整理过程。</p>
<blockquote>
<p>Fri 22 Dec 2023 05:14:55 PM CST</p>
</blockquote>
<p>编辑：这个选项不用在命令行里修改，直接去系统设置里边的<code>Startup nad shutdown-&gt;Login Screen-&gt;Behavior</code>里边修改<code>...with session = </code>的选项就行了。</p>
<h2 id="又出问题了"><a href="#又出问题了" class="headerlink" title="又出问题了"></a>又出问题了</h2><p>小笔记本上的arch的kde以至于其中的所有程序突然都变得特别卡。最奇怪的是这会的系统资源专用状况完全没有多高，CPU%，MEM37.4%的占用率应该很健康了吧。</p>
<p>觉得的卡顿是因为我发现就连tmux里边开个vim写文档都卡得不行了才觉得不对劲。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">systemd-+-NetworkManager</span><br><span class="line">        |-bluetoothd</span><br><span class="line">        |-clash</span><br><span class="line">        |-dbus-daemon</span><br><span class="line">        |-polkitd</span><br><span class="line">        |-rtkit-daemon</span><br><span class="line">        |-sddm-+-Xorg</span><br><span class="line">        |      `-sddm-helper---startplasma-x11</span><br><span class="line">        |-systemd-+-(sd-pam)</span><br><span class="line">        |         |-adb</span><br><span class="line">        |         |-agent</span><br><span class="line">        |         |-at-spi-bus-laun---dbus-daemon</span><br><span class="line">        |         |-at-spi2-registr</span><br><span class="line">        |         |-chrome_crashpad</span><br><span class="line">        |         |-dbus-daemon</span><br><span class="line">        |         |-dconf-service</span><br><span class="line">        |         |-fcitx5</span><br><span class="line">        |         |-gmenudbusmenupr</span><br><span class="line">        |         |-gvfs-udisks2-vo</span><br><span class="line">        |         |-gvfsd-+-gvfsd-dnssd</span><br><span class="line">        |         |       |-gvfsd-network</span><br><span class="line">        |         |       `-gvfsd-trash</span><br><span class="line">        |         |-gvfsd-fuse</span><br><span class="line">        |         |-gvfsd-metadata</span><br><span class="line">        |         |-kaccess</span><br><span class="line">        |         |-kactivitymanage</span><br><span class="line">        |         |-kded5</span><br><span class="line">        |         |-kglobalaccel5</span><br><span class="line">        |         |-konsole---bash---tmux: client</span><br><span class="line">        |         |-krunner---qq-+-qq---qq</span><br><span class="line">        |         |              |-qq---2*[qq]</span><br><span class="line">        |         |              `-qq</span><br><span class="line">        |         |-kscreen_backend</span><br><span class="line">        |         |-ksmserver---DiscoverNotifie</span><br><span class="line">        |         |-ksystemstats</span><br><span class="line">        |         |-kwalletd5</span><br><span class="line">        |         |-kwin_x11</span><br><span class="line">        |         |-latte-dock</span><br><span class="line">        |         |-linuxqq</span><br><span class="line">        |         |-obexd</span><br><span class="line">        |         |-org_kde_powerde</span><br><span class="line">        |         |-pipewire</span><br><span class="line">        |         |-pipewire-media-</span><br><span class="line">        |         |-plasmashell---crow</span><br><span class="line">        |         |-polkit-kde-auth</span><br><span class="line">        |         |-pulseaudio---gsettings-helpe</span><br><span class="line">        |         |-tmux: server-+-2*[bash---vim]</span><br><span class="line">        |         |              `-bash---sudo---sudo---pstree</span><br><span class="line">        |         |-2*[xdg-desktop-por]</span><br><span class="line">        |         |-xdg-document-po---fusermount3</span><br><span class="line">        |         |-xdg-permission-</span><br><span class="line">        |         `-xembedsniproxy</span><br><span class="line">        |-systemd-journal</span><br><span class="line">        |-systemd-logind</span><br><span class="line">        |-systemd-udevd</span><br><span class="line">        |-udisksd</span><br><span class="line">        |-upowerd</span><br><span class="line">        `-wpa_supplicant</span><br></pre></td></tr></table></figure>

<p>上面是<code>sudo pstree -T</code>的输出，感觉这种卡顿可能就是de内存溢出了。理论上我感觉只要重启一下sddm马上就能变流畅。但是在这之前我想知道更详细的信息。</p>
<p>先把qq关了试试。不出所料还是很卡。上google搜一下吧。</p>
<p>草了，看到一个哥们系统偶尔卡顿最后发现是SSD挂掉的前兆。想起来这个本子用的是三星的老固态，系统盘的文件系统是btrfs；前几天还看群里某群u吐槽说btrfs在他那边对于固态寿命损伤挺严重的。也不知道是不是btrfs的问题。不过好在重要数据都有备份，丢了也不心疼，全从服务器上sync下来就行了。</p>
<p>不过应该这次不是固态的问题，应该还是sddm本身的问题，不然很难解释怎么所有gui里边的东西都开始卡顿了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">TIME                           PID  UID  GID SIG     COREFILE EXE                           SIZE</span><br><span class="line">Sun 2023-10-29 23:52:21 CST   2030 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Thu 2023-11-02 13:07:56 CST   3084    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Thu 2023-11-02 17:15:49 CST  36261 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Thu 2023-11-02 23:44:53 CST   1795 1000 1000 SIGTRAP missing  /tmp/.mount_linuxqFrCYKS/qq      -</span><br><span class="line">Sat 2023-11-04 18:43:36 CST   1640 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Sat 2023-11-04 18:45:41 CST   2255    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Sat 2023-11-04 18:46:34 CST   2300    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Sun 2023-11-05 18:16:28 CST  19274 1000 1000 SIGABRT missing  /opt/vscodium-bin/codium         -</span><br><span class="line">Sun 2023-11-05 18:16:30 CST  19330 1000 1000 SIGABRT missing  /opt/vscodium-bin/codium         -</span><br><span class="line">Sun 2023-11-05 22:13:13 CST  14279 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Thu 2023-11-09 23:30:51 CST  14724 1000 1000 SIGTRAP missing  /qq                              -</span><br><span class="line">Thu 2023-11-09 23:38:16 CST  15804 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Fri 2023-11-10 01:08:53 CST  14773 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Tue 2023-11-14 09:04:45 CST   5996 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Tue 2023-11-14 09:47:58 CST  10033 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Tue 2023-11-14 10:15:41 CST  75599 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Tue 2023-11-14 10:30:25 CST  13990 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Tue 2023-11-14 17:47:23 CST    575 1000 1000 SIGABRT missing  /usr/bin/plasmashell             -</span><br><span class="line">Tue 2023-11-14 21:00:24 CST  18347 1000 1000 SIGABRT missing  /usr/bin/plasmashell             -</span><br><span class="line">Wed 2023-11-15 00:34:08 CST  26489 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Wed 2023-11-15 01:14:11 CST  28479 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Wed 2023-11-15 11:34:37 CST  19955 1000 1000 SIGSEGV missing  /usr/bin/plasmashell             -</span><br><span class="line">Wed 2023-11-15 23:54:02 CST  36282 1000 1000 SIGSEGV missing  /opt/visual-studio-code/code     -</span><br><span class="line">Fri 2023-11-17 00:45:55 CST  16467 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Fri 2023-11-17 00:45:56 CST  40168 1000 1000 SIGTRAP missing  /qq                              -</span><br><span class="line">Sat 2023-11-18 01:12:06 CST  17969 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:06 CST  15257 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:06 CST  17286 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:56 CST  19088 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:56 CST  19770 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:56 CST  18906 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:56 CST  19731 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:56 CST  19689 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:57 CST  19591 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:13:10 CST  25066 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:13:11 CST  25053 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:13:11 CST  20320 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:13:11 CST  24308 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:13:13 CST  25240 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:13:13 CST  25205 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:13:14 CST  25646 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 22:14:12 CST    576 1000 1000 SIGABRT missing  /usr/bin/plasmashell             -</span><br><span class="line">Sat 2023-11-18 23:37:15 CST   2175 1000 1000 SIGABRT missing  /usr/bin/plasmashell             -</span><br><span class="line">Sun 2023-11-19 12:59:47 CST   4430    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Sun 2023-11-19 13:00:33 CST   4459    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Sun 2023-11-19 13:00:34 CST   4469    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Sun 2023-11-19 13:06:05 CST   5821    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Mon 2023-11-20 20:53:13 CST    588 1000 1000 SIGSEGV missing  /usr/bin/plasmashell             -</span><br><span class="line">Mon 2023-11-20 20:56:33 CST   6077 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Mon 2023-11-20 22:56:05 CST   5427 1000 1000 SIGABRT missing  /usr/bin/plasmashell             -</span><br><span class="line">Mon 2023-11-20 22:59:54 CST  18385    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Tue 2023-11-21 23:30:23 CST  12137 1000 1000 SIGBUS  missing  /qq                              -</span><br><span class="line">Tue 2023-11-21 23:30:25 CST  12093 1000 1000 SIGBUS  missing  /qq                              -</span><br><span class="line">Tue 2023-11-21 23:30:26 CST  17572 1000 1000 SIGBUS  missing  /qq                              -</span><br><span class="line">Tue 2023-11-21 23:30:26 CST  12015 1000 1000 SIGBUS  missing  /qq                              -</span><br><span class="line">Tue 2023-11-21 23:30:26 CST  12016 1000 1000 SIGBUS  missing  /qq                              -</span><br><span class="line">Tue 2023-11-21 23:30:27 CST  12459 1000 1000 SIGBUS  missing  /qq                              -</span><br><span class="line">Tue 2023-11-21 23:30:27 CST  12003 1000 1000 SIGBUS  missing  /qq                              -</span><br><span class="line">Tue 2023-11-21 23:30:28 CST  12043 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Fri 2023-11-24 00:01:53 CST  14600 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Sat 2023-11-25 02:40:58 CST  32138 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Tue 2023-11-28 23:33:11 CST  41077 1000 1000 SIGTRAP missing  /qq                              -</span><br><span class="line">Wed 2023-11-29 11:43:44 CST  43973 1000 1000 SIGABRT missing  /usr/bin/adb                     -</span><br><span class="line">Wed 2023-11-29 11:44:06 CST  45189 1000 1000 SIGABRT missing  /usr/bin/adb                     -</span><br><span class="line">Wed 2023-11-29 23:29:56 CST  53151 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Wed 2023-11-29 23:45:58 CST  55228 1000 1000 SIGSEGV missing  /opt/visual-studio-code/code     -</span><br><span class="line">Thu 2023-11-30 00:13:43 CST  42637 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Sat 2023-12-02 01:12:16 CST  56991 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Mon 2023-12-04 10:28:09 CST  77126 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Mon 2023-12-04 15:18:23 CST  99034    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Mon 2023-12-04 15:19:05 CST  99068    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Mon 2023-12-04 15:20:45 CST  99231    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Mon 2023-12-04 15:54:13 CST 104472 1000 1000 SIGSEGV missing  /home/xeonds/code/pizip/pi       -</span><br><span class="line">Mon 2023-12-04 15:54:45 CST 104495 1000 1000 SIGSEGV missing  /home/xeonds/code/pizip/pi       -</span><br><span class="line">Mon 2023-12-04 15:55:06 CST 104521 1000 1000 SIGSEGV missing  /home/xeonds/code/pizip/pi       -</span><br><span class="line">Mon 2023-12-04 15:55:36 CST 104541 1000 1000 SIGSEGV missing  /home/xeonds/code/pizip/pi       -</span><br><span class="line">Mon 2023-12-04 17:28:20 CST 104920 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Mon 2023-12-04 23:36:35 CST 119295 1000 1000 SIGSEGV missing  /opt/visual-studio-code/code     -</span><br><span class="line">Wed 2023-12-06 11:18:53 CST  16426    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Mon 2023-12-11 19:56:40 CST  97572 1000 1000 SIGTRAP missing  /tmp/.mount_linuxqSV6RFp/qq      -</span><br><span class="line">Tue 2023-12-12 01:01:33 CST 123670 1000 1000 SIGTRAP missing  /opt/visual-studio-code/code     -</span><br><span class="line">Fri 2023-12-15 14:50:41 CST  17039 1000 1000 SIGTRAP missing  /tmp/.mount_linuxqkQn53G/qq      -</span><br><span class="line">Sat 2023-12-16 23:55:13 CST  19892 1000 1000 SIGTRAP missing  /opt/visual-studio-code/code     -</span><br><span class="line">Mon 2023-12-18 13:16:16 CST  28074    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Mon 2023-12-18 15:08:22 CST  41701 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Tue 2023-12-19 21:37:06 CST  17530 1000 1000 SIGFPE  missing  /home/xeonds/code/c4/a.out       -</span><br><span class="line">Tue 2023-12-19 23:39:47 CST  20684 1000 1000 SIGTRAP missing  /tmp/.mount_linuxqllS3Xz/qq      -</span><br><span class="line">Wed 2023-12-20 12:31:27 CST  23806 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Sun 2023-12-24 19:26:26 CST   5873 1000 1000 SIGTRAP present  /qq                           1.6M</span><br><span class="line">Mon 2023-12-25 01:59:52 CST   5951 1000 1000 SIGBUS  present  /chrome_crashpad_handler     42.5K</span><br></pre></td></tr></table></figure>

<p>上面是<code>coredumpctl</code>的输出。好像sddm还没崩溃呢。再看看journal：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">Dec 24 02:28:08 ark-station-breeze systemd[1]: Started Simple Desktop Display Manager.</span><br><span class="line">░░ Subject: A start job <span class="keyword">for</span> unit sddm.service has finished successfully</span><br><span class="line">░░ Defined-By: systemd</span><br><span class="line">░░ Support: https://lists.freedesktop.org/mailman/listinfo/systemd-devel</span><br><span class="line">░░ </span><br><span class="line">░░ A start job <span class="keyword">for</span> unit sddm.service has finished successfully.</span><br><span class="line">░░ </span><br><span class="line">░░ The job identifier is 108.</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Initializing...</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Starting...</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Logind interface found</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Adding new display...</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Loaded empty theme configuration</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Xauthority path: <span class="string">&quot;/run/sddm/xauth_bDCTVn&quot;</span></span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Using VT 2</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Display server starting...</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Writing cookie to <span class="string">&quot;/run/sddm/xauth_bDCTVn&quot;</span></span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Running: /usr/bin/X -dpi 120 -background none -seat seat0 vt2 -auth /run/sddm/xauth_bDCTVn -noreset -displayfd 16</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm[407]: Setting default cursor</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm[407]: Running display setup script  <span class="string">&quot;/usr/share/sddm/scripts/Xsetup&quot;</span></span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm[407]: Display server started.</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm[407]: Reading from <span class="string">&quot;/usr/local/share/xsessions/plasma.desktop&quot;</span></span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm[407]: Reading from <span class="string">&quot;/usr/share/xsessions/plasma.desktop&quot;</span></span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm[407]: Session <span class="string">&quot;/usr/share/xsessions/plasma.desktop&quot;</span> selected, <span class="built_in">command</span>: <span class="string">&quot;/usr/bin/startplasma-x11&quot;</span> <span class="keyword">for</span> VT 2</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: [PAM] Starting...</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: [PAM] Authenticating...</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: pam_kwallet5(sddm-autologin:auth): pam_kwallet5: pam_sm_authenticate</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: [PAM] Preparing to converse...</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: pam_kwallet5(sddm-autologin:auth): pam_kwallet5: Couldn<span class="string">&#x27;t get password (it is empty)</span></span><br><span class="line"><span class="string">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: [PAM] Conversation with 1 messages</span></span><br><span class="line"><span class="string">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: pam_kwallet5(sddm-autologin:auth): pam_kwallet5: Empty or missing password, doing nothing</span></span><br><span class="line"><span class="string">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: [PAM] returning.</span></span><br><span class="line"><span class="string">Dec 24 02:28:09 ark-station-breeze sddm[407]: Authentication for user  &quot;xeonds&quot;  successful</span></span><br><span class="line"><span class="string">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: pam_kwallet5(sddm-autologin:setcred): pam_kwallet5: pam_sm_setcred</span></span><br><span class="line"><span class="string">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: pam_unix(sddm-autologin:session): session opened for user xeonds(uid=1000) by xeonds(uid=0)</span></span><br><span class="line"><span class="string">Dec 24 02:28:10 ark-station-breeze sddm-helper[433]: pam_kwallet5(sddm-autologin:session): pam_kwallet5: pam_sm_open_session</span></span><br><span class="line"><span class="string">Dec 24 02:28:10 ark-station-breeze sddm-helper[433]: pam_kwallet5(sddm-autologin:session): pam_kwallet5: open_session called without kwallet5_key</span></span><br><span class="line"><span class="string">Dec 24 02:28:10 ark-station-breeze sddm-helper[433]: Writing cookie to &quot;/tmp/xauth_XpVcsc&quot;</span></span><br><span class="line"><span class="string">Dec 24 02:28:10 ark-station-breeze sddm-helper[433]: Starting X11 session: &quot;&quot; &quot;/usr/share/sddm/scripts/Xsession \&quot;/usr/bin/startplasma-x11\&quot;&quot;</span></span><br><span class="line"><span class="string">Dec 24 02:28:10 ark-station-breeze sddm[407]: Session started true</span></span><br></pre></td></tr></table></figure>

<p>哦还有xorg的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-- No entries --</span><br></pre></td></tr></table></figure>

<p>好吧空的。那看看top</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[?1h=[?25l[H[J[mtop - 15:10:25 up 1 day, 12:42,  1 user,  load average: 1.40, 1.33, 1.29[m[39;49m[m[39;49m[K</span><br><span class="line">任务:[m[39;49m[1m 204 [m[39;49mtotal,[m[39;49m[1m   3 [m[39;49mrunning,[m[39;49m[1m 201 [m[39;49msleeping,[m[39;49m[1m   0 [m[39;49mstopped,[m[39;49m[1m   0 [m[39;49mzombie[m[39;49m[m[39;49m[K</span><br><span class="line">%Cpu(s):[m[39;49m[1m 28.6 [m[39;49mus,[m[39;49m[1m  0.0 [m[39;49msy,[m[39;49m[1m  0.0 [m[39;49mni,[m[39;49m[1m 71.4 [m[39;49mid,[m[39;49m[1m  0.0 [m[39;49mwa,[m[39;49m[1m  0.0 [m[39;49mhi,[m[39;49m[1m  0.0 [m[39;49msi,[m[39;49m[1m  0.0 [m[39;49mst[m[39;49m[m [m[39;49m[m[39;49m[K</span><br><span class="line">MiB Mem :[m[39;49m[1m   7835.3 [m[39;49mtotal,[m[39;49m[1m    584.1 [m[39;49mfree,[m[39;49m[1m   3807.3 [m[39;49mused,[m[39;49m[1m   4760.9 [m[39;49mbuff/cache[m[39;49m[m [m[39;49m[m    [m[39;49m[m[39;49m[K</span><br><span class="line">MiB Swap:[m[39;49m[1m      0.0 [m[39;49mtotal,[m[39;49m[1m      0.0 [m[39;49mfree,[m[39;49m[1m      0.0 [m[39;49mused.[m[39;49m[1m   4028.0 [m[39;49mavail Mem [m[39;49m[m[39;49m[K</span><br><span class="line">[K</span><br><span class="line">[7m 进程号 USER      PR  NI    VIRT    RES    SHR    %CPU  %MEM     TIME+ COMMAND  [m[39;49m[K</span><br><span class="line">[m[1m    411 root      20   0  859280  87628  30916 R  90.9   1.1 248:56.68 Xorg     [m[39;49m[K</span><br><span class="line">[m[1m  19316 xeonds    20   0 4028616 892492 271492 R  72.7  11.1   0:17.50 firefox  [m[39;49m[K</span><br><span class="line">[m  19461 xeonds    20   0 2713128 171852  88252 S  18.2   2.1   0:06.27 WebExte+ [m[39;49m[K</span><br><span class="line">[m[1m  19901 xeonds    20   0   15440   5760   3584 R   9.1   0.1   0:00.01 top      [m[39;49m[K</span><br><span class="line">[m      1 root      20   0   22220  10228   7028 S   0.0   0.1   0:02.61 systemd  [m[39;49m[K</span><br><span class="line">[m      2 root      20   0       0      0      0 S   0.0   0.0   0:00.04 kthreadd [m[39;49m[K</span><br><span class="line">[m      3 root      20   0       0      0      0 S   0.0   0.0   0:00.00 pool_wo+ [m[39;49m[K</span><br><span class="line">[m      4 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker+ [m[39;49m[K</span><br><span class="line">[m      5 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker+ [m[39;49m[K</span><br><span class="line">[m      6 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker+ [m[39;49m[K</span><br><span class="line">[m      7 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker+ [m[39;49m[K</span><br><span class="line">[m      9 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker+ [m[39;49m[K</span><br><span class="line">[m     12 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker+ [m[39;49m[K</span><br><span class="line">[m     14 root      20   0       0      0      0 I   0.0   0.0   0:00.00 rcu_tas+ [m[39;49m[K</span><br><span class="line">[m     15 root      20   0       0      0      0 I   0.0   0.0   0:00.00 rcu_tas+ [m[39;49m[K</span><br><span class="line">[m     16 root      20   0       0      0      0 I   0.0   0.0   0:00.00 rcu_tas+ [m[39;49m[K</span><br><span class="line">[m     17 root      20   0       0      0      0 S   0.0   0.0   0:30.95 ksoftir+ [m[39;49m[K[?1l&gt;[25;1H</span><br><span class="line">[34h[?25h[K</span><br></pre></td></tr></table></figure>

<p>抽象是抽象了点，但是能看出来好像是Xorg在发电，试试去tty重启xorg看看。</p>
<p>最后发现Xorg是sddm启动的，没办法直接重启了下sddm，问题解决，但是最不爽的是不知道问题到底是咋解决的。</p>
<p>找到一个博客，发现好像不是xorg的问题，而是kwin的问题：暂停恢复合成时，会导致kwin卡顿，这时候重启一下kwin_x11就行了。</p>
<p>这就好说了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl --user restart plasma-kwin_x11</span><br></pre></td></tr></table></figure>
<p>或者这个</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setsid kwin_x11 --replace &amp;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ref:<a target="_blank" rel="noopener" href="https://www.glowmem.com/archives/archlinux-note#toc-head-7">律回彼境</a></p>
</blockquote>
<p>试了试，问题完美解决，CPU占用也正常了。</p>
<p> 参考：<a target="_blank" rel="noopener" href="https://blog.mynook.info/post/kde-gui-sluggish-workaround/">KDE解决GUI界面卡顿的问题</a></p>
<h2 id="组合键"><a href="#组合键" class="headerlink" title="组合键"></a>组合键</h2><p>其实主要是KDE Plasma的相关组合键。偶尔会意外发现一些组合键，就记录在这里了。</p>
<ul>
<li>切换桌面：<code>ctrl+F*</code></li>
<li>无极缩放：<code>win+ctrl</code>+鼠标滚轮，真的好丝滑QAQ</li>
</ul>
<h2 id="莫得休眠Hibernate选项"><a href="#莫得休眠Hibernate选项" class="headerlink" title="莫得休眠Hibernate选项"></a>莫得休眠Hibernate选项</h2><p>找了半天发现是系统安装的时候没设置swap交换分区。不过暂时默认的睡眠也够用了，之后再考虑吧。</p>
<h2 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h2><blockquote>
<p>ref:<a target="_blank" rel="noopener" href="https://sspai.com/post/78916">现代化的 Archlinux 安装，Btrfs、快照、休眠以及更多。</a></p>
</blockquote>
<p>其一就是软件列表备份。<code>pacman -Qe &gt;&gt; installed.txt</code>就可以备份已安装软件列表</p>
<p>其二就是备份根目录数据。其中的<code>-avrh</code>用于保留文件权限。以及似乎必须得注意路径末尾的斜杠问题，rsync好像会区分这两个路径。<code>sudo rsync -avrh --progress /home/ /mnt/backup/</code></p>
<h2 id="关机等待时间"><a href="#关机等待时间" class="headerlink" title="关机等待时间"></a>关机等待时间</h2><p>一直忘了改这个东西了。有时候等待一些服务停止的时候等到倒计时结束才会停止。可以适当减少倒计时的时长环节这个问题。</p>
<p>对应的参数在<code>/etc/systemd/system.conf</code>，更改<code>DefaultTimeoutStopSec=90s</code>为你想要的等待时间，我改成10s了。</p>
<h2 id="记一次内核卡死"><a href="#记一次内核卡死" class="headerlink" title="记一次内核卡死"></a>记一次内核卡死</h2><p>挺草的说起来。征兆是先是firefox崩了，然后把kwin也爆了。第二次是kwin自己爆炸了，然后玩mc java的时候就OOM+CPU 100%了。问了下群里老哥，发现没开SysRq，不然的话就能在内核卡死的时候使用一些组合键来让内核执行一些有限操作。</p>
<p>等待了大概40min，无果，只能以&gt;2min的不规律时间响应键盘中断，老哥推测可能是活锁，而且OOM也没来得及出动。所以就含泪重启，跟自己tmux里边一堆窗口告别了。</p>
<p>重启，看看内核日志：<code>sudo journalctl -k -b-1</code>查看上次启动的日志：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line">Jan 16 10:43:33 ark-station kernel: Bluetooth: hci0: Malformed MSFT vendor event: 0x02</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: Bluetooth: hci0: Found Intel DDC parameters: intel/ibt-0040-4150.ddc</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: Bluetooth: hci0: Applying Intel DDC parameters completed</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: Bluetooth: hci0: Firmware timestamp 2023.42 buildtype 1 build 73111</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: Microcode SW error detected. Restarting 0x0.</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: Start IWL Error Log Dump:</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: Transport status: 0x0000004A, valid: 6</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: Loaded firmware version: 83.e8f84e98.0 so-a0-hr-b0-83.ucode</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000071 | NMI_INTERRUPT_UMAC_FATAL    </span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x000002F0 | trm_hw_status0</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | trm_hw_status1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x004D9024 | branchlink2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x004CF2F2 | interruptlink1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x004CF2F2 | interruptlink2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00015346 | data1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000010 | data2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | data3</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x0022F89E | beacon time</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x001E1C6F | tsf low</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | tsf hi</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | time gp1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x001ED6DD | time gp2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000001 | uCode revision type</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000053 | uCode version major</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0xE8F84E98 | uCode version minor</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000370 | hw version</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00C80002 | board version</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x80DDFC04 | hcmd</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00020000 | isr0</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | isr1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x48F00002 | isr2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00C3000C | isr3</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | isr4</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x001C0103 | last cmd Id</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00015346 | wait_event</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000010 | l2p_control</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000020 | l2p_duration</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x0000003F | l2p_mhvalid</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | l2p_addr_match</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000009 | lmpm_pmg_sel</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | timestamp</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00004870 | flow_handler</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: Start IWL Error Log Dump:</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: Transport status: 0x0000004A, valid: 7</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x2010190E | ADVANCED_SYSASSERT</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | umac branchlink1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x804703E0 | umac branchlink2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0xC0081500 | umac interruptlink1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | umac interruptlink2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x0101971C | umac data1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0xDEADBEEF | umac data2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0xDEADBEEF | umac data3</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000053 | umac major</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0xE8F84E98 | umac minor</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x001ED6D7 | frame pointer</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0xC0886BE0 | stack pointer</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x0024010D | last host cmd</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | isr status reg</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: IML/ROM dump:</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000B03 | IML/ROM error/state</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x0000518C | IML/ROM data1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000090 | IML/ROM WFPM_AUTH_KEY_0</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: Fseq Registers:</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x60000000 | FSEQ_ERROR_CODE</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00350002 | FSEQ_TOP_INIT_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00150001 | FSEQ_CNVIO_INIT_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x0000A482 | FSEQ_OTP_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000003 | FSEQ_TOP_CONTENT_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x4552414E | FSEQ_ALIVE_TOKEN</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00080400 | FSEQ_CNVI_ID</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x01300504 | FSEQ_CNVR_ID</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00080400 | CNVI_AUX_MISC_CHIP</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x01300504 | CNVR_AUX_MISC_CHIP</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x05B0905B | CNVR_SCU_SD_REGS_SD_REG_DIG_DCDC_VTRIM</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x0000025B | CNVR_SCU_SD_REGS_SD_REG_ACTIVE_VDIG_MIRROR</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00150001 | FSEQ_PREV_CNVIO_INIT_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00350002 | FSEQ_WIFI_FSEQ_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00350002 | FSEQ_BT_FSEQ_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x000000DC | FSEQ_CLASS_TP_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: UMAC CURRENT PC: 0x8048f214</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: LMAC1 CURRENT PC: 0xd0</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: WRT: Collecting data: ini trigger 4 fired (delay=0ms).</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: ieee80211 phy0: Hardware restart was requested</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: iwlwifi 0000:00:14.3: WRT: Invalid buffer destination</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: Bluetooth: MGMT ver 1.22</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: Bluetooth: hci0: Bad flag given (0x1) vs supported (0x0)</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: iwlwifi 0000:00:14.3: WFPM_UMAC_PD_NOTIFICATION: 0x20</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: iwlwifi 0000:00:14.3: WFPM_LMAC2_PD_NOTIFICATION: 0x1f</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: iwlwifi 0000:00:14.3: WFPM_AUTH_KEY_0: 0x90</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: iwlwifi 0000:00:14.3: CNVI_SCU_SEQ_DATA_DW9: 0x10</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: iwlwifi 0000:00:14.3: RFIm is deactivated, reason = 5</span><br><span class="line">Jan 16 10:43:38 ark-station kernel: wlan0: authenticate with e2:cb:4f:01:72:a7</span><br><span class="line">Jan 16 10:43:38 ark-station kernel: wlan0: send auth to e2:cb:4f:01:72:a7 (try 1/3)</span><br><span class="line">Jan 16 10:43:38 ark-station kernel: wlan0: authenticated</span><br><span class="line">Jan 16 10:43:38 ark-station kernel: wlan0: associate with e2:cb:4f:01:72:a7 (try 1/3)</span><br><span class="line">Jan 16 10:43:38 ark-station kernel: wlan0: RX AssocResp from e2:cb:4f:01:72:a7 (capab=0x1511 status=0 aid=1)</span><br><span class="line">Jan 16 10:43:38 ark-station kernel: wlan0: associated</span><br><span class="line">Jan 16 10:47:20 ark-station kernel: kwin_wayland[901]: segfault at 0 ip 0000561fd234c33f sp 00007fff916f35c0 error 4 in kwin_wayland[561fd2348000+110000] likely on CPU 13 (core 25, socket 0)</span><br><span class="line">Jan 16 10:47:20 ark-station kernel: Code: 8b 47 58 48 8b 58 10 48 01 c3 48 63 40 04 4c 8d 24 c3 49 39 dc 75 0d eb 2a 66 90 48 83 c3 08 49 39 dc 74 1f 48 8b 3b 48 89 ee &lt;48&gt; 8b 07 ff 50 60 84 c0 74 e7 48 83 c4 08 5b 5d 41 5c 41 5d c3 0f</span><br><span class="line">Jan 16 10:49:41 ark-station systemd-fstab-generator[2389003]: Failed to create unit file &#x27;/run/systemd/generator/-.mount&#x27;, as it already exists. Duplicate entry in &#x27;/etc/fstab&#x27;?</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: deauthenticating from e2:cb:4f:01:72:a7 by local choice (Reason: 3=DEAUTH_LEAVING)</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: authenticate with f0:9b:b8:16:62:30</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: 80 MHz not supported, disabling VHT</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: send auth to f0:9b:b8:16:62:30 (try 1/3)</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: authenticated</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: associate with f0:9b:b8:16:62:30 (try 1/3)</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: RX AssocResp from f0:9b:b8:16:62:30 (capab=0x1421 status=0 aid=2)</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: associated</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: Limiting TX power to 20 (20 - 0) dBm as advertised by f0:9b:b8:16:62:30</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: disconnect from AP f0:9b:b8:16:62:30 for new auth to f0:9b:b8:16:62:40</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: authenticate with f0:9b:b8:16:62:40</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: send auth to f0:9b:b8:16:62:40 (try 1/3)</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: authenticated</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: associate with f0:9b:b8:16:62:40 (try 1/3)</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: RX ReassocResp from f0:9b:b8:16:62:40 (capab=0x1501 status=0 aid=4)</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: associated</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: Limiting TX power to 30 (30 - 0) dBm as advertised by f0:9b:b8:16:62:40</span><br><span class="line">Jan 16 11:22:44 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* Atomic update failure on pipe A (start=282494 end=282495) time 187 us, min 1579, max 1599, scanline start 1564, end 1602</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: disconnect from AP f0:9b:b8:16:62:40 for new auth to f0:9b:b8:16:5c:40</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: authenticate with f0:9b:b8:16:5c:40</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: send auth to f0:9b:b8:16:5c:40 (try 1/3)</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: authenticated</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: associate with f0:9b:b8:16:5c:40 (try 1/3)</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: RX ReassocResp from f0:9b:b8:16:5c:40 (capab=0x1501 status=0 aid=2)</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: associated</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: Limiting TX power to 23 (23 - 0) dBm as advertised by f0:9b:b8:16:5c:40</span><br><span class="line">Jan 16 18:00:05 ark-station kernel: wlan0: deauthenticating from f0:9b:b8:16:5c:40 by local choice (Reason: 3=DEAUTH_LEAVING)</span><br><span class="line">Jan 16 18:00:05 ark-station kernel: wlan0: authenticate with e2:cb:4f:01:72:a7</span><br><span class="line">Jan 16 18:00:05 ark-station kernel: wlan0: send auth to e2:cb:4f:01:72:a7 (try 1/3)</span><br><span class="line">Jan 16 18:00:05 ark-station kernel: wlan0: authenticated</span><br><span class="line">Jan 16 18:00:05 ark-station kernel: wlan0: associate with e2:cb:4f:01:72:a7 (try 1/3)</span><br><span class="line">Jan 16 18:00:05 ark-station kernel: wlan0: RX AssocResp from e2:cb:4f:01:72:a7 (capab=0x1511 status=0 aid=3)</span><br><span class="line">Jan 16 18:00:05 ark-station kernel: wlan0: associated</span><br><span class="line">Jan 16 18:41:38 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* Atomic update failure on pipe A (start=2487239 end=2487240) time 230 us, min 1579, max 1599, scanline start 1566, end 1613</span><br><span class="line">Jan 16 19:34:40 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* Atomic update failure on pipe A (start=2869004 end=2869005) time 158 us, min 1579, max 1599, scanline start 1570, end 1602</span><br><span class="line">Jan 16 20:01:05 ark-station kernel: atkbd serio0: Unknown key pressed (translated set 2, code 0x8b on isa0060/serio0).</span><br><span class="line">Jan 16 20:01:05 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00b &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:01:05 ark-station kernel: atkbd serio0: Unknown key released (translated set 2, code 0x8b on isa0060/serio0).</span><br><span class="line">Jan 16 20:01:05 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00b &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:01:07 ark-station kernel: atkbd serio0: Unknown key pressed (translated set 2, code 0x8a on isa0060/serio0).</span><br><span class="line">Jan 16 20:01:07 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00a &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:01:07 ark-station kernel: atkbd serio0: Unknown key released (translated set 2, code 0x8a on isa0060/serio0).</span><br><span class="line">Jan 16 20:01:07 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00a &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:02:39 ark-station kernel: atkbd serio0: Unknown key pressed (translated set 2, code 0x8b on isa0060/serio0).</span><br><span class="line">Jan 16 20:02:39 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00b &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:02:39 ark-station kernel: atkbd serio0: Unknown key released (translated set 2, code 0x8b on isa0060/serio0).</span><br><span class="line">Jan 16 20:02:39 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00b &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:02:51 ark-station kernel: atkbd serio0: Unknown key pressed (translated set 2, code 0x8a on isa0060/serio0).</span><br><span class="line">Jan 16 20:02:51 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00a &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:02:51 ark-station kernel: atkbd serio0: Unknown key released (translated set 2, code 0x8a on isa0060/serio0).</span><br><span class="line">Jan 16 20:02:51 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00a &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* GT0: GUC: Engine reset failed on 0:0 (rcs0) because 0x00000000</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] GPU HANG: ecode 12:1:84dffffb, in Render thread [3009924]</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] Resetting chip for GuC failed to reset engine mask=0x1</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* rcs0 reset request timed out: &#123;request: 00000001, RESET_CTL: 00000001&#125;</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* rcs0 reset request timed out: &#123;request: 00000001, RESET_CTL: 00000001&#125;</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] Render thread[3009924] context reset due to GPU hang</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] GT0: GuC firmware i915/adlp_guc_70.bin version 70.13.1</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] GT0: HuC firmware i915/tgl_huc.bin version 7.9.3</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] GT0: HuC: authenticated for all workloads</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] GT0: GUC: submission enabled</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] GT0: GUC: SLPC enabled</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* GT0: GUC: Engine reset failed on 0:0 (rcs0) because 0x00000000</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] GPU HANG: ecode 12:1:84dffffb, in Render thread [3009924]</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] Resetting chip for GuC failed to reset engine mask=0x1</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* rcs0 reset request timed out: &#123;request: 00000001, RESET_CTL: 00000001&#125;</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* rcs0 reset request timed out: &#123;request: 00000001, RESET_CTL: 00000001&#125;</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] Render thread[3009924] context reset due to GPU hang</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] GT0: GuC firmware i915/adlp_guc_70.bin version 70.13.1</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] GT0: HuC firmware i915/tgl_huc.bin version 7.9.3</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] GT0: HuC: authenticated for all workloads</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] GT0: GUC: submission enabled</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] GT0: GUC: SLPC enabled</span><br><span class="line">Jan 16 20:49:08 ark-station kernel: INFO: task IPC Launch:2387456 blocked for more than 122 seconds.</span><br><span class="line">Jan 16 20:49:16 ark-station kernel:       Not tainted 6.6.10-arch1-1 #1</span><br><span class="line">Jan 16 20:49:27 ark-station kernel: &quot;echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs&quot; disables this message.</span><br><span class="line">Jan 16 20:49:32 ark-station kernel: task:IPC Launch      state:D stack:0     pid:2387456 ppid:870    flags:0x00004002</span><br><span class="line">Jan 16 20:49:38 ark-station kernel: Call Trace:</span><br><span class="line">Jan 16 20:49:48 ark-station kernel:  &lt;TASK&gt;</span><br><span class="line">Jan 16 20:50:00 ark-station kernel:  __schedule+0x3e7/0x1410</span><br><span class="line">Jan 16 20:50:16 ark-station kernel:  schedule+0x5e/0xd0</span><br><span class="line">Jan 16 20:50:28 ark-station kernel:  schedule_preempt_disabled+0x15/0x30</span><br><span class="line">Jan 16 20:50:36 ark-station kernel:  rwsem_down_write_slowpath+0x203/0x690</span><br><span class="line">Jan 16 20:50:43 ark-station kernel:  ? prealloc_shrinker+0x6a/0xd0</span><br><span class="line">Jan 16 20:50:51 ark-station kernel:  ? __pfx_set_anon_super_fc+0x10/0x10</span><br><span class="line">Jan 16 20:50:57 ark-station kernel:  down_write+0x5b/0x60</span><br><span class="line">Jan 16 20:51:04 ark-station kernel:  __prealloc_shrinker+0x70/0x350</span><br><span class="line">Jan 16 20:51:11 ark-station kernel:  ? kvasprintf+0x82/0xd0</span><br><span class="line">Jan 16 20:51:17 ark-station kernel:  ? __pfx_set_anon_super_fc+0x10/0x10</span><br><span class="line">Jan 16 20:51:23 ark-station kernel:  prealloc_shrinker+0x7b/0xd0</span><br><span class="line">Jan 16 20:51:28 ark-station kernel:  alloc_super+0x272/0x2e0</span><br><span class="line">Jan 16 20:51:35 ark-station kernel:  sget_fc+0x63/0x330</span><br><span class="line">Jan 16 20:51:41 ark-station kernel:  ? __pfx_mqueue_fill_super+0x10/0x10</span><br><span class="line">Jan 16 20:51:55 ark-station kernel:  get_tree_nodev+0x27/0x90</span><br><span class="line">Jan 16 20:52:02 ark-station kernel:  vfs_get_tree+0x26/0xf0</span><br><span class="line">Jan 16 20:52:07 ark-station kernel:  ? refcount_dec_and_lock+0x11/0x70</span><br><span class="line">Jan 16 20:52:12 ark-station kernel:  fc_mount+0x12/0x40</span><br><span class="line">Jan 16 20:52:17 ark-station kernel:  mq_init_ns+0x10f/0x1b0</span><br><span class="line">Jan 16 20:52:21 ark-station kernel:  copy_ipcs+0x134/0x270</span><br><span class="line">Jan 16 20:52:26 ark-station kernel:  create_new_namespaces+0xa1/0x2e0</span><br></pre></td></tr></table></figure>

<p>看了一圈最后找到个issue，看样子我应该是drm&#x2F;i195受害者咯。</p>
<h3 id="SysRq-Keyboard-Shortcuts"><a href="#SysRq-Keyboard-Shortcuts" class="headerlink" title="SysRq: Keyboard Shortcuts"></a>SysRq: Keyboard Shortcuts</h3><blockquote>
<p>systemd has the SysRq permissions bitmask set to 0x10 by default, which does not allow process signalling or rebooting, among other things. To allow full use of the SysRq key on your system, add kernel.sysrq &#x3D; 1 to your sysctl configuration. Values greater than 1 can be used to selectively enable SysRq functions; see the Linux kernel documentation for details. If you want to make sure it will be enabled even before the partitions are mounted and in the initrd, then add sysrq_always_enabled&#x3D;1 to your kernel parameters.</p>
<p>Note that changing the setting through these methods will cause the changes to persist across reboots. If you want to try changing the SysRq settings for just your current session, you can run either sysctl kernel.sysrq&#x3D;1 or echo “1” &gt; &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;sysrq.</p>
<p>There are some obvious security risks involved in fully enabling the SysRq key. In addition to forcing reboots and the like, it can be used to dump the contents of the CPU registers, which could theoretically reveal sensitive information. Since using it requires physical access to the system (unless you go out of your way), most desktop users will probably consider the level of risk acceptable. That said, make sure you fully understand the implications of enabling it and the dynamics of the larger context in which your system is operating before you turn SysRq all the way on. </p>
</blockquote>
<p>上边是<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/keyboard_shortcuts">arch wiki</a>的资料链接，可以参考下开开这玩意。这玩意的快捷键可以这么记：<em>Reboot Even If System Utterly Broken</em>。用法就是<code>Alt+SysRq+这六个单词首字母缩写</code>，功能分别是</p>
<ul>
<li><code>Unraw</code>：切换键盘输入到ASCII模式，</li>
<li><code>Terminate</code>：给所有进程发送<code>SIGTERM</code>，</li>
<li><code>Kill</code>：发送<code>SIGKILL</code>给所有进程，</li>
<li><code>Sync</code>：写入数据到磁盘，</li>
<li><code>Unmount</code>：卸载然后挂载所有文件系统为只读模式，</li>
<li><code>Reboot</code>：重启。</li>
</ul>
<p>另外还可以用<code>f</code>来触发<code>OOM Killer</code>。</p>
<h2 id="开机时间优化"><a href="#开机时间优化" class="headerlink" title="开机时间优化"></a>开机时间优化</h2><blockquote>
<p>ref: <a target="_blank" rel="noopener" href="https://www.glowmem.com/archives/archlinux-note#toc-head-7">律回彼境</a></p>
</blockquote>
<p>使用<code>sudo systemd-analyze blame</code>可以查看系统开机时间详情。</p>
<p>自动mount分区（也就是直接在<code>/etc/fstab</code>里边进行配置）会导致启动时间增大，所以更推荐写成一个脚本，在用户登录后自动执行挂载。脚本放置在 ~&#x2F;.config&#x2F;autostart&#x2F; 即可在用户登录后执行。</p>
<h2 id="又被Firefox爆了"><a href="#又被Firefox爆了" class="headerlink" title="又被Firefox爆了"></a>又被Firefox爆了</h2><blockquote>
<p>虽然后来看日志发现是Firefox被kwin爆了</p>
</blockquote>
<p>这几天频繁出现桌面所有进程炸掉的情况，恢复后Firefox的Crash Report自己会跳出来。。不知道为啥，但是根据群u从<code>about:crashes</code>里边提交的崩溃报告来看，应该是kwin把Firefox爆了。</p>
<p>根据老哥的建议，关闭了系统的自适应同步（Adaptive Sync）选项，按照他的惊叹，问题可能会少一些。</p>
<h2 id="传文件的姿势"><a href="#传文件的姿势" class="headerlink" title="传文件的姿势"></a>传文件的姿势</h2><blockquote>
<p>什么姿势，还真没见过<br>-转自archlinux-cn-依云</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar C -c ~tmp/makepkg/wayfire-lily-git/src/build/src wayfire | ssh root@kvm-archkde tar xvU -C /usr/bin/</span><br></pre></td></tr></table></figure>

<h2 id="文件系统迁移"><a href="#文件系统迁移" class="headerlink" title="文件系统迁移"></a>文件系统迁移</h2><blockquote>
<p>有条件的话，建议还是全新安装最好。</p>
</blockquote>
<p>Reference:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/512761420">如何将你的文件系统转换为 Btrfs | Linux 中国</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/BarryWanghyw/Linux_Personal_Note/blob/master/Linux%E7%B3%BB%E7%BB%9F%E4%B9%8Brsync%20%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%98%E5%8E%9F.md">Linux_Personal_Note&#x2F;Linux系统之rsync 备份与还原 - github.com</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.imlk.top/posts/migrating-to-btrfs/">从ext4迁移到btrfs - imlk’s blog</a></li>
<li><a target="_blank" rel="noopener" href="https://superuser.com/questions/524186/grub-broken-after-conversion-to-btrfs">GRUB broken after conversion to btrfs - Superuser.com</a></li>
<li><a target="_blank" rel="noopener" href="https://forum.manjaro.org/t/boot-on-btrfs-subvolume-error-mount-new-root-unknown-filesystem-type-btrfs/152116">Boot on btrfs subvolume error: “mount: &#x2F;new_root: unknown filesystem type ‘btrfs’ ”</a></li>
</ul>
<p>参考了几个博客，跟着感觉走最后总算是有惊无险整好了。</p>
<p>本来是想用<code>btrfs-convert</code>给直接原地转换的，但是奈何superblock大小太小，转换失败。没办法，自己动手丰衣足食。</p>
<p>首先先是把原来的系统备份好：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/nvme0n1p5 of=/path/to/another/disk/backup.img bs=4M status=progress</span><br></pre></td></tr></table></figure>

<p>有备份了，开整。</p>
<p>发现手边没有U盘，但是有个root的手机。于是就用DriveDroid+一个Arch的LiveISO让它发挥余热了。</p>
<p>启动挺顺利，记得把ArchISO挂载为只读USB存储设备。进去之后<strong>确保确实备份了之后格式化设备</strong>（一定要多确认几遍，）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs.btrfs -L arch-driver /dev/nvme0n1p5    <span class="comment"># 这里务必多确认几遍</span></span><br></pre></td></tr></table></figure>

<p>然后创建子卷，布局我用的适合<code>timeshift</code>的默认方案：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mount -t btrfs -o compress=zstd /dev/nvme0n1p5 /mnt</span><br><span class="line">btrfs subvolume create /mnt/@ <span class="comment"># 创建 / 目录子卷</span></span><br><span class="line">btrfs subvolume create /mnt/@home <span class="comment"># 创建 /home 目录子卷</span></span><br><span class="line">umount /mnt</span><br><span class="line"></span><br><span class="line">mount -t btrfs -o subvol=/@,compress=zstd /dev/nvme0n1p5 /mnt</span><br><span class="line"><span class="built_in">mkdir</span> /mnt/home</span><br><span class="line">mount -t btrfs -o subvol=/@home,compress=zstd /dev/nvme0n1p5 /mnt/home</span><br><span class="line"><span class="built_in">mkdir</span> -p /mnt/boot</span><br><span class="line">mount /dev/nvme0n1p2 /mnt/boot</span><br></pre></td></tr></table></figure>

<p>创建完成之后，准备迁移数据：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> ~/old-fs</span><br><span class="line">monut /path/to/your/backup/backup.img ~/old-fs</span><br><span class="line">rsync -av ~/old-fs/home/ /mnt/home/</span><br><span class="line">rsync -av --exclude=&#123;<span class="string">&quot;/proc&quot;</span>,<span class="string">&quot;/dev&quot;</span>&#125; ~/old-fs/ /mnt/</span><br></pre></td></tr></table></figure>

<p>等复制完成之后，就可以着手修复系统引导了。这里先用<code>iwctl</code>连上网。之后就该开始修复GRUB了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">genfstab -U /mnt &gt; /mnt/etc/fstab</span><br><span class="line"><span class="comment"># 此时手动检查下结果是否正确</span></span><br><span class="line"><span class="comment"># 可以cat /mnt/etc/fstab看看</span></span><br><span class="line">arch-chroot /mnt</span><br><span class="line">pacman -S grub-btrfs    <span class="comment"># 安装支持btrfs版本的GRUB</span></span><br><span class="line">grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=ARCH</span><br><span class="line">sed -i <span class="string">&#x27;s/loglevel=3 quiet/loglevel=5 nowatchdog/g&#x27;</span> /etc/default/grub</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;GRUB_DISABLE_OS_PROBER=false&quot;</span> &gt;&gt; /etc/default/grub</span><br></pre></td></tr></table></figure>

<p>然后理论上就OK了。此时<code>ctrl+d</code>退出<code>chroot</code>然后<code>umount -R /mnt &amp;&amp; reboot</code>，重启，进入新系统看看吧。</p>
<p>反正解决完一堆问题，成功进系统之后，我惊悚地发现，磁盘可用空间从8G变成了30G<del>而且<code>btrfs balance /</code>之后还又多出来1G</del>。根据rx所说，btrfs对于文本的压缩效果特别好。那指不定是给我一堆<code>node_modules</code>压缩干净了？</p>
<p>谁知道，大概是透明压缩确实顶吧。经过测试，timeshift和其他的btrfs特性都能正常使用。</p>
<h2 id="在Btrfs上开启swap"><a href="#在Btrfs上开启swap" class="headerlink" title="在Btrfs上开启swap"></a>在Btrfs上开启swap</h2><blockquote>
<p>Ref: <a target="_blank" rel="noopener" href="https://www.cnblogs.com/pipci/p/14856606.html">Btrfs文件系统启用交换文件(swap) - Pipci</a><br>最近主力机寄了，无奈让另一台i5-7300U的本子当主力。开swap主要是因为8+256的配置实在有点吃不消,平时开几个VSCode跟浏览器标签页就差不多满内存了。</p>
</blockquote>
<p>问题是之前用一般方法开启swap的时候总会在swapon这一步遇到问题，后来查了下才发现是btrfs上的交换文件有几个限制：</p>
<ul>
<li><strong>不支持在快照卷上配置交换文件，建议单独创建子卷</strong></li>
<li><strong>不支持在跨越多个物理设备的卷上创建交换文件</strong></li>
</ul>
<blockquote>
<p>是的，我才知道btrfs是能跨硬盘组阵列的QAQ</p>
</blockquote>
<p>所以流程是创建一个新的subvolume，然后设置上一些标记之后再创建swap文件，最后开启swap。</p>
<p>下面是来自我找到的博客的操作记录，在我的6.9.3的内核上验证基本没有问题：</p>
<blockquote>
<p>注意，下面的操作在<code>/</code>下进行</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建swap子卷</span></span><br><span class="line">te@EY-B:/$ sudo btrfs subvolume create swap</span><br><span class="line">Create subvolume <span class="string">&#x27;./swap&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在swap子卷下创建一个0 byte大小的交换文件</span></span><br><span class="line">te@EY-B:/swap$ sudo <span class="built_in">truncate</span> -s 0 /swap/swapfile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置交换文件权限</span></span><br><span class="line">te@EY-B:/swap$ sudo <span class="built_in">chmod</span> 600 /swap/swapfile </span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置交换文件属性，具有&#x27;C&#x27;属性集的文件将不受 copy-on-write 的约束。</span></span><br><span class="line"><span class="comment"># 注意:对于btrfs，“C”标志应该是设置新的或空文件。</span></span><br><span class="line">te@EY-B:/swap$ sudo chattr +C /swap/swapfile </span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置btrfs禁止压缩交换文件</span></span><br><span class="line">te@EY-B:/swap$ sudo btrfs property <span class="built_in">set</span> /swap compression none</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将交换文件填充至需要的大小</span></span><br><span class="line">te@EY-B:/swap$ sudo <span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=/swap/swapfile bs=1M count=2048</span><br><span class="line"></span><br><span class="line"><span class="comment"># 格式化交换文件</span></span><br><span class="line">te@EY-B:/swap$ sudo mkswap /swap/swapfile </span><br><span class="line"></span><br><span class="line"><span class="comment"># 启用交换文件</span></span><br><span class="line">te@EY-B:/swap$ sudo swapon /swap/swapfile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编辑 /etc/fstab 自动挂载，添加或编辑以下行：</span></span><br><span class="line">sudo <span class="built_in">echo</span> <span class="string">&quot;/swap/swapfile    none    swap    sw    0    0&quot;</span> &gt;&gt; /etc/fstab</span><br></pre></td></tr></table></figure>

<p>完成之后重启，用<code>free -h</code>看看挂载结果：</p>
<p><img src="/img/Pasted%20image%2020240615145856.png"></p>
<blockquote>
<p>继续苟一阵子吧…等考试周结束之后再想想怎么处理这个机革的本子<br>毕竟是用40G内存+12700H带我用Arch爽了快一年的本子，还是挺有感情的<br>就是这玩意刚过保4个月就寄实在是有点绷不住</p>
</blockquote>
<h2 id="aur的制作和发布"><a href="#aur的制作和发布" class="headerlink" title="aur的制作和发布"></a>aur的制作和发布</h2><p>aur就是archlinux user repo，借助PKGBUILD可以快速简单地编排应用的编译构建流程。如果遇到一个GitHub的项目，你就可以编写一个PKGBUILD来编排一个从源码编译出应用包的构建脚本。</p>
<p>这次我用<code>python-etcpak-git</code>作为例子来记录aur的制作和提交。</p>
<h3 id="编写PKGBUILD"><a href="#编写PKGBUILD" class="headerlink" title="编写PKGBUILD"></a>编写PKGBUILD</h3><h3 id="注册AUR"><a href="#注册AUR" class="headerlink" title="注册AUR"></a>注册AUR</h3><p>首先生成密钥，打开终端，输入<code>ssh-keygen</code>然后回车，按照提示生成公私钥。假设密钥名称保存为<code>aur-key</code>。</p>
<p>然后编辑<code>~/.ssh/config</code>，在末尾追加：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Host aur.archlinux.org</span><br><span class="line">  IdentityFile ~/.ssh/aur-key</span><br><span class="line">  User aur</span><br></pre></td></tr></table></figure>

<p>完成后，复制<code>aur-key.pub</code>的内容，开始注册账号。</p>
<p>在<a target="_blank" rel="noopener" href="https://aur.archlinux.org/">https://aur.archlinux.org</a>注册登陆，正确填写邮，用户名和<code>aur-key.pub</code>的内容。完成后打开邮箱的密码重设链接设置密码，完成后即可发布自己的PKGBUILD到aur。</p>
<h3 id="发布PKGBUILD"><a href="#发布PKGBUILD" class="headerlink" title="发布PKGBUILD"></a>发布PKGBUILD</h3><blockquote>
<p>要是不确定可以参考arckwiki中的介绍，将自己的PKGBUILD挂到邮件列表&#x2F;论坛内，让大火帮你检查。</p>
</blockquote>
<p>我要发布的软件包叫<code>python-etcpak-git</code>，那么就是使用下面的指令初始化仓库：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> ssh://aur@aur.archlinux.org/python-etcpak-git.git</span><br></pre></td></tr></table></figure>

<p>完成后，进入该目录并放置自己的PKGBUILD文件，按照要求填写后，生成信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">makepkg --printsrcinfo &gt; .SRCINFO</span><br></pre></td></tr></table></figure>

<p>最后将PKGBUILD和.SRCINFO添加到git中，提交。**不过记得先更改本地分支名为<code>master</code>**，因为aur只允许推送到master分支。完成后推送，<del>请坐和放宽</del>，过阵子应该就能用yay安装你的包了。</p>
<h2 id="PKGBUILD笔记"><a href="#PKGBUILD笔记" class="headerlink" title="PKGBUILD笔记"></a>PKGBUILD笔记</h2><p><a target="_blank" rel="noopener" href="https://man.archlinux.org/man/makepkg.8">makepkg(8) — Arch manual pages</a><br><a target="_blank" rel="noopener" href="https://man.archlinux.org/man/makepkg.conf.5.en">makepkg.conf(5) — Arch manual pages</a><br><a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/Makepkg">makepkg - Arch Linux 中文维基</a></p>
<p>makepkg可以使用一些额外的环境变量参数和一些cli参数：</p>
<ul>
<li><code>MAKEFLAGS</code> 指定传递给make的参数</li>
<li><code>CHOST</code> 指定交叉编译的–host参数</li>
</ul>
<h2 id="wechat-uos分辨率问题"><a href="#wechat-uos分辨率问题" class="headerlink" title="wechat-uos分辨率问题"></a>wechat-uos分辨率问题</h2><blockquote>
<p>ref: <a target="_blank" rel="noopener" href="https://manateelazycat.github.io/2024/03/26/wechat-linux-version/">Arch 上使用微信原生版本</a></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /usr/share/applications/wechat-universal.desktop</span><br><span class="line"><span class="comment"># 修改Exec行为下列内容</span></span><br><span class="line">Exec=<span class="built_in">env</span> QT_AUTO_SCREEN_SCALE_FACTOR=2 wechat-universal %u</span><br></pre></td></tr></table></figure>

<h2 id="linux进程资源管理"><a href="#linux进程资源管理" class="headerlink" title="linux进程资源管理"></a>linux进程资源管理</h2><p><code>util-linux</code>：一组实用工具</p>
<p><img src="/img/Pasted%20image%2020241126000041.png"></p>
<p><code>systemd-run</code>：便捷地限制进程资源</p>
<p>Here’s how you can use <code>systemd-run</code> to limit CPU and memory usage:</p>
<ol>
<li><strong>Limit CPU usage</strong>:<br>To limit CPU usage to 50% of one core, you can use the <code>CPUQuota</code> option:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemd-run --scope --cpu-quota=50000 my_process</span><br></pre></td></tr></table></figure>
The <code>CPUQuota</code> value is in microseconds and is relative to the available CPU time (100% being equal to one CPU core).</li>
<li><strong>Limit memory usage</strong>:<br>To limit memory usage to 512MB, you can use the <code>MemoryMax</code> option:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemd-run --scope --memory-max=512M my_process</span><br></pre></td></tr></table></figure>
Here’s an example combining both CPU and memory limits:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemd-run --scope --cpu-quota=50000 --memory-max=512M my_process</span><br></pre></td></tr></table></figure>
Replace <code>my_process</code> with the actual command you want to run.<br>Here’s what each option does:</li>
</ol>
<ul>
<li><code>--scope</code>: This creates a transient scope unit for the process. It’s a good choice for short-lived processes.</li>
<li><code>--cpu-quota</code>: Sets the CPU time limit for the process. The value is in microseconds and is relative to the available CPU time.</li>
<li><code>--memory-max</code>: Sets the maximum amount of memory the process can use.<br>After running the command, <code>systemd-run</code> will print the name of the created scope unit, which you can use to monitor the resource usage or to clean up the unit after the process has finished.<br>To monitor the CPU and memory usage of the process, you can use:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status &lt;scope-unit-name&gt;</span><br></pre></td></tr></table></figure>
Replace <code>&lt;scope-unit-name&gt;</code> with the actual name of the scope unit that <code>systemd-run</code> printed out.<br>To clean up the transient scope unit after the process has finished, you can use:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop &lt;scope-unit-name&gt;</span><br></pre></td></tr></table></figure>
Remember that <code>systemd-run</code> is part of systemd, and it might not be available or might have different options on systems that do not use systemd.</li>
</ul>
<h2 id="sync"><a href="#sync" class="headerlink" title="sync"></a>sync</h2><p>Synchronize cached writes to persistent storage</p>
<h2 id="obs-虚拟摄像头"><a href="#obs-虚拟摄像头" class="headerlink" title="obs-虚拟摄像头"></a>obs-虚拟摄像头</h2><p>从26.1版开始，OBS 支持 Linux 虚拟摄像机输出。要使用它，<a href="file:///usr/share/doc/arch-wiki-zh-cn/html/zh-cn/Help:%E9%98%85%E8%AF%BB.html#%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E5%8C%85" title="安装">安装</a> <a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=v4l2loopback-dkms">v4l2loopback-dkms</a>包，并将用户加入<code>video</code>组，还需要为已安装的内核安装适当的头文件包，如 <a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=linux-headers">linux-headers</a>包 或 <a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=linux-lts-headers">linux-lts-headers</a>包，然后 OBS 中会出现_启动虚拟摄像机_按钮。如果<code>v4l2loopback</code>包中的<a href="file:///usr/share/doc/arch-wiki-zh-cn/html/zh-cn/%E5%86%85%E6%A0%B8%E6%A8%A1%E5%9D%97.html" title="内核模块">内核模块</a>尚未加载，OBS 会自动尝试加载它，并要求获得管理权限（使用 <a target="_blank" rel="noopener" href="https://man.archlinux.org/man/pkexec.1">pkexec(1)</a>）。</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Arch Linux折腾笔记</p><p><a href="https://mxts.jiujiuer.xyz/2023/09/05/arch-linux折腾笔记/">https://mxts.jiujiuer.xyz/2023/09/05/arch-linux折腾笔记/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>xeonds</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2023-09-05</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2025-03-15</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Linux/">Linux</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://mxts.jiujiuer.xyz/" defer></script></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2023/09/14/cpp-stl/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">C++-STL速通</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2023/08/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/linux-undelete/"><span class="level-item">Linux误删文件恢复</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "42f58b69f3f95177ca40105b45c9a2ea",
            repo: "xeonds.github.io",
            owner: "xeonds",
            clientID: "2bfc40bc0b5fef7b0688",
            clientSecret: "475f278f70ff3f0888e047f10766ab6929168f78",
            admin: ["xeonds"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            language: "zh-CN",
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#安装"><span class="level-left"><span class="level-item">1</span><span class="level-item">安装</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Tips"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">Tips</span></span></a></li></ul></li><li><a class="level is-mobile" href="#美化"><span class="level-left"><span class="level-item">2</span><span class="level-item">美化</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#稍微详细点"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">稍微详细点</span></span></a></li></ul></li><li><a class="level is-mobile" href="#显示适配"><span class="level-left"><span class="level-item">3</span><span class="level-item">显示适配</span></span></a></li><li><a class="level is-mobile" href="#参考链接"><span class="level-left"><span class="level-item">4</span><span class="level-item">参考链接</span></span></a></li><li><a class="level is-mobile" href="#pacman入门"><span class="level-left"><span class="level-item">5</span><span class="level-item">pacman入门</span></span></a></li><li><a class="level is-mobile" href="#启用外部ssh连接"><span class="level-left"><span class="level-item">6</span><span class="level-item">启用外部ssh连接</span></span></a></li><li><a class="level is-mobile" href="#在命令行连接Wi-Fi"><span class="level-left"><span class="level-item">7</span><span class="level-item">在命令行连接Wi-Fi</span></span></a></li><li><a class="level is-mobile" href="#使用TimeShift备份系统"><span class="level-left"><span class="level-item">8</span><span class="level-item">使用TimeShift备份系统</span></span></a></li><li><a class="level is-mobile" href="#重启显示管理器（Xorg-x2F-Wayland）"><span class="level-left"><span class="level-item">9</span><span class="level-item">重启显示管理器（Xorg/Wayland）</span></span></a></li><li><a class="level is-mobile" href="#Vim"><span class="level-left"><span class="level-item">10</span><span class="level-item">Vim</span></span></a></li><li><a class="level is-mobile" href="#桌面目录映射"><span class="level-left"><span class="level-item">11</span><span class="level-item">桌面目录映射</span></span></a></li><li><a class="level is-mobile" href="#添加多系统启动项"><span class="level-left"><span class="level-item">12</span><span class="level-item">添加多系统启动项</span></span></a></li><li><a class="level is-mobile" href="#代理配置"><span class="level-left"><span class="level-item">13</span><span class="level-item">代理配置</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#eXtended：通过RESTfulAPI操作clash-core"><span class="level-left"><span class="level-item">13.1</span><span class="level-item">eXtended：通过RESTfulAPI操作clash-core</span></span></a></li><li><a class="level is-mobile" href="#FAQ-常见代理连接失败问题"><span class="level-left"><span class="level-item">13.2</span><span class="level-item">FAQ:常见代理连接失败问题</span></span></a></li></ul></li><li><a class="level is-mobile" href="#RDP连接Windows"><span class="level-left"><span class="level-item">14</span><span class="level-item">RDP连接Windows</span></span></a></li><li><a class="level is-mobile" href="#scrcpy连接android"><span class="level-left"><span class="level-item">15</span><span class="level-item">scrcpy连接android</span></span></a></li><li><a class="level is-mobile" href="#X11迁移Wayland"><span class="level-left"><span class="level-item">16</span><span class="level-item">X11迁移Wayland</span></span></a></li><li><a class="level is-mobile" href="#又出问题了"><span class="level-left"><span class="level-item">17</span><span class="level-item">又出问题了</span></span></a></li><li><a class="level is-mobile" href="#组合键"><span class="level-left"><span class="level-item">18</span><span class="level-item">组合键</span></span></a></li><li><a class="level is-mobile" href="#莫得休眠Hibernate选项"><span class="level-left"><span class="level-item">19</span><span class="level-item">莫得休眠Hibernate选项</span></span></a></li><li><a class="level is-mobile" href="#备份"><span class="level-left"><span class="level-item">20</span><span class="level-item">备份</span></span></a></li><li><a class="level is-mobile" href="#关机等待时间"><span class="level-left"><span class="level-item">21</span><span class="level-item">关机等待时间</span></span></a></li><li><a class="level is-mobile" href="#记一次内核卡死"><span class="level-left"><span class="level-item">22</span><span class="level-item">记一次内核卡死</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#SysRq-Keyboard-Shortcuts"><span class="level-left"><span class="level-item">22.1</span><span class="level-item">SysRq: Keyboard Shortcuts</span></span></a></li></ul></li><li><a class="level is-mobile" href="#开机时间优化"><span class="level-left"><span class="level-item">23</span><span class="level-item">开机时间优化</span></span></a></li><li><a class="level is-mobile" href="#又被Firefox爆了"><span class="level-left"><span class="level-item">24</span><span class="level-item">又被Firefox爆了</span></span></a></li><li><a class="level is-mobile" href="#传文件的姿势"><span class="level-left"><span class="level-item">25</span><span class="level-item">传文件的姿势</span></span></a></li><li><a class="level is-mobile" href="#文件系统迁移"><span class="level-left"><span class="level-item">26</span><span class="level-item">文件系统迁移</span></span></a></li><li><a class="level is-mobile" href="#在Btrfs上开启swap"><span class="level-left"><span class="level-item">27</span><span class="level-item">在Btrfs上开启swap</span></span></a></li><li><a class="level is-mobile" href="#aur的制作和发布"><span class="level-left"><span class="level-item">28</span><span class="level-item">aur的制作和发布</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#编写PKGBUILD"><span class="level-left"><span class="level-item">28.1</span><span class="level-item">编写PKGBUILD</span></span></a></li><li><a class="level is-mobile" href="#注册AUR"><span class="level-left"><span class="level-item">28.2</span><span class="level-item">注册AUR</span></span></a></li><li><a class="level is-mobile" href="#发布PKGBUILD"><span class="level-left"><span class="level-item">28.3</span><span class="level-item">发布PKGBUILD</span></span></a></li></ul></li><li><a class="level is-mobile" href="#PKGBUILD笔记"><span class="level-left"><span class="level-item">29</span><span class="level-item">PKGBUILD笔记</span></span></a></li><li><a class="level is-mobile" href="#wechat-uos分辨率问题"><span class="level-left"><span class="level-item">30</span><span class="level-item">wechat-uos分辨率问题</span></span></a></li><li><a class="level is-mobile" href="#linux进程资源管理"><span class="level-left"><span class="level-item">31</span><span class="level-item">linux进程资源管理</span></span></a></li><li><a class="level is-mobile" href="#sync"><span class="level-left"><span class="level-item">32</span><span class="level-item">sync</span></span></a></li><li><a class="level is-mobile" href="#obs-虚拟摄像头"><span class="level-left"><span class="level-item">33</span><span class="level-item">obs-虚拟摄像头</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.jpg" alt="xeonds"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">xeonds</p><p class="is-size-6 is-block">ENJ0Y CREATiNG.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Solaris, Earth</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">173</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">31</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">93</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/xeonds" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/xeonds"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://holynia.github.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Holynia</span></span><span class="level-right"><span class="level-item tag">holynia.github.io</span></span></a></li><li><a class="level is-mobile" href="https://ray.al" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Ray</span></span><span class="level-right"><span class="level-item tag">ray.al</span></span></a></li><li><a class="level is-mobile" href="https://moefactory.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Robotxm</span></span><span class="level-right"><span class="level-item tag">moefactory.com</span></span></a></li><li><a class="level is-mobile" href="https://blog.dml.ink" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Dimole</span></span><span class="level-right"><span class="level-item tag">blog.dml.ink</span></span></a></li><li><a class="level is-mobile" href="https://mxts.jiujiuer.xyz/links" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">All</span></span><span class="level-right"><span class="level-item tag">mxts.jiujiuer.xyz</span></span></a></li><li><a class="level is-mobile" href="https://blog.iris.al/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">极速版（？</span></span><span class="level-right"><span class="level-item tag">blog.iris.al</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-03-07T07:11:12.000Z">2025-03-07</time></p><p class="title"><a href="/2025/03/07/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Linux/linux-nmtui%E9%85%8D%E7%BD%AE%E5%8F%8C%E7%BD%91%E5%8F%A3%E7%BD%91%E7%BB%9C/">linux-nmtui配置双网口网络</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-03-02T11:40:46.000Z">2025-03-02</time></p><p class="title"><a href="/2025/03/02/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/nginx+vue%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E5%90%8E%E6%97%A0%E6%B3%95%E5%8A%A0%E8%BD%BD%E8%B5%84%E6%BA%90/">nginx+vue项目部署后无法加载资源</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-12-25T18:34:14.000Z">2024-12-26</time></p><p class="title"><a href="/2024/12/25/%E6%96%87%E5%AD%A6/%E6%9D%82%E8%B0%88/2024%E4%B9%8B%E6%A2%A6/">2024之梦</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-09-12T07:41:18.000Z">2024-09-12</time></p><p class="title"><a href="/2024/09/12/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E9%BE%99%E8%8A%AF%E4%B9%85%E4%B9%85%E6%B4%BEPlus%E6%8A%98%E8%85%BE%E7%AC%94%E8%AE%B0/">龙芯久久派Plus折腾笔记</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-07-08T03:39:09.000Z">2024-07-08</time></p><p class="title"><a href="/2024/07/08/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%A1%AC%E4%BB%B6/%E7%A3%81%E5%B8%A6%E6%9C%BA%E5%85%A5%E5%9D%91%E5%B0%8F%E8%AE%B0/">磁带机入坑小记</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/"><span class="level-start"><span class="level-item">2025</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/"><span class="level-start"><span class="level-item">2024</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/"><span class="level-start"><span class="level-item">2022</span></span><span class="level-end"><span class="level-item tag">32</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/"><span class="level-start"><span class="level-item">2021</span></span><span class="level-end"><span class="level-item tag">56</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/"><span class="level-start"><span class="level-item">2020</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/"><span class="level-start"><span class="level-item">2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/"><span class="level-start"><span class="level-item">2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/favicon.ico" alt="神社的储物间" height="28"></a><p class="is-size-7"><span>&copy; 2025 xeonds</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>