<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>神社的储物间</title>
  <icon>https://mxts.jiujiuer.xyz/icon.png</icon>
  <subtitle>*节操消失了*</subtitle>
  <link href="https://mxts.jiujiuer.xyz/atom.xml" rel="self"/>
  
  <link href="https://mxts.jiujiuer.xyz/"/>
  <updated>2024-06-04T16:42:26.934Z</updated>
  <id>https://mxts.jiujiuer.xyz/</id>
  
  <author>
    <name>xeonds</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>在Wayland中使用无线副屏</title>
    <link href="https://mxts.jiujiuer.xyz/2024/05/04/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%9C%A8Wayland%E4%B8%AD%E4%BD%BF%E7%94%A8%E6%97%A0%E7%BA%BF%E5%89%AF%E5%B1%8F/"/>
    <id>https://mxts.jiujiuer.xyz/2024/05/04/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%9C%A8Wayland%E4%B8%AD%E4%BD%BF%E7%94%A8%E6%97%A0%E7%BA%BF%E5%89%AF%E5%B1%8F/</id>
    <published>2024-05-04T03:58:02.000Z</published>
    <updated>2024-06-04T16:42:26.934Z</updated>
    
    <content type="html"><![CDATA[<h2 id="废话"><a href="#废话" class="headerlink" title="废话"></a>废话</h2><p>之前在Windows上用过米全家桶，体验一般。这回回家带了电脑和板子，写分布式作业的时候突然想把板子当副屏用，但是让我切回Windows写代码还是饶了我吧QAQ</p><p>不过切成Wayland以后，基于xrdp的方法也没法用，还好有新的替代：krfb</p><blockquote><p>KDE: Krfb 桌面共享是一个可以让您与另一个在其他机器上的用户共享当前会话的服务器程序，他可以使用VNC 客户端来查看甚至控制桌面。</p></blockquote><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>截止2024.05.04，aur中的最新版在RVNC Viewer客户端连接时会崩溃，故本文使用<code>krfb-22.12.3-1-x86_64</code>。</p><p>首先将系统的PulseAudio切换为PipeWire：在Arch下运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S pipewire pipewire-pulse pipewire-alsa wireplumber</span><br></pre></td></tr></table></figure><p>随后pacman会询问是否卸载PulseAudio，输入y回车即可。安装完成后，重启一次。</p><p>接着安装Krfb，因为我使用了历史的pkg包，所以</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -U krfb-22.12.3-1-x86_64.pkg.tar.zst</span><br></pre></td></tr></table></figure><p>现在就可以正常使用了。你可以使用这个配置试试：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">krfb-virtualmonitor --name Pad --resolution 1920x1080 --password password --port 5900</span><br></pre></td></tr></table></figure><p>现在打开板子上的VNC，连接电脑的IP试试吧。</p><p><img src="/img/Pasted%20image%2020240504123041.png"></p><h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><ul><li><a href="https://forum.manjaro.org/t/android-tablet-as-second-monitor/114841/2">Android tablet as a second monitor - Manjaro Forum</a></li><li><a href="https://tatsumin.dev/posts/switch-from-pulseaudio-to-pipwire/">Arch Linux 音频服务器从PulseAudio 切换到 Pipewire</a></li></ul>]]></content>
    
    
    <summary type="html">(*/ω＼*)</summary>
    
    
    
    
    <category term="Linux" scheme="https://mxts.jiujiuer.xyz/tags/Linux/"/>
    
    <category term="Wayland" scheme="https://mxts.jiujiuer.xyz/tags/Wayland/"/>
    
  </entry>
  
  <entry>
    <title>搜索引擎学习笔记</title>
    <link href="https://mxts.jiujiuer.xyz/2024/04/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>https://mxts.jiujiuer.xyz/2024/04/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2024-04-27T13:12:15.000Z</published>
    <updated>2024-06-04T16:42:26.934Z</updated>
    
    <content type="html"><![CDATA[<h2 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h2><p>搜索引擎是从文档集合中查找出匹配单词、问题等构成的信息需求的系统&#x2F;软件的总称。</p><p>不过现代的搜索引擎的索引范围早已经超过文档，比如对邮件&#x2F;专利信息的搜索引擎等。变化的是作为文档的对象，不变的是基础架构。</p><p>搜索引擎一般有四个部分：</p><ul><li>索引管理器 Index Manager<ul><li>索引是一种该诉检索特化的数据结构，对其访问借助索引管理器完成</li></ul></li><li>索引检查器 Index Searcher<ul><li>利用索引进行全文搜索处理的组件</li></ul></li><li>索引构建器 Indexer<ul><li>从文本文档中生成索引的组件。它的行为是将文档分解为单词序列，再转换为索引结构</li></ul></li><li>文档管理器 Document Manager<ul><li>管理作为检索对象的文档，并对于作为查询结果的文档进行摘要的生成</li></ul></li></ul><p>这几部分的工作方式：文档作为索引构建器的输入，将输出内容交给索引管理器和文档管理器，最后，用户使用检索应用程序，后者和索引检查器交互，使用信息需求获得结果。</p><p>还有其他不是组成部分，但是相关的组件：</p><ul><li>爬虫-Crawler： 收集Web上HTML等文件的自动系统。</li><li>搜索排序系统： 给作为检索对象的文档打分的系统。</li></ul><h2 id="全文搜素"><a href="#全文搜素" class="headerlink" title="全文搜素"></a>全文搜素</h2><p>全文搜索分为：利用全扫描进行全文搜索，和利用索引进行全文搜索的方法。</p><p>第一种方法因为和grep使用的方法一致，也称为grep型搜索。优点是文档不需要事先处理，缺点是文档数量和检索时间成正相关。因此仅适用于少量&#x2F;暂时性的文档。相关算法有KMP和BM等算法。</p><p>另一种是利用索引进行全文搜索的方法。事先需要为文档建立索引，然后利用索引搜索字符串。优点是搜索时间不会随文档数增多大幅下降，缺点是需要预先建立索引。</p><p>全文搜索的索引结构中，较为常用的结构是倒排索引。</p><h3 id="倒排索引"><a href="#倒排索引" class="headerlink" title="倒排索引"></a>倒排索引</h3><p>倒排表和书籍后的关键词索引原理一致。将关键词列出在书籍最后，并在每个关键词后面标注它出现的地方，并将这个表按照关键词首字母顺序排序。</p><p>它的构建方法大致如下：首先需要一个二维数组，行为所有出现过的单词（需要将这个维度压缩地尽可能小，比如忽略复数形式，忽略大小写等），列是页码。数组单元则是某页出现某单词的记录。</p><p>完成后，将行列反转，得到每个单词出现在每一页上的表。这个操作称为倒排，完成后的表格称为倒排表（Postings List），能用于关键字全文检索。</p><p>另，所谓的页码实际上是和网页编号对应的。一行记录称为一个倒排项（Posting）。</p><p>倒排索引，是单词的集合“词典”和倒排列表的集合“倒排文件”构成的。二者对应关系大致相当于：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">倒排词典    -&gt;  倒排文件</span><br><span class="line">-----------------------</span><br><span class="line">Google      -&gt;  2</span><br><span class="line">I           -&gt;  1,2</span><br><span class="line">...         -&gt;  ...</span><br></pre></td></tr></table></figure><p>这是一个松散的结构，每个单词的倒排文件可以从该单词的元信息获取。</p><p>查找的单词有多个时，对各个单词分别执行索引，取结果交集即是查找结果。</p><p>单词级倒排文件：在记录文档单词信息之外，额外记录该单词在文档出现的编号。</p><p>短语查找：借助单词级倒排文件，可以查找短语级别的内容：在取完交集之后，过滤掉结果中search和engine相对偏移量不为-1的项目。</p><p>对于中文等语言而言，搜索引擎的构造方法一样，不同在于语义化分割（Tokenization）中文的连续的句子。</p><p>中文的句子单词序列化分割方法常用的有两种：</p><ul><li>词素解析分割法<ul><li>将句子按照其中的语义，分割为词素（token）单元的方法，但是实现难度极高，近几年一般借助机器学习方法（隐马尔科夫模型&#x2F;条件随机场等方法）处理。</li></ul></li><li>N-gram分割法<ul><li>将句子分割成由N个字符组成的片段序列的方法，每个片段称作一个N-gram。M字的句子进行N-gram分割方法，能产生<code>M-N+1</code>个N-gram。</li></ul></li></ul><p>二者的优缺点都很明确，前者精准且节省空间，从而检索速度也快，但是可能会发生检索遗漏的问题。后者的优点是结果完整，因此检索速度相对较慢。并且可能会检索到无关词汇，比如检索华山得到九华山。</p><h3 id="词典的实现"><a href="#词典的实现" class="headerlink" title="词典的实现"></a>词典的实现</h3><p>一般使用哈希表、树等结构，常用的属性结构有二叉查找树BST、字典树Trie，B+树等。</p><p>这部分之所以使用超过一种数据结构，一个是因为存储金字塔结构：往往不能一次性将词典完整加载到内存中，另一个是因为块设备的读写单位是块，并且耗时很高，需要针对读写慢但是一次读写量大专门优化的数据结构。</p><h2 id="检索"><a href="#检索" class="headerlink" title="检索"></a>检索</h2><p>检索模型指代各种检索方法&#x2F;机制。使用逻辑谓词AND&#x2F;OR&#x2F;NOT指导的检索就是<strong>布尔检索</strong>。</p><p>该模型的检索流程：</p><ol><li>获取所有检索单词的倒排列表</li><li>根据布尔检索获取符合条件的文档编号</li><li>计算符合条件的文档和查询匹配度</li><li>根据匹配度&#x2F;其他排序参数，获取前k个文档</li></ol><p>因为逻辑比较简单，伪代码就不贴了</p><h2 id="关联度计算"><a href="#关联度计算" class="headerlink" title="关联度计算"></a>关联度计算</h2><p>策略一般是按照文档与查询的关联度对检索结果进行排序。算法则有：</p><ul><li>余弦相似度<ul><li>将文档和查询映射到以单词（token）为维度的向量空间，并计算二者向量的夹角，夹角越小则关联度越高</li></ul></li><li>Okapi BM25<ul><li>文档是否匹配查询是由概率决定：根据单词的出现频率计算关联概率。</li></ul></li></ul><p>信息检索是全文搜索的学术领域，这个检索领域目的是找出与信息需求匹配的文档，故可认定匹配的文章不必包含查询，只需要计算整个文档的关联度，将高关联度文档作为作为检索结果即可。</p><p>关联度计算是计算密集任务，因此有必要先得到符合检索条件的子集后再计算关联度进行排序。从而，针对不同的检索应用，设计不同的检索模型能提高性能和质量。</p><h2 id="构建倒排索引"><a href="#构建倒排索引" class="headerlink" title="构建倒排索引"></a>构建倒排索引</h2><p>因为数据的稀疏性质，它适用于使用链表进行存储。当内存用量过大时，可以使用二级链表进行存储。</p>]]></content>
    
    
    <summary type="html">(*/ω＼*)</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>Emmet学习笔记</title>
    <link href="https://mxts.jiujiuer.xyz/2024/04/19/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Emmet%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>https://mxts.jiujiuer.xyz/2024/04/19/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Emmet%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2024-04-19T03:42:50.000Z</published>
    <updated>2024-06-04T16:42:26.934Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>大半夜刷到的…老早就想学学这玩意了，奈何不知道名字是啥一直没法搜。</p></blockquote><p>参考资料：<a href="https://docs.emmet.io/abbreviations/syntax/">Abbreviations Syntax | Emmet Doc</a></p><p>Abbreviations are the heart of the Emmet toolkit: these special expressions are parsed in runtime and transformed into structured code block, HTML for example. The abbreviation’s syntax looks like CSS selectors with a few extensions specific to code generation. So every web-developer already knows how to use it. </p><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><h3 id="元素"><a href="#元素" class="headerlink" title="元素"></a>元素</h3><p>html定义的所有标签均可以直接由标签名称补全：比如<code>div</code>-&gt;<code>&lt;div&gt;&lt;/div&gt;</code></p><h3 id="子元素"><a href="#子元素" class="headerlink" title="子元素"></a>子元素</h3><p>二元运算符<code>&gt;</code>标记标注前一元素的子元素，例如<code>div&gt;ul</code>-&gt;<code>&lt;div&gt;&lt;ul&gt;&lt;/ul&gt;&lt;/div&gt;</code></p><h3 id="同级元素"><a href="#同级元素" class="headerlink" title="同级元素"></a>同级元素</h3><p>二元运算符<code>+</code>标识元素的同级元素，例如<code>div+p</code>-&gt;<code>&lt;div&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;</code></p><h3 id="返回上一级"><a href="#返回上一级" class="headerlink" title="返回上一级"></a>返回上一级</h3><p><code>^</code>标识指引当前缩进层次往上一级，例如<code>div&gt;p^span</code>-&gt;<div><p></p></div><span></span>&#96;</p><h3 id="数量算符"><a href="#数量算符" class="headerlink" title="数量算符"></a>数量算符</h3><p>二元运算符<code>*</code>指示左侧元素数量为右侧整数个，例如<code>div*5</code>-&gt;<code>&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;</code></p><h3 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h3><p>可以使用<code>()</code>对符号进行分组：<code>div&gt;(header&gt;ul&gt;li*2&gt;a)+footer&gt;p</code>-&gt;</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>注意，括号可以嵌套：<code>(div&gt;dl&gt;(dt+dd)*3)+footer&gt;p</code>-&gt;</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dt</span>&gt;</span><span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dt</span>&gt;</span><span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dt</span>&gt;</span><span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br></pre></td></tr></table></figure><p>理论上你可以用一个缩写来编写一整页，但是实际最好不要这么做。</p><h3 id="属性选项"><a href="#属性选项" class="headerlink" title="属性选项"></a>属性选项</h3><p>对于标签，可以使用<code>.</code>标记添加class，<code>#</code>添加id，<code>[a=&quot;xxx&quot; b=&quot;3&quot;]</code>添加自定义标签。</p><h3 id="编号"><a href="#编号" class="headerlink" title="编号"></a>编号</h3><p>使用<code>*</code>操作符时，可以在元素名称，属性名称，属性值插入<code>$</code>来加入从1开始的序号。连续的<code>$</code>出现时，高位默认填0。比如：<code>ul&gt;li.item$*5</code>-&gt;</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;item1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;item2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;item3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;item4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;item5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><p>另外在<code>$</code>操作符后，可以用<code>@</code>修改起始值，递增&#x2F;递减。语法为：<code>$@-3</code>，<code>$@-</code>，<code>$@3</code>。得到的结果分别为序号递减到3，序号递减到1,序号从3递增。</p><h3 id="文本"><a href="#文本" class="headerlink" title="文本"></a>文本</h3><p>用<code>&#123;&#125;</code>包裹文本，可以将文本包含在元素标签对中：<code>a&#123;click me&#125;</code>&#x3D;&#x3D;<code>a&gt;&#123;click me&#125;</code>-&gt;<code>&lt;a href=&quot;&quot;&gt;click me&lt;/a&gt;</code></p><p>但是注意，第一种写法的优先级最高，第二种写法中，<code>&#123;&#125;</code>和一般标签等价。</p><h3 id="终结符"><a href="#终结符" class="headerlink" title="终结符"></a>终结符</h3><p>空格是Emmet的默认终结符，因此，不能用空格提升可读性。此外，Emmet可以在任何位置使用，不一定是空行开头。</p><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><ol><li><code>snippets.json</code>中包含Emmet的数据，也可以在这里定义自己的别名</li><li>部分标签（例如<code>div.content</code>）可省略标签名，Emmet可直接推导出</li><li>Lorem lpsum生成工具：<code>lorem</code>可直接扩展为占位文本，也可以使用<code>lorem10</code>等控制占位文字数量</li></ol><h2 id="注"><a href="#注" class="headerlink" title="注"></a>注</h2><p>Emmet还有CSS的snippets，不过我用的不多就没去看。</p>]]></content>
    
    
    <summary type="html">用了好久才知道div.class1#id&gt;button这种写法是Emmet的语法...</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>开发手记</title>
    <link href="https://mxts.jiujiuer.xyz/2024/04/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E6%89%8B%E8%AE%B0/"/>
    <id>https://mxts.jiujiuer.xyz/2024/04/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E6%89%8B%E8%AE%B0/</id>
    <published>2024-04-14T07:54:33.000Z</published>
    <updated>2024-06-04T16:42:26.934Z</updated>
    
    <content type="html"><![CDATA[<p>大概计算了一下，我在GitHub上所有的代码行数早已超过100k行了。三年下来，我在开发上的投入越来越大块，甚至已经吞噬了我的许多其他活动，甚至到了我很多次反思这到底是不是应该在大学期间干的事。</p><p>虽然如此我还是义无反顾地干下来了。兴趣所在，原因不明。</p><h2 id="经验1-量变引起质变"><a href="#经验1-量变引起质变" class="headerlink" title="经验1-量变引起质变"></a>经验1-量变引起质变</h2><p>说是重复练习积累经验也对，说是重复的过程中找到新的规律从中创新也对。总之，开发活动本身也是一种渐进式的活动。从一开始的编写Hello, World到后来编写一个完整的项目，这中间增长的是复杂度，一同增长的也有开发者自身对于代码的掌控力，以及对于复杂度的控制能力。</p><p>大量代码必然大块重复，其上的思考有助于抽离重复部分，丰富复用代码片段库。</p><p>增长的复用片段库最终会形成新的范式，或者新的工具，乃至思想。</p><h2 id="经验2-测试驱动开发（TDD）"><a href="#经验2-测试驱动开发（TDD）" class="headerlink" title="经验2-测试驱动开发（TDD）"></a>经验2-测试驱动开发（TDD）</h2><p>开发难点在于代码正确性验证，以及消除undefined behavior。测试驱动的开发一方面帮助我们消除ub，另一方面帮我们快速验证和开发模块。好处是，开发进度明确，并且开发完成之后可用程度基本拉满。</p><p>同时对比以前的完整编译再运行整个系统的做法，TDD更加敏捷。同时编写测试用例能帮我们理解自己的代码行为和逻辑。</p><h2 id="经验3-文档与工具"><a href="#经验3-文档与工具" class="headerlink" title="经验3-文档与工具"></a>经验3-文档与工具</h2><p>文档的必要性在于对整个代码的形式规约——文档本身也是一种应对复杂度的手段。文档的编写，构建和发布值得我们好好打磨。从注释生成，还是代码即注释，这些都可以，根据情况决定。</p><p>好的工具值得我们花费时间熟悉，看起来古老的工具，比如Vim，build-essentials，gnu core-utils以及bash都值得学习。并不是因为它们强大，而是让你学会如何使用基于这些工具构建的现代IDE&#x2F;构建流程背后的逻辑，思想以及原理，同时让你不被任何现代IDE约束于其中，能完成几乎所有超出IDE能力的任务。</p><h2 id="经验3-组合优于继承"><a href="#经验3-组合优于继承" class="headerlink" title="经验3-组合优于继承"></a>经验3-组合优于继承</h2><p>不仅适用于代码编写，也适用于工具哲学。继承是严格的约束，组合是松散的，约定大于规范的约束。pipe，xargs和gnu core-utils等工具能构建出让人难以置信的工具。KISS，同时只做一件事并把它做好，明确单一工具行为，谨防undefined behavior。</p><blockquote><p>另，关于GNU&#x2F;Linux以及无底洞systemd，组合确实适合构建一些特定的工具，但是对于general-purpose类型的，面向最终用户的接口，还是提供一个相对稳定，严格的规约比较好，不过大量吞噬其他工具这一点大可不必。</p></blockquote><h2 id="经验4-自顶向下设计"><a href="#经验4-自顶向下设计" class="headerlink" title="经验4-自顶向下设计"></a>经验4-自顶向下设计</h2><p>大学以来第一个大型项目NanoOJ，很长一段时间处于漫无目的的开发阶段：知道要做的东西是什么，但是不知道现在应该做什么。不熟悉软件工程的经验教训，文档是大段废话和幻想，对于开发毫无帮助。</p><p>程序本质是数据的变换工具，因此规划出明确的数据流之后进行开发就可以了。这个阶段的前一步，是需求整理，原型设计。</p><h2 id="经验5-面向接口编程"><a href="#经验5-面向接口编程" class="headerlink" title="经验5-面向接口编程"></a>经验5-面向接口编程</h2><p>符合软件工程中需求和文档为先，驱动程序开发的架构。这也是自顶向下设计的一种，适合多人团队项目开发。前后端先约定好接口，根据数据模型进行开发。</p><p>针对前后端开发，后端可以使用测试用例驱动；前端可以使用假数据驱动开发，开发完成后对接后端即可。</p><h2 id="经验6-Linux"><a href="#经验6-Linux" class="headerlink" title="经验6-Linux"></a>经验6-Linux</h2><p>GNU&#x2F;Linux是工具的集合。不仅是gnu core-utlis，也指代它的项目源代码库，以及提供的各种库库。使用组合式的实践，可以轻松创建出来稳定可用的，属于自己的工具合集。</p><p>Linux系的发行版是越用越爽的：它提供了近乎无穷的原料，让你能尽情发挥创造力——对比Windows，你需要不断学习Windows的各种工具，并很难有手段将它们组合使用——作为用户，你难以创造。不过随着Powershell的改进，这点倒是在逐渐改善。</p><p>关于系统的学习顺序，有时间的话最好从系统的启动过程，文件系统，服务管理，网络系统管理，以及性能监测和分析这方面开始学习。如果要从其他方向开始学习也不是不行，因为Linux本身也是渐进式的：学多少基本都能用起来。比较遗憾的是，我是从搭MC服务器&#x2F;部署网页服务器开始学的（</p><h2 id="经验7-渐进式"><a href="#经验7-渐进式" class="headerlink" title="经验7-渐进式"></a>经验7-渐进式</h2><p>刚开始听说是在Vue介绍中。后来实践中理解了是什么，为什么，以及怎么做。</p><p>渐进式指功能可以被逐渐学习，逐渐集成，比如Linux，第一天删除文件时只会直接<code>rm [filename]</code>，第二天知道了后面可以跟随多个文件名，第三天知道了可以使用正则来匹配所有要删除的文件。在这个过程中，你一开始就能完成需要的功能，而之后的学习让你将大部分任务耗时降低到可接受范围内。Vue支持从JS，Web Component和SPA到SSR，SSG多种开发方式，但是你无需学完才能开始编写代码：它的各种工具和概念是相对解耦的。</p><p>为什么呢？这和一般人的学习习惯有关。最代表性的例子是数学的学习，实际上我们是顺应着数学的发展历史逐渐向时间轴正向前进学习的。刚开始使用Visual Studio开发时，我经常因为不知道这东西各个部分怎么用而打开又关闭。用VS Code就舒服多了，基本功能简单，组合插件带来各种功能的能力也很强。<strong>VS Code打开就能直接写代码，但是VS必须经过系统全面的学习才能不阻碍完整的开发流程</strong>。或者这方面，Vim可能是个更好的例子：起初只需要学会<code>i</code>，<code>Esc</code>和<code>:wq</code>以及<code>hjkl</code>就能把它当记事本简单用用，之后每学到一个键&#x2F;功能都能直接提升你的效率和体验。</p><p>在我的开发学习过程，我一般不使用完整的项目基座，而是从官方给出的最简单的底座和实例开始，一点一点向上搭建。当我做到某一部分时，我会知道这部分需要使用什么新的插件，而不是一开始就从一个打满插件的项目开始——这样的开发体验并不好。当你发现自己的项目已经和其他脚手架&#x2F;基座功能比较接近时，这时候你就有了新的选择：迁移到完善的大型框架上进行开发。这时候的开发体验应该是如鱼得水的：你理解了应如何组合工具来编写这种复杂度的项目，你也能看懂底座提供的若干功能的逻辑和目的。这个阶段，对框架的使用才是提升效率的手段。</p><p>不过这种开发方式仅适用于习阶段，实际大型项目开发最好花时间看看成熟框架的文档和实例。</p>]]></content>
    
    
    <summary type="html">过去一年，GitHub已经1186次提交了。有点时间，就看看这三年都积淀了点啥吧</summary>
    
    
    
    
    <category term="C++" scheme="https://mxts.jiujiuer.xyz/tags/C/"/>
    
    <category term="C" scheme="https://mxts.jiujiuer.xyz/tags/C/"/>
    
    <category term="Golang" scheme="https://mxts.jiujiuer.xyz/tags/Golang/"/>
    
    <category term="Vue" scheme="https://mxts.jiujiuer.xyz/tags/Vue/"/>
    
    <category term="PHP" scheme="https://mxts.jiujiuer.xyz/tags/PHP/"/>
    
    <category term="JavaScript" scheme="https://mxts.jiujiuer.xyz/tags/JavaScript/"/>
    
    <category term="Kotlin" scheme="https://mxts.jiujiuer.xyz/tags/Kotlin/"/>
    
    <category term="TypeScript" scheme="https://mxts.jiujiuer.xyz/tags/TypeScript/"/>
    
    <category term="Python" scheme="https://mxts.jiujiuer.xyz/tags/Python/"/>
    
    <category term="Dart" scheme="https://mxts.jiujiuer.xyz/tags/Dart/"/>
    
    <category term="Lua" scheme="https://mxts.jiujiuer.xyz/tags/Lua/"/>
    
    <category term="Shell" scheme="https://mxts.jiujiuer.xyz/tags/Shell/"/>
    
  </entry>
  
  <entry>
    <title>API压测笔记</title>
    <link href="https://mxts.jiujiuer.xyz/2024/03/18/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/API%E5%8E%8B%E6%B5%8B%E7%AC%94%E8%AE%B0/"/>
    <id>https://mxts.jiujiuer.xyz/2024/03/18/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/API%E5%8E%8B%E6%B5%8B%E7%AC%94%E8%AE%B0/</id>
    <published>2024-03-18T14:41:07.000Z</published>
    <updated>2024-06-04T16:42:26.934Z</updated>
    
    <content type="html"><![CDATA[<p>API的压力测试是业务上线前的重要环节，也是对系统性能的一个量化测量，对实际业务诸方面都有重要的参考价值。</p><p>这里主要说说API压测的方法和常用手段。</p><h2 id="压测方法"><a href="#压测方法" class="headerlink" title="压测方法"></a>压测方法</h2><ul><li>go benchmark</li></ul><p>如果是golang后端，可以直接手写测试用例，然后使用go工具链自带的benchmark进行压测。</p><ul><li>ApacheBench</li></ul><p>ab命令会创建多个并发访问线程，模拟多个访问者同时对某一URL地址进行访问。</p><p>安装<code>apache2-utils</code>即可在系统上使用<code>ab</code>命令。</p><p>作为演示，使用ab测试一个GET接口：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ab -n 2000 -c 1200  <span class="string">&quot;http://127.0.0.1:9999/get_result?a=10&amp;b=20&quot;</span></span><br></pre></td></tr></table></figure><ul><li><p>n: 测试轮次</p></li><li><p>c: 客户端数量</p></li><li><p>T: 内容类型</p></li><li><p>p: 包含post参数的文件</p></li><li><p>引号是必须的</p></li><li><p>wrk</p></li></ul><p>一个C编写的API压测工具</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wrk -t10 -c100 -d10s http://localhost:8080/api/users    <span class="comment"># 使用10个线程，100并发数，测试持续10s</span></span><br></pre></td></tr></table></figure><h2 id="开测"><a href="#开测" class="headerlink" title="开测"></a>开测</h2><p>我最后还是选了<code>wrk</code>做压测<del>因为ab装不上</del></p><p>测试接口是<code>POST http://localhost:8080/api/calc/mul</code>，payload是一个2*n的json格式的二维数组。</p><p>测试指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wrk -t 20 -c 10000 -d 180s -s bench.lua --latency <span class="string">&quot;http://localhost:8080/api/calc/mul&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## bench.lua</span></span><br><span class="line">wrk.method = <span class="string">&quot;POST&quot;</span></span><br><span class="line">wrk.body = <span class="string">&quot;[[1,2,3,1],[4,5,7,8]]&quot;</span></span><br><span class="line">wrk.headers[<span class="string">&#x27;Content-Type&#x27;</span>] = <span class="string">&quot;application/json&quot;</span></span><br></pre></td></tr></table></figure><p>测试结果如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">xeonds@ark-station:~/code/vec-calculator-server$ make bench </span><br><span class="line"><span class="built_in">cd</span> build &amp;&amp; ./vec-calc-web-linux-amd64-1.0.0 &amp; <span class="built_in">sleep</span> 1 &amp;&amp; \</span><br><span class="line">wrk -t 20 -c 10000 -d 180s -s bench.lua --latency <span class="string">&quot;http://localhost:8080/api/calc/mul&quot;</span></span><br><span class="line">Running 3m <span class="built_in">test</span> @ http://localhost:8080/api/calc/mul</span><br><span class="line">  20 threads and 10000 connections</span><br><span class="line">  Thread Stats   Avg      Stdev     Max   +/- Stdev</span><br><span class="line">    Latency    61.27ms   62.15ms   1.46s    93.06%</span><br><span class="line">    Req/Sec     9.74k     1.33k   22.11k    71.75%</span><br><span class="line">  Latency Distribution</span><br><span class="line">     50%   48.47ms</span><br><span class="line">     75%   66.32ms</span><br><span class="line">     90%   90.10ms</span><br><span class="line">     99%  364.05ms</span><br><span class="line">  34884275 requests <span class="keyword">in</span> 3.00m, 4.35GB <span class="built_in">read</span></span><br><span class="line">Requests/sec: 193693.29</span><br><span class="line">Transfer/sec:     24.75MB</span><br></pre></td></tr></table></figure><p>测试平台是<code>Intel Core i7-12700H</code>，可以看到并发在<code>1,0000</code>的时候，Gin的性能还是不错的，TPS保持在了19万的水准。</p><h2 id="碎碎念"><a href="#碎碎念" class="headerlink" title="碎碎念"></a>碎碎念</h2><p>该说不该说呢，以前我认为语言就是由语法和编译器&#x2F;解释器构成，但是Golang这样从语法上支持一个feature的行为让我疑惑：语言的标准库该不该算是语言特性的一部分？</p><p><code>go</code>这个关键字作为一个大大的语法糖，似乎在打破语言的库和语言本身的分界线。我也无从知晓这一方向的尽头是什么。</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/609348456">API性能测试指标以及压测方式 - 最难不过二叉树 - 知乎</a></li><li><a href="https://golang.cx/go/golang%E5%8E%8B%E6%B5%8B.html">golang压测</a></li><li><a href="https://www.digitalocean.com/community/tutorials/how-to-benchmark-http-latency-with-wrk-on-ubuntu-14-04">How To Benchmark HTTP Latency with wrk on Ubuntu 14.04 - DigitalOcean</a></li><li><a href="https://stackoverflow.com/questions/15261612/post-request-with-wrk">POST request with wrk? - StackOverflow</a></li><li><a href="https://github.com/gin-gonic/gin/issues/267">Can I disable gin’s stdout? - GitHub Issue</a></li></ul>]]></content>
    
    
    <summary type="html">(*/ω＼*)</summary>
    
    
    
    
    <category term="分布式计算" scheme="https://mxts.jiujiuer.xyz/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%A1%E7%AE%97/"/>
    
    <category term="Benchmark" scheme="https://mxts.jiujiuer.xyz/tags/Benchmark/"/>
    
    <category term="工程化实践" scheme="https://mxts.jiujiuer.xyz/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96%E5%AE%9E%E8%B7%B5/"/>
    
  </entry>
  
  <entry>
    <title>青岛之行</title>
    <link href="https://mxts.jiujiuer.xyz/2024/01/18/%E6%96%87%E5%AD%A6/%E6%B8%B8%E8%AE%B0/trip-to-tsingdao/"/>
    <id>https://mxts.jiujiuer.xyz/2024/01/18/%E6%96%87%E5%AD%A6/%E6%B8%B8%E8%AE%B0/trip-to-tsingdao/</id>
    <published>2024-01-18T05:53:51.000Z</published>
    <updated>2024-06-04T16:42:26.930Z</updated>
    
    <content type="html"><![CDATA[<h2 id="第0天-西安市长安区"><a href="#第0天-西安市长安区" class="headerlink" title="第0天-西安市长安区"></a>第0天-西安市长安区</h2><p>这个考试月是真能破人的防，所以哥们考完试直接开润，好好抚慰以一下难绷的心智。跟哥们合计了一下，寻思着<del>去码头整点薯条</del>然后就有了去青岛溜达一圈的打算。</p><p>现在是1.18，早上随便叼个面包，拉着箱子就走了。今天早上西安的雾气挺大的，走的时候大概9点，门口不少拉箱子回家的大学生，看了一眼感觉不少大三老东西，还有一些大一大二一看就没在校门口坐过公交的。</p><p>时间过得真快啊，还没多久就只剩一年半了。</p><p>抛开有的没的，到站下车转地铁，6倒2到北站等火车。以及再次，西安北站真tm大。</p><p>顺利和彦汇合上，俩人就坐下来开始侃大山，路上风景倒是不错。刚开始计划的路线里边是经过郑州的，不过后来换了D1672然后就不走那边了，现在的路线是西安-&gt;太原-&gt;石家庄-&gt;德州-&gt;济南-&gt;青岛。全程从11点到晚上9点，车程比较长。</p><p>在动车上跟哥们干了各种事消磨时间：看时间，聊二次元等等等等，<del>听得我都想入坑ba了</del>。</p><p>下了车之后直接进了地铁站，七拐八拐到了酒店。这边地铁修的比较新，所以装潢还挺新的。</p><p>出了站之后走了点路就到了酒店。俩人一进酒店就开始开香槟，30块一晚上是这住宿条件：</p><p>更香槟开爆的一集：30多跟哥们恰烧烤外卖恰到撑。老陕震撼.jpg，这边伙食是真不戳。</p><p>就是晚上1点多给另一个哥们写代码到早上3点有点难绷</p><blockquote><p>彦：熬夜别似我旁边<br>我：无所谓我收入高</p></blockquote><h2 id="第1天-青岛海军博物馆-amp-杂七杂八"><a href="#第1天-青岛海军博物馆-amp-杂七杂八" class="headerlink" title="第1天-青岛海军博物馆&amp;杂七杂八"></a>第1天-青岛海军博物馆&amp;杂七杂八</h2><p>第二天<del>起了个大早</del>九点准时起床，身体好像已经习惯六小时睡眠了。简单收拾之后就准备出发去看看船了。放6年前彦估计更兴奋，毕竟他玩碧蓝航线。</p><blockquote><p>哎，泛二刺螈。哦，他现在玩Blue Archive。</p></blockquote><p>笑死，早起根本没用。俩人还是差点迟了。最骚的操作是我们发现时间可能赶不上然后俩啥必退票准备换时间，然后发现别的时间都满了。</p><p>tmd吓个半死，赶紧给重新定回那个时间。俩人跟俩萝卜一样，一人一个坑给剩下俩位置占满了。</p><p>不管时间是不是来不及，俩人开始往过疯狂冲刺。趁着上车的间隙，算了一下时间，刚好剩了3分钟，所幸最后没迟到。</p><p>路上路过一片小区，人建筑风格特别欧式，一度以为是殖民地残留，被哥们吐槽了。</p><blockquote><p>彦：你这得让青岛人笑话死</p></blockquote><p>赶时间所以没想到啥吐槽。穿过博物馆大厅，从扶梯下去，就是海边了。大厅后边就是黄海的海岸线了，码头停了不少待参观的船，潜艇，还有<del>来码头整点薯条的</del>海鸥，不过这会的我显然还没有意识到青岛的海风自带湿冷的魔法攻击。</p><p>没顾得上拍照，赶紧跟着哥们跑去核潜艇参观区域。俩人兴冲冲跟着引导员走到潜艇入口，准备从入口进去。不过刚进去入口的时候我就觉得不对劲了：被狠狠磕了一下脑袋。然后我才注意到，这潜艇里边的环境是真tm狭小。里边是不允许拍照的，所以这部分没有图图。很震撼，有种纯粹工业风的美感，而且还能看到生产日期跟自己爸妈一个年龄的各种粗扩庞大<del>不知道能干啥</del>不可名状的巨大机械&#x2F;管道，元素相当丰富。整体而言，环境相当压抑。居住区空间极小，而且是两层乃至三层的卧铺，躺床上只能看到压抑的上铺床板。更离谱的是，各个区域之间的连通通道不是门结构，而是环状圆盘盖子结构。想了半天，原因可能是为了进一步保证气密&#x2F;作为一种空间隔断手段而使用，以至于人过去是要钻过去的——我自己身高1米8多，已经不是脑袋磕的疼不疼的问题了，那是我弯腰过去会被卡在门上的问题。不过也能理解，毕竟从外边看体积本来就小，里边的空间更是寸土寸金。另外还看到唯一一个很大的房子，俺猜测应该是船长&#x2F;政委的？另外就是这个核动力潜艇很明显属于那种过于落后可以展示的那种，现在的潜艇长啥样子我根本不敢想象。以及这玩意的制造时间也跟我印象里边那会还在为造拖拉机发愁的轻工业为主的年代严重不符——现在回望那会的前辈，相当厉害。快60年前的东西，都能带给我如此巨大的震撼。这种旧时代的堪称疯狂的造物是我非常喜爱的，因为这背后是一个集体倾尽全力所能创造的工程学奇迹。其他宏伟的古早人工造物，比如早些时代的防空洞，那些旧时代的大型工厂，都是我的偏爱。</p><p>就是里边一些现代化电子设备比较出戏。我甚至还看到一个生产日期挺新的电风扇。</p><p>另外一点我想展开说的就是，重工业风。生活中很难见到特别粗的管道，这边有，而且尺寸范围相当大。但是你放工厂我会欣赏，放正常过道两边甚至头顶，盖得你看不到一个平整的仓壁，那就是幽闭恐惧症级别的地狱绘图了。墙上和地上，不是覆盖着，那几乎是管道和数量巨大的阀门、仪表拼接而成，被挤压的只剩下常人几乎不可能迅速通过的极度不规则的逼仄空间。另外我找了半天愣是没找到一个窗户，在这种暗无天日的地方关上不知道多久，一般人在这种地方肯定会疯。而且，潜艇的战略地位，也昭示着潜艇兵的命运：不存在侥幸，深海出故障的情况下，只有死亡这一既定而缓慢但恒定到来的命运。现代核潜艇更是战略级别的威慑，他们所面对的任何一种情况都是极度恐怖的。</p><blockquote><p>彦：这地方你待上没几天就幽闭恐惧症了<br>我：难怪人补贴空军之下第一档呢，这我是真服</p></blockquote><p>最逆天的地方来了。俩人参观完核动力部分，在看主电机的时候，里边照明电路突然断电了。以潜艇的封闭程度，一瞬间里边就陷入一片死黑。</p><blockquote><p>我：啊？<br>彦：啊？？<br>我：啊？？？<br>彦：啊？？？？</p></blockquote><p>所幸，大概十几秒后供电又恢复力。不过这一段时间对我来说长如极夜。那一刻俩啥必都以为自己要被关里头了，怂的跟受惊的兔子似的。应该是拉闸老大爷听到我俩动静了，又上电问里边有人没。俩人赶紧从出口窜出去了。</p><p>最哈人的一集。</p><p>出去之后俩人缓了会，然后上旁边开始今天的观景了。</p><p>首先是济南舰，最后是长江舰。中间回去休息了一下，看到底下一架遮住的飞机，还惊喜了半天。彦不屑一顾，我诧异半天才想起来人是瓜，啊不，三航爷。</p><p>下午拍了一组片子，顺便跟他玩了玩胶片机之后，俩人就出来去信号山旁边一个小地方恰了饭。28一份的土豆牛肉盖饭，好贵……不过胜在离景点近。可惜的是那会德国监狱旧址已经关门了，俩人就去爬旁边信号山了。有一说一，上边视野不错，也出了不少很满意的片。</p><p>最给力的是这俩老鸽：</p><p>亮灯之后拍了不少，遗憾的是树杈子太挡视野了，不太好出片。以及某人痛定思痛决定回头整个脚架。不过那边有不少望远镜，挺稳的，就是要扫码才能用。所以俩人直接用这玩意当脚架平替了。</p><blockquote><p>彦：纯，太纯了（陶醉</p></blockquote><p>之后俩人坐地铁打算去那家甜甜烧烤，可惜让百度地图坑了一回，从台北街道绕了一圈到人旧址了。找到之后发现人就在起点附近。更离谱的是进去只有一个空座，上二楼发现没位置结果下来一楼也满了。红温了.jpg</p><p>没办法，刚好也晚了，在旁边步行街吃了点小吃，坐地铁回宾馆旁边那家烧烤。线上挺好吃的，线下也可以，不过人店面似乎主营是外卖。但是实惠和味道上没让我失望，啤酒上没让我哥们失望。</p><p>干完饭，回酒店睡觉。替哥们负重前行了一天，倒头就睡。</p><h2 id="第2天-麦岛，栈桥，海鸥和薯条，以及代码"><a href="#第2天-麦岛，栈桥，海鸥和薯条，以及代码" class="headerlink" title="第2天-麦岛，栈桥，海鸥和薯条，以及代码"></a>第2天-麦岛，栈桥，海鸥和薯条，以及代码</h2><p>早上看天气预报，这边要下雪，感觉今天天气可能会有点糟……不过好在出去之后倒是没雪。这边天气这几天是冷锋过境，属于是变天如变脸的程度。</p><p>这一天睡到了自然醒。<del>早上</del>中午步行麦岛，被海风吹傻了。不过出片很多。早上一早上在宾馆写代码……至于为啥，合作项目快到ddl了。不过好在早上没出去，风大的虾仁。午饭是张亮麻辣烫和古茗，味道确实可以就是挺贵。</p><p>2点到麦岛，吹海风到3,4点。打车去栈桥<del>捉</del>喂了半天海鸥，哥们的Z50直接ISO爆炸了。6点左右俩人走着上了栈桥溜了个来回，海中间的亭子，别有景致。</p><p>步行到教堂，哥特式建筑美感别具一格，感觉薄纱半道的安妮小屋。另，青岛的地名好像真是按照全国省份起名的。</p><p>拐下去，在K和M的中门对决中选了M。</p><p>然后是1号线，体验了一把6分钟跨海，可惜啥都看不到，就是噪音特大。</p><p>看了中石油大学。石油的爷才是爷！</p><p>然后1号线回台东，路上为了我和另一个哥们的ddl疯狂写代码。居然在手机上搞定了。他也从他导师的侧目微笑里边解脱了。这期间哥们<del>遛</del>牵着我逛了这边一个步行街，规模意外的不太大。尝了下青岛啤酒原浆，苦的，喝不懂。给哥们解决了。</p><p>俩人开始乱逛，跑奥体对面五四广场乱逛听涛。</p><p>打车回宾馆了。洗漱+计划了下行程：济南&#x2F;淄博，启动！</p><p>算了先别启动了，睡觉了。</p><h2 id="第3天-海鸽子鸥，栈桥，小鱼山，德国领事馆旧址，以及夕阳"><a href="#第3天-海鸽子鸥，栈桥，小鱼山，德国领事馆旧址，以及夕阳" class="headerlink" title="第3天-海鸽子鸥，栈桥，小鱼山，德国领事馆旧址，以及夕阳"></a>第3天-海<del>鸽子</del>鸥，栈桥，小鱼山，德国领事馆旧址，以及夕阳</h2><p>这回来青岛最大的成就，就是薅到了<del>海鸽子</del>海鸥。昨天</p><h2 id="第4天-青岛：最澄澈的空与海·太美丽了淄博"><a href="#第4天-青岛：最澄澈的空与海·太美丽了淄博" class="headerlink" title="第4天-青岛：最澄澈的空与海·太美丽了淄博"></a>第4天-青岛：最澄澈的空与海·太美丽了淄博</h2><h2 id="第5天-济南-老舍你最好没骗我"><a href="#第5天-济南-老舍你最好没骗我" class="headerlink" title="第5天-济南-老舍你最好没骗我"></a>第5天-济南-老舍你最好没骗我</h2><p>md，跟老舍爆了，俩人冻的要似。</p><p>早上9点坐高铁到济南。10点多坐地铁到了宾馆。彦已经困的不行了，遂让他睡了一觉。这酒店条件确实不错，还有厨房。</p><p>另外就是济南这边地铁起码是从19年开始修的，这地方东边倒是还行，西边地铁修建难度简直地狱。地下各种复杂的地下水源，断层等等，能有地铁已经很不错了。能看得出来，济南地铁修的很新，而且也符合济南这边的特色：空间辽阔。</p><p>中午出发，先去旁边商超里边吃了一顿午饭。好久没吃米饭，俩人就恰了家石锅拌饭。</p><p>完事之后，我提出想去浪潮集团总部看看打个卡。毕竟在你电浪潮社也待了三年了，不太远（感觉比国医到你电西门的距离近一些），俩人就走过去了。</p><p>另外就是济南地铁</p><h2 id="第6天-返航-最背刺的一集"><a href="#第6天-返航-最背刺的一集" class="headerlink" title="第6天-返航-最背刺的一集"></a>第6天-返航-最背刺的一集</h2><p>早上早早起来，洗漱了下，俩人出门进地铁站。济南这边地铁修的相当新，虽然条形地铁线路比较难换乘，但是有地铁这一点已经薄纱某些地方了，而且还是直达济南东站的。赢！</p><p>最难绷的一集：俩人买票那会发现难买，进站发现人一大群小学生搁那去西安旅游……算是彻底被背刺了。</p><p>路上太原开始这段雪景很绝。白色的斑驳成片覆盖在黄色的平原上，在纯蓝天的映射下格外让人有食欲。</p><p>遂恰饭点了一顿15元高铁套餐。评价是感觉不如…海棠一楼食堂，但是好tm贵QAQ。</p><p>彦这作息跟那啥考拉一样（哎对<del>配色</del>穿搭也差不多）又开始睡了。</p><p>路上边看地图边看风景……注意到前边过黄河了，俩人扒窗边看了会，发现了最符合天气的一集：黄河整个冻住了。不过就算是冻住了风光也很不错。</p><p>另外就是山西太原附近了，风光很有意思，很多谷地，覆上雪景后别有风味。</p><p>路上还路过了香汾，小站没太在意。感知最明显的就是天空从山东沿海地区的澄澈逐渐过渡到熟悉的灰蒙蒙的天空——当然风也小了许多。</p><p>西安站倒是下去溜达了一圈，气候温和多了。就是听到一点疑似关门的动静后赶紧钻回去车里边了。车门旁边倒是还有人趁着到站抽烟的，人家就比我淡定多了。</p><p>之后不久就到站了。温度比沿海地区温和了很多，饱受折磨的俩人一下子放松下来：</p><blockquote><p>彦：这温度谁拉拉链啊<br>：笑死，根本不冷</p></blockquote><p>不过最后某人还是把拉链拉上了。</p><p>俩人混的不错，摇到一个同学开车给我俩接回去了。回去之前几个人一块来搓了一顿<del>mai</del>麦，已经是穷鬼的我必然是点了一份穷鬼套餐，顺便聊了不少时政<del>不是怎么每回的保留环节都是政治乐子啊</del>。另外，宝鸡夜色某种意义上比大明湖强。</p><hr><p>坐着同学的车到了家门口，提下箱子，关门，隔着车门和彦挥了挥手</p><p>转身，离去。</p>]]></content>
    
    
    <summary type="html">(*/ω＼*)</summary>
    
    
    
    <category term="文学" scheme="https://mxts.jiujiuer.xyz/categories/%E6%96%87%E5%AD%A6/"/>
    
    <category term="游记" scheme="https://mxts.jiujiuer.xyz/categories/%E6%96%87%E5%AD%A6/%E6%B8%B8%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>数据库复习笔记</title>
    <link href="https://mxts.jiujiuer.xyz/2024/01/15/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/db-review/"/>
    <id>https://mxts.jiujiuer.xyz/2024/01/15/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/db-review/</id>
    <published>2024-01-15T11:17:19.000Z</published>
    <updated>2024-06-04T16:42:26.934Z</updated>
    
    <content type="html"><![CDATA[<p>这学期学的数据库主要偏向应用，理论部分相对比较少，重点如下：</p><h2 id="数据库系统概论-大纲"><a href="#数据库系统概论-大纲" class="headerlink" title="数据库系统概论 大纲"></a>数据库系统概论 大纲</h2><ul><li>绪论<ul><li>特点，概念，发展</li><li>数据模型：层次，网状，关系</li><li>结构：三级模式，二级映像</li><li>组成</li></ul></li><li>关系数据库<ul><li>关系数据结构</li><li>关系操作！</li><li>关系完整性：实体完整性，参照完整性，用户定义的完整性</li><li>关系代数！</li></ul></li><li>SQL<ul><li>定义{模式，表，索引，数据字典} </li><li>查询：单表，连接，嵌套，集合，派生表</li><li>更新：插入，修改，删除</li><li>空值，试图</li></ul></li><li>安全性<ul><li>安全性控制：用户身份控制，存取控制，自主存取控制,授权&#x2F;收回，抢注存取控制方法</li><li>视图 - 审计 - 数据加密</li></ul></li><li>数据库完整性<ul><li>实体完整性，参照完整性，用户定义的完整性</li><li>完整性约束命名子句</li><li>断言</li><li>触发器</li></ul></li><li>关系数据理论<ul><li>规范化<ul><li>函数依赖 - 码 - 范式 - 2NF - 3NF - BCNF - 多值依赖和4NF</li></ul></li><li>数据依赖的公理系统 - 模式分解</li></ul></li><li>数据库设计<ul><li>数据字典</li><li>概念模型</li><li>E-R模型及其扩充</li></ul></li><li>数据库编程<ul><li>嵌入式SQL：处理过程，通信（游标，动态SQL）</li><li>过程化SQL</li><li>存储过程和函数</li><li>ODBC编程</li></ul></li><li>关系查询处理和查询优化<ul><li>查询处理步骤，优化</li><li>代数优化，物理优化</li></ul></li><li>数据库恢复技术<ul><li>事务概念和特点 - 恢复概述 - 故障种类，恢复技术和策略</li><li>并发控制</li></ul></li></ul><p>整理的不是特别全乎，不过也涵盖不少了。往年大题就那几道，题型相对固定，针对性做题，做会题就算复习完了。</p><p>上面的知识点里边特别重要的就那几个：<strong>关系代数，关系完整性，SQL，关系数据理论和事务与并发，查询优化</strong>这几个。其他零碎的小知识点有印象就行了。</p><p>复习方法一是做题，最好是看答案；二是看例子，例题，然后递归复习知识点，效率最高。三是下策，先看知识点，再做题，适合开始复习比较早，时间充裕的情况，也是最充分的复习，但是问题是容易动力不足。</p><h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><h3 id="CREATE-DROP-ALTER"><a href="#CREATE-DROP-ALTER" class="headerlink" title="CREATE,DROP,ALTER"></a>CREATE,DROP,ALTER</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> SCHEMA <span class="operator">&lt;</span>&quot;name&quot;<span class="operator">&gt;</span> <span class="keyword">AUTHORIZATION</span> &quot;username&quot;;</span><br><span class="line"><span class="keyword">DROP</span> SCHEMA &quot;name&quot; [CASCADE<span class="operator">/</span>RESTRICT];</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> &quot;name&quot;</span><br><span class="line">&#123;   Col1 <span class="type">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    Col2 NUMBER(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    Col3 <span class="type">INT</span> <span class="keyword">FOREIGN</span> KEY(Sno) <span class="keyword">REFERENCES</span> TABLE2(Sno),</span><br><span class="line">    <span class="keyword">CHECK</span>(Col1 <span class="operator">&gt;</span> <span class="number">1</span> <span class="keyword">AND</span> Col1 <span class="operator">&lt;</span> <span class="number">10</span>)</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> schema.tablename&#123;</span><br><span class="line">    <span class="operator">/</span><span class="operator">/</span> 同上</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">CREATE</span> SCHEMA &quot;name&quot; <span class="keyword">AUTHORIZATION</span> &quot;user&quot; <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> &quot;table1&quot;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="operator">/</span><span class="operator">/</span> 同上</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> &quot;name&quot; [<span class="keyword">ADD</span> <span class="keyword">COLUMN</span> name <span class="type">VARCHAR</span>(<span class="number">10</span>) <span class="operator">|</span></span><br><span class="line">                    <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span>(Cname) <span class="operator">|</span></span><br><span class="line">                    <span class="keyword">ADD</span> <span class="keyword">FOREIGN</span> KEY(Cno) <span class="keyword">REFERENCES</span> Student(Cno) <span class="operator">|</span></span><br><span class="line">                    <span class="keyword">DROP</span> Col1 CASCADE<span class="operator">|</span>RESTRICT</span><br><span class="line">                    <span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> “completeness” CASCADE<span class="operator">|</span>RESTRICT</span><br><span class="line">                    <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> Col1 <span class="type">VARCHAR</span>(<span class="number">114514</span>)</span><br><span class="line">];</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> &quot;name&quot; CASCADE<span class="operator">|</span>RESTRICT;</span><br></pre></td></tr></table></figure><h3 id="INDEX"><a href="#INDEX" class="headerlink" title="INDEX"></a>INDEX</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span><span class="operator">|</span>CLUSTER INDEX &quot;index_name&quot; <span class="keyword">ON</span> tableName(Col1 <span class="keyword">DESC</span>, Col2 <span class="keyword">ASC</span>);</span><br><span class="line"><span class="keyword">ALTER</span> INDX &quot;old_index&quot; RENAME <span class="keyword">TO</span> &quot;new_index&quot;;</span><br><span class="line"><span class="keyword">DROP</span> INDEX &quot;index_name&quot;;</span><br></pre></td></tr></table></figure><h3 id="SELECT"><a href="#SELECT" class="headerlink" title="SELECT"></a>SELECT</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">DISTINCT</span><span class="operator">|</span><span class="keyword">ALL</span>] <span class="number">2022</span><span class="operator">-</span>table1.age,table2.Sname</span><br><span class="line"><span class="keyword">FROM</span> [&quot;table1&quot; <span class="operator">|</span> &quot;view1&quot;]</span><br><span class="line"><span class="keyword">WHERE</span> age<span class="operator">&gt;</span><span class="number">5</span> <span class="keyword">AND</span><span class="operator">|</span><span class="keyword">OR</span> age<span class="operator">&lt;</span><span class="number">7</span> <span class="keyword">AND</span> Sdept<span class="operator">=</span><span class="string">&#x27;CS&#x27;</span> <span class="keyword">AND</span> age [<span class="keyword">NOT</span>]  <span class="keyword">BETWEEN</span> <span class="number">20</span> <span class="keyword">AND</span> <span class="number">30</span> <span class="keyword">AND</span> Sdept <span class="keyword">IN</span>(<span class="string">&#x27;CS&#x27;</span>,<span class="string">&#x27;MA&#x27;</span>) <span class="keyword">AND</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;张____&#x27;</span> <span class="keyword">AND</span> GRADE <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Col2 <span class="keyword">HAVING</span> <span class="built_in">AVG</span>(Grade)<span class="operator">&gt;=</span><span class="number">90</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> Col1 <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p>连接查询时，列举全部属性列，去掉相同的列就是自然连接。</p><p>单表连接查询：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> Course.FIRST, Course.SECOND</span><br><span class="line"><span class="keyword">SELECT</span> FIRST.Cno, SECOND.Cpno</span><br><span class="line"><span class="keyword">WHERE</span> FIRST.Cpno<span class="operator">=</span>SECOND.Cno;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>外连接查询</span><br><span class="line"><span class="keyword">FROM</span> table1 <span class="keyword">LEFT</span><span class="operator">|</span><span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> table2 <span class="keyword">ON</span><span class="operator">|</span><span class="keyword">USING</span>(table1.sno<span class="operator">=</span>table2.sno) <span class="operator">/</span><span class="operator">/</span> <span class="keyword">USING</span>去重</span><br></pre></td></tr></table></figure><p><code>%_</code>任意字符、一个字符，汉字<strong>长两个字符</strong></p><p>子查询使用<code>IN</code>关键字，阅读&#x2F;构造时从内部构造。下面的例子相当于是将子查询的结果作为父查询的语句的参数了。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sno, Sname, Sdept</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Sdept <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> Sdept</span><br><span class="line">    <span class="keyword">FROM</span> Student</span><br><span class="line">    <span class="keyword">WHERE</span> Sname<span class="operator">=</span><span class="string">&#x27;lex&#x27;</span></span><br><span class="line">) <span class="keyword">AND</span> xxx;</span><br></pre></td></tr></table></figure><p>还有<code>EXISTS</code>子查询，跟上边<code>IN</code>差不多，不过意思是将”至少存在一个查询结果“作为查询选择器的条件。</p><p>多个查询可以用<code>UNION,, INTERSECT, EXCEPT</code>分别进行并，交，差三个集合运算，目标的数据结构必须相同。</p><h3 id="INSERT-UPDATE-DELETE"><a href="#INSERT-UPDATE-DELETE" class="headerlink" title="INSERT,UPDATE,DELETE"></a>INSERT,UPDATE,DELETE</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">table</span>(Col1, Col2) [</span><br><span class="line">    <span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="string">&#x27;4&#x27;</span>) <span class="operator">|</span> </span><br><span class="line">    <span class="keyword">SELECT</span> xxx <span class="keyword">FROM</span> xxx <span class="keyword">WHERE</span> xxx <span class="keyword">GROUP</span> <span class="keyword">BY</span> xxx</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">table</span></span><br><span class="line"><span class="keyword">SET</span> Col1<span class="operator">=</span>xxx</span><br><span class="line"><span class="keyword">WHERE</span> cond;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">table</span></span><br><span class="line"><span class="keyword">WHERE</span> cond;</span><br></pre></td></tr></table></figure><h3 id="VIEW"><a href="#VIEW" class="headerlink" title="VIEW"></a>VIEW</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> vname(Col1,Coln)</span><br><span class="line"><span class="keyword">AS</span> 子查询</span><br><span class="line">[<span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION]</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> xxx;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> vname CASCADE</span><br></pre></td></tr></table></figure><h3 id="空值"><a href="#空值" class="headerlink" title="空值"></a>空值</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xxx <span class="keyword">IS</span> [<span class="keyword">NOT</span>] <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">(*/ω＼*)</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>2023这一年</title>
    <link href="https://mxts.jiujiuer.xyz/2023/12/31/%E6%96%87%E5%AD%A6/%E6%9D%82%E8%B0%88/2023%E8%BF%99%E4%B8%80%E5%B9%B4/"/>
    <id>https://mxts.jiujiuer.xyz/2023/12/31/%E6%96%87%E5%AD%A6/%E6%9D%82%E8%B0%88/2023%E8%BF%99%E4%B8%80%E5%B9%B4/</id>
    <published>2023-12-31T12:30:31.000Z</published>
    <updated>2024-06-04T16:42:26.930Z</updated>
    
    <content type="html"><![CDATA[<p>时间过得真快啊。一转眼已经过去5&#x2F;8个大学了。</p><span id="more"></span><p>记得去年这个时候，我还是和同学在语音里闲聊着，一起等着跨年。然后，2023，就在我们几个的闲聊中拉开了序幕。比较幸运的是，放开之后，没啥大的折腾，nCov-19终于慢慢销声匿迹了。还好，终于能有个比较正常的大学生活了。</p><p>冷清的窗外，忽的传来几声烟花爆裂的声音，提醒着我，这一年确实是过去了。家里只有父母和奶奶，静悄悄的。大人们都早早睡下了，毕竟还要工作。深冬的寒夜里我依旧在思考，但又不知道在想什么。或许只是借助思考打发孤独罢了。</p><p>哦对了，去年那会差点喜提新机：跟某同学去完市图书馆之后，回家放东西的时候手没拿稳直接drop it了。还好机器主体没啥问题，就是屏幕漏液痛失360元。不过当时脑子一抽打开2077看了下效果，嗯，更沉浸了。</p><h2 id="一，二月"><a href="#一，二月" class="headerlink" title="一，二月"></a>一，二月</h2><p>过年前还跟哥们出去浪了一会，顺便被一个南科大的哥们请恰了一顿饭。毕竟帮人家搞定了课程大作业确实挺不容易的，就是不知道这孩子有啥想不开的，一个学金融的非要选Java……反正逛的是挺爽的：顶着刚疫情还没恢复的身子去爬山差点没给我爬入土了。后面几天有一天在发小家里聊到好晚，还带了一袋子自己炸的薯条分而啖之。他很喜欢米家的游戏，<del>倒是跟我刚好相反</del>反正跟原切割了。不过这不重要，反正见面的话题永远聊不完：两个天差地别的专业，聊啥都是新鲜的；更重要的是，还好现在远没到拉家常的年纪，我们暂且都还是比较有趣的人。</p><p>转眼就是过年。现在春节用春晚作为背景音的都很少了，拜完年串完门，烧纸的烧纸，上坟的上坟。村子里的人是一年比一年少，有些房子变新了，也变冷清了；有些房子门前已经满是杂草，无人打理许久了。偶尔请些亲戚来家里做客才能稍微驱逐些寂寥，有点小孩就更热闹了——可惜，现在他们对于手机更感兴趣。</p><p>跟哥们一块看了《流浪地球2》，感觉比1提升不小。导演功力到位，华仔演技在线，剧情不错，就是叙事节奏有改进空间。在这之后，ChatGPT就第一次问世了。</p><h2 id="三，四月"><a href="#三，四月" class="headerlink" title="三，四月"></a>三，四月</h2><p>机械性的春节后，该上学的上学，该上班的上班，一切照旧。去年没有考的试就放到了开春来考，队友想专心复习，顶不住压力，就放弃了美赛。临阵垮台，于是参加美赛的机会从三次变成了两次。如果想要给考研加点分的话，那就只能指望大三寒假咯。队友不太好意思，遂请我们吃了个<del>散伙</del>饭。想说些啥，但是也没啥好说的。那会的大学时间还有不少，机会也是。</p><p>到这里，节奏基本还行，但是对于大二下的恶毒我还是始料不及。三月，四月，又是期中考试，实验陆续开始。西电的传统是实验报告大多手写，于是免不了应付这些繁文缛节。加上课内作业，而且最重要的是，我还是选了最累的活法：打了一堆毛毛雨一般的竞赛。最忙的时候，手头同时有6，7个任务得搞定。</p><p>我发现我好像那个什么抖m，净喜欢给自己找罪受。</p><p>不过这些倒还好，属于是有惊无险地都干完了。真正难绷的事情才刚刚开始。虽然没有rx那么强的开发效率，但是我还是接下了同学拉我去做的烂摊子。那本来是个挺简单的vue+springBoot标准前后端项目，最后做的我怀疑人生，差点放弃前端。那项目我打5月接手的时候看了下需求，感觉多是多，但是能做——然后我就被另一个哥们封装的，小山包一样的屎山代码糊脸了。这个后面说。另外那段时间也把鸽了整一年的OJ拉出来重新写了，刚好能用上新学的东西，这会应该算是真正开始熟悉了Vue和Golang这俩现代开发语言的用法。</p><p>不得不提的还有大模型，人类史上用户量最快达到一亿的玩意，没有学术上的美感，有的只是空前庞大的恐怖算力，工业界的暴力美学所创造出的前所未有的奇迹——能力只有文字接龙，但是能力强到让许多人开始担心自己的饭碗，甚至有人认为它的智能快达到临界点了。</p><p>以及就是业余无线电能力测试。一晚上速通，拿上A证了。上了两年大学，好在应试能力留了一些。</p><h2 id="五月"><a href="#五月" class="headerlink" title="五月"></a>五月</h2><p>5月是实验的谎言。一个月天天是实验，周周有实验报告要写。好在有几个能直接提交电子打印版的，借助历史的积淀秒了。不过实验本身也够占时间的，导致我错过了半个晒你祭（恼）。5.13早上当了会门口引导的志愿者之后，把俩<del>二刺螈</del>同学从隔壁瓜大领进去光了会，拍了几个coser，就被电子线路实验带走了。俩小时速通之后，展子还在，但是不剩啥节目了。事后同学表示，这Live神中神，特别是那个鼓手定得一批。</p><blockquote><p>我：我tm在做实验没听到啊啊啊啊<br>：你这辈子就是让实验给害了</p></blockquote><p>不过还好，4月还是3月喜提新哥们，还是意外盒到的酷安群u（甚至刚好还是个潜在越共）,5月初有长安THO，就给他拽过去逛车万展子了。好像之后还陪着他娶了个新旧电脑（无误），他的古董电子产品收集喜加一。也是他的影响让我开始怀疑我对算力需求的必要性了。也是月初，发小还去上海逛cp29（还是多少）了，买周边就花了小1k。只能感叹某些二次元的行动力真的强，一个人从西安跑上海还跟特种兵似的，基本所有重要地方都打卡过了。</p><p>这个月还跟浪潮的朋友们出去团建了。19级的学长到这个点也基本都未来既定了，值得庆祝的是学长们去向还都相当可以。西电保研清华的老学长还来回来逛了一圈，可惜比较社恐也就没聊几句。感叹一句，浪潮这些学长水平真的都好强啊。</p><p>还有一回是得知西安的亲戚住院了，很震惊，顶着大雨跑雁塔去看望了。越发感叹身体的重要性，尤其叔叔他上的班还是长期熬夜那种，很伤身体。于是之后也下定决心少熬夜<del>但是只有一点点</del>。巧的是这地方刚好离你电老校区不远，就顺便跑过去逛了一圈。刚开始在家属区里溜达了半天，最后才找着进去学校的路。刚好去听了个EDA公司的校企合作实验室揭榜，顺便第一回线下见到了你电的校长<del>之一</del>。可惜的是去晚了，没白嫖到讲座送的礼盒。</p><p>后面雨突然特别大，打着伞都给你打一身溅射伤害那种，于是刚好趁这个时间逛了下你电的老图书馆。好像那种老楼都喜欢修得很高，这玩意外边看着还行，里边有足足十一层。看了下都是些研究生学长学姐在自习&#x2F;看书&#x2F;写论文，座位倒是比南校区多很多。随机roll到本Hadoop的书看了下，然后就下楼了。</p><p>在雨里边看着路边树上挂的一排诗歌的牌子，还有你电老校区的老苏式宿舍楼，感觉有种回到小时候的感觉。</p><p>不过雨太大了，于是跑到食堂去了。老校区食堂还不错，便宜大碗。然后也不知道怎么突然想起来，也是去年这几天，袁隆平院士走了。然后出门看着雨都变了个滋味。</p><h2 id="六月"><a href="#六月" class="headerlink" title="六月"></a>六月</h2><p>之后就是复习，考试了。这之间学校里边“报复式”地办了不少活动，比如什么大学生音乐节。完事之后也到六月了，刚好也到19级老东西们爆金币的时候了。说起来去年这会刚送走小梦，现在看电表还在维护，真是感慨万千。当时学原生安卓开发，还是向小梦哥哥请教的很多问题。现在学长已经在字节干了快一年半两年了，希望一切都顺利吧。</p><p>另外就是，把原来那个B450的AMD平台板U条套装换成了RD450X的Intel Xeon平台的板U套装了。不过因为电源输出端口不够的原因，买了个电源在路上还没运回来。一直拖到下个月才装好。不过有一说一，双路E5真的爽啊，特别是拿来跑各种数据挖掘算法的时候，那速度真的吊着普通消费级处理器打，12700H要跑十几分钟的k-means聚类，这玩意只要几十秒；编译的时候<code>make -j56</code>更是爽的一批。</p><p>考试完了之后也算是去逛一逛，光速约了一堆哥们（重大失误，约人的时候尽量少点，特别里边不少都不是特别熟的人）跑去爬华山。上山的过程嘛很爽，跟几个好朋友一路边吐槽边往上走，晚上山上风景倒是也别有风味，尤其是看着一路上一条条光点连成的线条，以及山脚下<del>万家</del>灯火，有种说不出来的震撼。几个哥们爬到中峰就爬不动了，我倒是莽上去东峰了，就是半路上两条腿轮流抽筋实在有点酸爽。</p><p>最后倒是亲眼看到了完整的日出，太阳从一个小点慢慢变得越来越红火，越来越大，感觉一晚上的努力也值了。</p><p>下山实在不想说了，建议是千万别人多的时候爬山，真的够你喝一壶了，氪金都不能速通的那种痛（虽然主要是因为一晚上没睡觉）。乱七八糟的事让这事虎头蛇尾地结束了，也从此对华山这地方有了ptsd。这种景区建议最好先对周边了解清楚之后再去。</p><p>然后回了学校，就是为期一周的军训。大学的军训比印象中高中那会红河谷那次水多了，基本就是每天上午8点集合，站一个上午军姿&#x2F;学走正步&#x2F;整队之类的。教官和我们同岁，所以也比较仁慈<del>放水</del>。最后军训完了之后，也刚好到暑假了。</p><h2 id="暑假"><a href="#暑假" class="headerlink" title="暑假"></a>暑假</h2><p>跟好哥们去网安大楼天台上溜达了一圈，风景真的不错。夕阳刚好，空无一物的天空让人心情无比平静，很大程度上也排解了之前的糟心事的影响。小赵真的是个很好的人，希望他未来能被世界温柔以待吧。后来也跟他合作整过一个小项目，我写前端，他做硬件。不得不说，这还是我第二次做一个这么贴近硬件的项目。可能以后遇到硬件方面的需求的话，我真的能用一个esp32整出不少活吧。</p><p>之后几天，跟隔壁瓜大两个哥们线下联机打了一段时间的MC Java原版生存。这游戏也陪着我走过了起码快十年了吧？小学玩过，初中玩过，高中也跟舍友玩过，大学了还在玩，可能这就是开放世界的魅力吧。当然，我们三个彩笔打了两三天还没通关，光停下来造房子造基地了，末地门都还没找到呢。趁着这段时间，顺便逛了一圈<del>瓜大</del>东大村，评价是比你电周边丰富多了。以及西工大校内，虽然学校地方比较偏僻，但是瓜大的校内生活似乎也还行。特别是同学宿舍晚上基本不关门这点薄纱你电，以及瓜大的风景真不是吹的，到处都是好机位，依山傍水，出图书馆就是四时之景。而且瓜大的图书馆真的大，里边甚至有商超那种大电动扶梯，一堆自习位置，靠窗的位置学累了还能看会风景。另外关于这点，彦的自习常用位置是四个书架合围的一个小空间里边。</p><blockquote><p>：你是不喜欢看风景吗<br>彦：学习要讲究一个氛围<br>：嗯所以呢<br>彦：你想想mc里边附魔台周围都要围一圈书呢<br>：合着你给你自个附魔呢是</p></blockquote><p>中间有一回回学校拿电脑（mc果然得几个人联机才有意思），顺便带他俩在学校里（再次）溜达了一圈。中间带他俩去部室打了会sdvx差点给主线任务忘了<del>音批是这样的</del>。那之后带他们rua了会大鹅，以及在B楼底下不定期出没的黑子，拿上电脑恰了个饭，就打车回瓜大了。然后几个彩笔被循声守卫轮流锤死不知道多少次。之后不知道为啥瓜的<del>唐</del>航小天莫名其妙火了，然后莫名其妙跟你电的<del>唐</del>西小电联动了（？）</p><blockquote><p><del>唐</del>航小天可爱捏</p></blockquote><p>另外就是另一个鸽子精那会也从哈尔滨回来了。摇了几个朋友出去小聚了一下。后面基本就只剩下天天写代码肝外包项目了。哦对，还有偶尔去学校游泳池游个泳啥的。顺带还带着一个同学大概学会了怎么在水里扑腾（</p><p>这个假期最主要的就是俩外包项目，硬是把github commits从不到300刷到了600+。接了俩外包，在学校干了俩月。靠着外包挣的一点钱给整了个平板，升级了服务器，整了个便携屏，给笔记本升级到32+8的抽象内存组合了。8月份，同学来打电赛省赛，还迎带同学溜达了一圈。那阵子雨天挺多的，一阵秋雨一阵凉，感觉西安这地方只有夏天跟冬天俩季节。中间回家了一趟，好在家里没啥大问题。在宝鸡拉着同学出去溜达了一圈，比较离谱的是他们见到了个核酸检测点之后集体发电，不存在的记忆增加了.jpg</p><p>后面回了西安之后，还遇到高中同学来西安逛。俩人聊天聊了一个通宵。回去之后不知道咋想的突然就想给电脑换个Arch<del>然后就找到目前最理想的系统了</del>。</p><h2 id="九月"><a href="#九月" class="headerlink" title="九月"></a>九月</h2><p>ISC招新，感受到自己已经确实是个大三老东西了。趁着开学听了好多校招会，虽然本科大概率没有直接就业的想法。比较幸运的一点是，小米的校招会上还抽到个Xiaomi Sounds Pro。可惜不是声学发烧友，倒是让几个好哥们爽了一回。</p><p>月中跟哥们去看了奥本海默，确实是好片，没别人说的那么难懂，就是太过沉迷剧情，两个人三回标题都没拍下来打卡，最后只拍下来个龙标，笑死。后来跟他速通了下西安理工金花校区，苏联老楼给我留下了极其深刻的印象<del>有种回家的错觉</del>。</p><blockquote><p>回来没两天就是湖人哥一战成名的时刻了。</p></blockquote><p>后面就是第一回参加开源社区活动，壮着胆子讲了回Linux，起码没翻车。顺便线下了好多酷安&#x2F;OSC群的群u<del>当然最后也是没逃过来自群u的盒打击</del>。后一天去车万组活现场瞅了一眼，在放漫才，确实很有节目效果。</p><p>之后就是星铁&#x2F;崩坏的啥活动，俩哥们跑去线下打卡来着，顺便又聚了一回，又三个人速通了回西安理工新校区。一个崩批一个铁批行动力是真强，晚上嗯走七个打卡点打卡，我在干啥，我那会好像在边走边在给电脑装Arch<del>Arch To Go</del>。顺便几个人吐槽了一波西安依托的地面交通。</p><p>月底，那个外包项目也因为各种问题凉了。说实话心里很不是滋味，并且对于这种任务之后心里都没了底。说不上来是好是坏。</p><p>25号，一个20级研究生学姐跳了，在此之前西电好像已经十几年都没跳的了。不知道是什么让她做出了这样的选择。对她的行为我不应也不想做出评价，对于这个结果还是希望逝者安息吧。</p><h2 id="十月"><a href="#十月" class="headerlink" title="十月"></a>十月</h2><p>国庆+中秋调休，回去家里参加了邻家姐姐的婚礼。后面又和几个同学在宝鸡的小地方到处乱逛了一回，作为国庆的收尾。</p><p>这个月后面的就是音乐会，迎新歌会之类的。活动确实不少，还跟高中来打比赛的学弟们见了回面，时间真快啊。</p><p>后面14号是浪潮的迎新晚会，15号还有你电的百团大战。现场特别热闹，酷安群的抽象海报和那张顶针专辑的关注度挺高的。</p><blockquote><p>早知道，还是原道.jpg<del>触发悔恨之泪</del></p></blockquote><p>后面跟着彦和辰出去溜达，没处去的时候<del>骗</del>带他俩来打maimai，俩人打得倒是不亦乐乎。后面看到一个用币随机抽天子手办的机器之后就走不动道了，把白嫖的币用完也没拿到qaq</p><p>这个月也发布了不少手机平板之类的。米14发布那天同学还拉着我去线下摸了真机器，还有华子那个特别大的平板冲击力也不小。</p><h2 id="十一月"><a href="#十一月" class="headerlink" title="十一月"></a>十一月</h2><p>这个月也挺魔幻的，以一个重大删库事件为开端。不过实际影响并没有那么大，毕竟开源什么时候死过。</p><p>中间去电信的陕西主干IDC机房参观过。现代化的工业美学，真的帅的顶天。包括垂直化冗余能源设计，应急热交换塔（真的是个塔），特大号的备用发电机组机房和热交换机组机房，帅惨了。反倒是核心的业务机房，特别规整，<del>环境优美</del>倒是没啥特别突出的，不过单就这一间机房的装机量以及那个密堆叠，加上天花板走线，真的帅。这机房的数据吞吐量更是恐怖，出口时延&lt;2ms，出口带宽16.4T（没见标注的单位是啥，应该是bps吧）。，</p><p>比较难绷的是介绍企业文化的时候，听到那个半部电台起家还以为在讲你电校史呢。另外比较惊喜的就是展示产品的时候，一个陈列墙上挂了很多相当大时间跨度的移动通信终端，甚至还有大哥大。回了学校之后刚好赶上各种国企的校招，就去凑了个热闹。</p><p>之后就是贴吧高校头像异变事件了。隔壁瓜大唐小天火遍全网，你电唐小电也一触即发。最后俩cp学校吧头官宣联动了。</p><p>月中，籽岷的工作站组装好了，然后子建就顺道来西安送东西+装机&#x2F;溜达了。刚好有人电脑有问题，子建就把家伙拿上了。来都来了不拿个电脑顺带清清灰说不过去，但是因为服务器全塔实在背不动就只拿了俩笔记本。先给兆廷把液金换成了7958sp，然后某人就得液金ptsd了。更难绷的是兆廷电脑的热管因为玄学的剪切力弯了，不过无伤大雅，某人也没时间倒腾这问题了。</p><p>当天晚上我们几个还是继续推主线任务，给籽岷把他的工作站部署好顺带给一群人的电脑清灰+换硅脂<del>反正7958sp又放不住不用白不用</del>。但是离谱的是遇到玄学问题，明明子建拿来的时候已经给系统+专业软件都装好了，结果突然不能开机了。没办法，我跟子建就轮流干清灰&#x2F;debug的活。最后整了半天没找出来问题，灰倒是都清完了。更离谱的是我俩一堆WinPE一个都进不去，然后我脑子一抽打算进我U盘上自带的Arch LiveCD试试。感谢Linux启动日志，我很快就把问题锁定到那个蓝盘上了。果然，替换法试了下，那个蓝盘莫名其妙挂了。</p><p>完事之后已经快早上五六点了，本来说完事打打mc呢也没时间了，睡吧。好在我们仨在东大村找了个宾馆住了一晚上，休息的也还行。第二天起来让籽岷换个固态，另一个哥们则是完全被整麻了。不过好在之后换了盘之后，远程指导同学分区装系统打驱动，一遍过。</p><p>事后彦看着我们当晚的工作场面照，评价说我们跟一群准备攻打瓜大的黑客一样。没绷住。另外就是被霓虹的场子做工震撼到了，那个松下的机子我第一回见到那么分体式的主板，而且也是我继G15之后见到的第二个风扇装主办背面的笔记本。换硅脂的时候我如履薄冰战战兢兢生怕抠的太用力给晶圆一块带走了，因为这东西硅脂已经彻底硬化了，估计是从16年到现在就没换过硅脂。好在有惊无险地清理完了。下午带子建在瓜大逛了一下午，以及中间难绷的是彦差点被他们点名拿下一血，好在没事。刚好这回来的时候他们在修飞机展示区，虽然不太了解军事但是这堆真货是真的帅。</p><p>以及后面清完灰之后发现手上这个松下的本子安静过头了，本来想赞扬下子建清灰手法高超，直到我拆开机器之后发现：</p><blockquote><p>哥们忘插风扇电源了，那能不安静吗.jpg<br>狠狠拷打.jpg</p></blockquote><p>之后就是各种上机&#x2F;实验了，给我时间全占完了基本，导致瓜大的车万展子咱都没去成。哦月底还感冒了一回，不过还好是普通感冒，来得快去得也快，可能也是因为这学期报的散打强度比较大提升了免疫力？月末的电子线路课设差点给我带走，不过还好有惊无险过了。</p><p>29号酷安群线下k70发布会，印象最深的不是手机而是chi哥的发型。</p><h2 id="十二月"><a href="#十二月" class="headerlink" title="十二月"></a>十二月</h2><p>ISC这个月开了几次讲座，有我提议的Linux基础，还有AI那边发起的机器学习概论。质量都不错，场面也挺热闹的。</p><p>顺便几次差一点线下了Dimole，不过这孩子好像挺多灾多难的，希望人没事.jpg</p><p>然后月初带家里人来学校里逛了回，月中<del>被大一学弟带</del>带大一学弟打了星火杯。</p><p>12.15 今年的第一场雪。</p><p>12.16 三刷六级，微原实验，以及生日。</p><p>12.18 23:59 第一次被地震警报吵醒，希望甘肃同胞平安。</p><p>12.19 和好朋友去设了台，算是半个HAM了。</p><blockquote><p>没想到的是西电湖人的落幕带来的是西电冰人的出现，电专学子永远是会整活的。</p></blockquote><p>月底出去跟朋友溜达了一次，圣诞节跟一个未知的朋友交换了礼物，忙了一个月的各种ddl，</p><p>12.30 跟同学出去溜达就当提前跨年了。先是和彦在香积寺里边做了一下午的光影猎手，然后和兆廷在师大万科恰了顿饭，时间真快。</p><p>月初很忙，月末也忙，忙忙碌碌的一个月。</p><hr><p>这篇流水账从28号开始写，到现在也刚好3天了，再过几个小时，人类又要庆祝自己小小的行星绕着恒星走过了一圈。年年如此，未来也将如此。</p><p>这个敲了半天的薄膜键盘，是我在高考完那个暑假买的，一个普通的键盘。它连上过我的老台式机，笔记本，以及现在这个松下笔记本，快三年了，它也老了：大部分按键因为写代码的摧残，已经被磨成了白色。左Shift也因为频繁使用，已经卡的吱吱嘎嘎的响。</p><p>看着键盘，想想我自己，好像也差不多。本科排课问题的摧残，jwc烂活的摧残，跟甲方搏斗的摧残，在某些方面我也逐渐迟钝起来，行动力也不如从前。似乎高考前那阵子是我行动力最强的时候，一个人凭着兴趣就写了快四千行代码，给自己和朋友们做了个小玩具。或许这也是一种磨损？</p><p>有时候真觉得自己老了，写不动了。不过这两年写的其实也并不少，甚至就那个因为各种原因烂尾的项目，我提交的代码可能都有几万行。相比于几年前，我确实进步了不少：纯粹依靠自己一个人做到的东西，上限越来越高了。特别是视野开拓了不少，现在能用很多学科的知识去解决实际问题了。不过最重要的还是热情，这几年挖过不少坑，甚至还在酷安发过自己编写的应用，给开源社区贡献了一个博客聚合系统的实现，也被收到了水表里边，作为博客星球的后端，在讲座上讲过两次技术相关的内容。竞赛也打了不少，奖也是。</p><p>不过，即使面对天堑我也不想停下，因为我就是想做到我想做的事。和自己和解能解决很多问题，但是我不想，只因为我不服这个自己。所以我一次次挑战自己。即使陷入迷惘，也不想停下步伐，因为这比找不到路更可怕。</p><p>现在已经是晚上了，冬天的太阳落山早，天已经黑了。舍友一个回家了，一个出去跨年了。宿舍只剩我一个，宿舍空荡荡的，也没开灯。对着空荡荡的Vim敲了半天，心里有种说不上来的孤独。这算不算是一种孤独编程？（笑）</p><p>还没感叹完呢，那几个哥们已经在商量着连麦跨年了。白孤独了（x</p><p>变的倒是很多，不变的也挺多。至少在外边，还有这些狐朋狗友陪着我，不是吗？</p><hr><p>你好，2024。有什么展望的话，希望明年写流水账的时候，能来点更精彩的。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;时间过得真快啊。一转眼已经过去5&amp;#x2F;8个大学了。&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>函数式编程范式</title>
    <link href="https://mxts.jiujiuer.xyz/2023/12/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/functional-thinking/"/>
    <id>https://mxts.jiujiuer.xyz/2023/12/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/functional-thinking/</id>
    <published>2023-12-11T14:00:41.000Z</published>
    <updated>2024-06-04T16:42:26.942Z</updated>
    
    <content type="html"><![CDATA[<p>对于大部分场合而言，优化不需要过早，到了需要优化的时候自然会意识到必要性。过早的优化只会带来负担。</p><p>最近JS写多了，都快不会写算法题了。其实不怪JS，只是绝大多数具体业务的实现一般很少需要用到什么重要算法。不过我遇到的问题是代码写烦了：这里写一坨那里写一坨，写一些忘一些，最后就成了一大坨，看着多但是实际功能并没多少。这让我想到了代码表达力的问题，于是我开始寻找方法去提高代码的表达力：写更少的代码，实现更多的功能。代码变得紧凑对于检查和维护来说也能降低一部分负担。</p><p>于是，我自然而然地正式接触到了函数式编程。对于当前的需求，这似乎就是答案。</p><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><blockquote><p>下面这段是我和LLM一块写的</p></blockquote><p>函数式编程（Functional Programming）是一种编程范式，区别于命令式编程关注指令和操作，函数式编程更加关注函数本身，函数的组合、副作用，流程和代码可读性。函数作为一等公民，基本上可以在任何位置上出现。它关注函数的施用，而非具体操作的实现。这种编程风格强调将数据抽象为函数，将函数作为基本构建块来构建复杂的计算。函数式编程的优势包括：可读性、可维护性、可重用性等。</p><p>首先为啥叫函数式，因为函数就是核心，一切围绕函数展开。刚上手时，我对它的印象就是</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data.<span class="title function_">map</span>(...).<span class="title function_">filter</span>(...).<span class="title function_">reduce</span>(...)</span><br><span class="line">data.<span class="title function_">forEach</span>(...)</span><br></pre></td></tr></table></figure><p>这样的。只用这几个函数对数据进行操作就能完成大部分数据操作，这对于处理各种返回值得到裁剪&#x2F;过滤过的目标数据而言，十分高效简洁。在这两个例子里边，代码将数据处理作为一个流程对待，我们只需要描述<strong>如何</strong>处理这个数据源，以及处理的规则，其他的都无需我们参与。同样的需求，使用命令式编程，我们需要：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> processed=[]</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;data.<span class="property">length</span>;i++)&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable constant_">MATCHING_COND</span>)</span><br><span class="line">        processed.<span class="title function_">push</span>(data[i])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>为什么？因为上面的<code>map</code>，<code>reduce</code>，<code>filter</code>和<code>forEach</code>等都是高阶函数，它们可以被应用于数据源，接受一个函数作为参数，并使用函数处理数据。它们封装了常用的处理数据的流程，比如<code>map</code>会将数据的每一项使用传入的函数进行变换，并将它输出到新的数组中；<code>filter</code>会使用传入函数处理每一项，根据返回值是否为真将数据放入一个新的数组中并返回，等等。每一个高阶函数都是对于一个具体的数据处理流程的抽象描述，而这部分就是传统的命令式编程难以解决的问题——它们关注具体指令，你需要依靠具体的指令来解决你面对的问题，并自己编写具体的处理过程。</p><p>在上面传统的解决方法中，我们创建了变量<code>processed</code>，创建了用于循环的变量<code>i</code>，还使用了循环并规定了循环的结束条件，在循环体中规定了将结果加入循环的条件和流程。这些操作都在函数式操作中被抽象成了若干个高阶函数，我们无需再关心具体如何实现<code>map</code>和<code>filter</code>等操作，更不用自己去管理其中的状态（比如循环变量和用于保存中间处理结果的变量），实现了<del>降本增效</del>用少量代码完成常见需求，并减少了我们花费在状态管理（循环变量的创建，自增，临时变量的创建和改变等）和具体实现上的细节，而让我们只专注于和任务本身相关的部分。</p><p>并且，我们使用传递参数的方式将它们<strong>组合</strong>在一起，而非通过继承将它们<strong>耦合</strong>在一起。这一点意味着函数式编程降低了代码的耦合度，并且提高了代码的复用率：比起来面向对象按照类，通过继承进行复用，函数式编程将复用粒度降低到函数的级别，这也显著减少了无用代码。不过继承除了复用，还有规范和约束实现的作用。函数式编程如何解决这个问题我暂时还不太清楚。不过函数式编程，面向对象编程以及元编程，这三者属于是几乎正交的关系，所以完全可以交叉使用没啥问题。</p><p>另外还有一点上面的例子并没有表现出来，那就是关于副作用这一点。这个说法应该和不可变这一点放在一起来讲：上面的循环变量<code>i</code>就是一个可变的变量，循环的副作用就是改变了这个变量的值。再比如C指针的经典例子：通过<code>swap</code>交换两个变量的值，这就是一个典型的有副作用的函数，它改变了传入参数的值。函数式编程之所以排斥这样做，就是因为它在尽量避免函数的副作用，试图将所有函数变为纯函数：函数的执行结果只依赖于输入的值，而和外部状态无关，并且不改变外部的状态。它借此消除副作用带来的不确定性。而数据的不可变是它消除不确定性的另一个方法，这里就是函数式编程的精髓了：没有可变变量要怎么迭代&#x2F;处理数据？不用迭代了，用递归就行。使用递归也提供了另一个观察问题的方式，比如对上面的迭代筛选例子，我们就可以用递归来改写，从而避免使用循环变量<code>i</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> processed=[]</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">iter</span>=(<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span>(data.<span class="property">length</span>==<span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(data[<span class="number">0</span>] <span class="variable constant_">MATCHES_COND</span>)</span><br><span class="line">            <span class="keyword">return</span> data[<span class="number">0</span>] + <span class="title function_">iter</span>(data[<span class="number">1</span>:]);</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">iter</span>(data[<span class="number">1</span>:])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面的代码没用任何可变变量，也完成了数据源的筛选。虽然初次接触不太好想，但是解决大部分问题时，另一种视角确实有时会有意想不到的便利。以及不可变变量的好处也挺多的，比如天然没有竞争和并发问题。</p><p>另外关于递归的性能问题，用尾递归可以在受到递归优化的编程语言中得到不输迭代的性能。比如经典的斐波那契数列计算函数，就可以通过尾递归的写法结合语言的优化，达到和迭代写法基本一致的性能。</p><blockquote><p>下边这例子是LLM写的，暂时没验证</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个高阶函数，用于计算两个数的和</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line"> <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用高阶函数组合两个函数，用于计算两个数的和</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">calculator</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用高阶函数组合器，并传入两个数字作为参数</span></span><br><span class="line"><span class="keyword">const</span> add = <span class="title function_">calculator</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用高阶函数组合器，并传入两个数字作为参数</span></span><br><span class="line"><span class="keyword">const</span> subtract = <span class="title function_">calculator</span>(<span class="function"><span class="params">a</span> =&gt;</span> a - b);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用高阶函数组合器，并传入两个数字作为参数</span></span><br><span class="line"><span class="keyword">const</span> multiply = <span class="title function_">calculator</span>(<span class="function"><span class="params">a</span> =&gt;</span> a * b);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用高阶函数组合器，并传入两个数字作为参数</span></span><br><span class="line"><span class="keyword">const</span> divide = <span class="title function_">calculator</span>(<span class="function"><span class="params">a</span> =&gt;</span> a / b);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试计算器函数</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>(<span class="number">2</span>, <span class="number">3</span>)); <span class="comment">// 输出 5</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">subtract</span>(<span class="number">5</span>, <span class="number">2</span>)); <span class="comment">// 输出 3</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">multiply</span>(<span class="number">2</span>, <span class="number">3</span>)); <span class="comment">// 输出 6</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">divide</span>(<span class="number">10</span>, <span class="number">2</span>)); <span class="comment">// 输出 5</span></span><br></pre></td></tr></table></figure><h2 id="组合"><a href="#组合" class="headerlink" title="组合"></a>组合</h2><p>组合和继承，都是复用代码的重要手段。组合简洁，继承稍微冗杂一些。</p><p>组合的概念就是将一些现有的单元组合到一起，形成新的工具去解决具体问题，而组合这个动作的适用对象就不止是函数那么简单了。它可以是函数的组合，可以是类型的组合，也可以是状态和函数的组合。</p><p>借<del>从某大佬那里偷来的</del>一个说法，大多数新的语法结构就是让人们更合理地去使用固定范式的GOTO，而Algebraic Effect就是其中最合理<del>那个佬最推崇</del>的一个。从我的视角看来，主流编程语言的演进都是朝着可读可写且尽可能兼顾效率的方向发展的。在这个过程中，损失的一部分就是语言的”Tricks”，或者说是语言的灵活性&#x2F;可能性等。比如GOTO受到的接连削弱，它从一个十分灵活的结构变成了一堆固定但是更理智的语法结构，以一部分灵活性为代价换取了语言的可读性，以此提升可维护性。</p><p>组合呢？组合也是一种对于GOTO的封装。甚至更底层的，汇编中的GOTO，（部分）也就是jmp，它在汇编中也有对应的封装：子程序。而这些说法，对于指针这个原始的内存模型中的概念同样适用。封装提高了可读性，限制GOTO的直接使用限制了代码的可写性。二者的矛盾在足够优秀的语法结构出现前基本上是一对难以调和的矛盾。</p>]]></content>
    
    
    <summary type="html">(*/ω＼*)</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>winget换源</title>
    <link href="https://mxts.jiujiuer.xyz/2023/12/09/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/winget/"/>
    <id>https://mxts.jiujiuer.xyz/2023/12/09/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/winget/</id>
    <published>2023-12-09T12:35:48.000Z</published>
    <updated>2024-06-04T16:42:26.934Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://unicom.mirrors.ustc.edu.cn/help/winget-source.html">winget 是 Windows 的一个包管理器，可以用来安装、卸载、更新和搜索软件。winget 默认使用的是 Microsoft Store 的源，但是也可以换成其他的源，比如中科大的源。</a><a href="https://unicom.mirrors.ustc.edu.cn/help/winget-source.html">1</a><a href="https://www.zhihu.com/question/509903409">2</a></p><p>如果您想换源，您需要以管理员身份运行终端，然后使用以下命令：</p><ul><li>删除默认的源：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">winget <span class="built_in">source</span> remove winget</span><br></pre></td></tr></table></figure><ul><li>添加中科大的源：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">winget <span class="built_in">source</span> add winget https://mirrors.ustc.edu.cn/winget-source</span><br></pre></td></tr></table></figure><ul><li>重置为官方的源：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">winget <span class="built_in">source</span> reset winget</span><br></pre></td></tr></table></figure><p><a href="https://unicom.mirrors.ustc.edu.cn/help/winget-source.html"></a><a href="https://unicom.mirrors.ustc.edu.cn/help/winget-source.html">1</a><a href="https://unicom.mirrors.ustc.edu.cn/help/winget-source.html">: WinGet 源使用帮助 — USTC Mirror Help 文档</a> <a href="https://www.zhihu.com/question/509903409">2</a>: winget是否可以用国内镜像？ - 知乎</p>]]></content>
    
    
    <summary type="html">(*/ω＼*)</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>pandoc初窥</title>
    <link href="https://mxts.jiujiuer.xyz/2023/12/09/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/pandoc_note/"/>
    <id>https://mxts.jiujiuer.xyz/2023/12/09/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/pandoc_note/</id>
    <published>2023-12-09T12:10:50.000Z</published>
    <updated>2024-06-04T16:42:26.934Z</updated>
    
    <content type="html"><![CDATA[<p>pandoc 是一个使用 Haskell 语言编写的一款跨平台、自由开源及命令行界面的标记语言转换工具，可实现不同标记语言间的格式转换，堪称该领域中的“瑞士军刀。pandoc 支持的输入和输出格式范围广泛，包括但不限于 Markdown、HTML、DOCX、PDF、LaTeX、EPUB 等。</p><p>pandoc 不是 python 的库，但是有一个 python 的封装，叫做 pypandoc，可以在 python 代码中调用 pandoc 的功能。pypandoc 可以使用 pip 命令安装，例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pypandoc</span><br></pre></td></tr></table></figure><p>pandoc 的日常用法主要是通过命令行来转换文档，例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandoc input.md -o output.html</span><br></pre></td></tr></table></figure><p>这个命令就是将 input.md 这个 Markdown 文件转换为 output.html 这个 HTML 文件。pandoc 还有很多其他的选项和参数，可以参考 pandoc 的文档。</p><p>pandoc 也可以在 python 代码中使用 pypandoc 来转换文档，例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pypandoc</span><br><span class="line">output = pypandoc.convert_file(<span class="string">&#x27;input.md&#x27;</span>, <span class="string">&#x27;html&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br></pre></td></tr></table></figure><p>这段代码就是将 input.md 这个 Markdown 文件转换为 HTML 字符串，并打印出来。pypandoc 还有其他的方法和参数，可以参考 pypandoc 的<a href="https://blog.csdn.net/VN520/article/details/129120364">文档</a>。</p><p>pandoc 是一个非常强大和灵活的文档转换工具，可以帮助你在不同的文档格式之间进行转换，特别是对于 Markdown 这种简洁易用的标记语言，可以轻松地生成 PDF、电子书、幻灯片等多种形式的文档。</p><h2 id="格式转换"><a href="#格式转换" class="headerlink" title="格式转换"></a>格式转换</h2><p>刚好今天得提交个Word报告，但是写东西我还是喜欢Vim，于是就打算写完转换成Word。正打算手动转换&#x2F;网页在线转换的时候想起来了这个玩意——</p><p>然后就一行秒了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandoc -o $(OUTPUT) -f markdown -t docx $(MARKDOWN) </span><br></pre></td></tr></table></figure><p>我直接从Makefile里摘出来的。用Makefile的话，写完敲个make就行。</p><p>最让我吃惊的是这玩意速度奇快,转换个快4000字的Markdown到Word，几乎跟我echo个字符串一样快，这还是我在7代intel移动端平台上测试的(?A?)</p><ul><li>Markdown转Tex，速度也很快<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandoc -w latex ./test.md -o test.tex</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">(*/ω＼*)</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>计算机视觉学习笔记</title>
    <link href="https://mxts.jiujiuer.xyz/2023/11/06/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>https://mxts.jiujiuer.xyz/2023/11/06/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2023-11-06T12:02:29.000Z</published>
    <updated>2024-06-04T16:42:26.942Z</updated>
    
    <content type="html"><![CDATA[<p>之前导论课程上学的基本都是思想和原理，到这里就开始接触真正数学和工程的方法了。</p><h2 id="序"><a href="#序" class="headerlink" title="序"></a>序</h2><p>这门课的研究思路很清晰，就是围绕标题，自底向上，借助数学工具，一步一步实现各种复杂的功能以及算法，最终一步步接近让计算机拥有“视觉”的目标。</p><p>首先是数据的表示，概念的抽象，如何用离散的数据去近似抽象的视觉这个概念。这个过程通过直观理解和数学工具，以及建模方法，为计算机视觉提供了一种可行的数学上的表示和运算方法：像素，以及基于像素的一系列运算，比如滤波，仿射变换，更高自由度的变换，基于像素颜色值的变换等等，以及由这一系列变换得到的图像特征。</p><p>其次，是研究在图像的像素模型下，利用数学方法去研究分析以及利用图像特征的方法。这其中，就有诸如角点检测，边缘检测，全景图拼接以及处理等命题。</p><h2 id="生成对抗网络GAN"><a href="#生成对抗网络GAN" class="headerlink" title="生成对抗网络GAN"></a>生成对抗网络GAN</h2><p>通俗来说就是让两个网络作为对抗组，比如说生成图片的NN和鉴别图片的NN，两方轮流作为输入输出（也就是交替训练），在循环中不断提升两个网络的效果，最终达到生成内容以假乱真的效果。NN炼丹的关键是其中的loss函数设计，不过他们的做法是直接用另一个NN作为这个NN的loss函数来回馈训练效果。</p><p>目前比较突出的成果一个就是近几年的Stable Diffusion，算是这里边比较突出的一个了。这东西在图像的有损压缩里边用的也多，至于有损压缩的应用嘛，一般在一些需要使用算力去换带宽的场合很适用，比如卫星数据传输。其他应用就是图像的填充和补全，比如合理推测图像的缺失部分内容。另外就是，网络的输入不一定是噪声，输出也不一定是真假。改变其输入和输出的类型，可以赋予NN以不少是实用场景。</p><p>GAN的优点是效果好，比以前用的高斯模糊的效果都很好。但是问题也很突出，就是GAN很难训练。GAN的两方是生成器和判别器，训练的结果很大程度上与两方的能力是否足够接近有很大关系。</p><p>另外就是GAN的思想重点在对抗，并没有要求其他的条件。所以比如说可以有多个判别方，有多个生成方等。</p><h2 id="Attention-Is-All-You-Need"><a href="#Attention-Is-All-You-Need" class="headerlink" title="Attention Is All You Need"></a>Attention Is All You Need</h2><p>注意力机制一开始是应用于机器翻译领域，通过一个合适的重点词语权重标注机制，让算法更有重点地提取概要。如今的GPT也很大程度上受到注意力机制的启发才产生了不断预测下一个词向量概率的朴素思想。</p><p>注意力机制可以理解成给分词加上权重。将一个句子进行分词作为一个向量，将这个词语向量通过Softmax这样的激活函数进行处理之后，再借助矩阵进行变换，从而得到处理后的，带有权重的词向量。处理后的词向量，权重总和为1。加权后的句子，再进行翻译，效果就会好很多了。</p><p>至于将Attention思想迁移到CV领域进行应用的方法，关键是将图像”语义化“。一个常用的方法是将图像分割，分割成小块，对每个小块采用相同的思想。这就是VIT（Vision Transformer）的思想。</p><h2 id="激活函数"><a href="#激活函数" class="headerlink" title="激活函数"></a>激活函数</h2><h3 id="Softmax"><a href="#Softmax" class="headerlink" title="Softmax"></a>Softmax</h3><p>Softmax函数是一种常用的激活函数,主要用于将多分类问题中的输出值转换为概率分布。在神经网络中,输出层通常使用softmax函数,将输出值转换为每个类别概率。</p><p>Softmax函数的定义如下:<br>$$<br>Softmax(x) &#x3D; e^(x_i) &#x2F; (e^(x_1) + e^(x_2) + … + e^(x_n))<br>$$<br>其中,x是一个K维向量,Softmax函数的输出也是一个K维向量,并且每个元素的范围都在0到1之间,并且所有元素的和为1。</p><p>在多分类问题中,假设输出层有K个神经元,每个神经元代表一个类别。Softmax函数的作用是将输出层的输出转换为每个类别对应的概率。例如,如果输出层输出为[1.2, 2.3, 3.1],则对应的概率为[0.21, 0.34, 0.45]。</p><p>Softmax函数可以解决输出值非常大的问题,因为它可以防止输出值过大而导致的梯度消失或梯度爆炸。此外,Softmax函数还可以进行归一化,使得概率和为1,使得概率分布更加合理。</p><h2 id="期末划重点咯"><a href="#期末划重点咯" class="headerlink" title="期末划重点咯"></a>期末划重点咯</h2><blockquote><p><code>sudo 老师给我分</code></p></blockquote><p>有个压缩包，里边画红钩的都是重点</p><p>占比大概NN和传统方法4-6开</p><ul><li>Chap 1 没啥重点<ul><li>什么是光， 可见光谱的范围这些的</li><li>人的视觉系统这些概念啥的</li><li>三色光的相关内容</li></ul></li><li>Chap 3 重点<ul><li>灰度图（取值范围），RGB</li><li>图像两种基本运算</li><li>矩阵的运算</li><li>滤波概念，高斯滤波</li><li>卷积，点乘积，性质，计算过程strike, padding计算结果图像尺寸这些的</li></ul></li><li>Chap 4 边缘检测<ul><li>边缘定义,为啥是边缘</li><li>图像的梯度</li><li>噪声</li><li>边缘检测器：sobel算子,roberts算子,prewwit算子等</li><li>边缘存在的问题：噪声，拟合等</li></ul></li><li>Chap 6 图像插值<ul><li>线性插值，上下采样等，高斯金字塔</li><li>图像放大的插值算法（超分）<ul><li>最近邻，双线性，三次插值。不过现在都用GNN做超分了</li></ul></li></ul></li><li>Chap ? 特征匹配<ul><li>典型特征匹配计算方法</li><li>特征和特真不变性：啥特征的啥不变性 SIFT特征</li></ul></li><li>Chap 7 图像变换<ul><li>几种变换方式</li><li>线性变换：变灰度，变尺度等</li><li>按照变换剧烈程度递增：平移，旋转，仿射，投影</li><li>得记得变换矩阵的特征,大概得看明白</li></ul></li><li>Chap 8 图像配准 没啥讲的</li><li>Chap 11 单视图建模<ul><li>消失线和消失点等 得会计算</li></ul><ul><li>双试图立体视觉：视差和深度计算</li><li>窗口配准</li><li>极点极线极面</li><li>本质矩阵，基本矩阵是谁到谁的映射</li><li>深度估计</li></ul></li><li>Chap 14 图像三维重建<ul><li>一个相机转着拍 内参矩阵不变，为了配窗</li><li>重复的问题</li></ul></li><li>Chap 16 机器视觉<ul><li>激活函数和矩阵计算</li><li>神经网络结构</li><li>卷积网络的池化操作</li></ul><ul><li>反向传播：对w求导而非对x求导，而且得会算反向传播函数</li></ul></li><li>Chap 18 图像分割<ul><li>语义分割和实例分割</li><li>分割手段：边缘检测,聚类等方法</li></ul></li><li>Chap 19 目标检测与分类<ul><li>输出：中心型，边界型</li><li>两个方法：两步法，一步法（Yolo）</li></ul></li><li>Chap 21 实操<ul><li>玩玩pytorch</li></ul></li><li>Chap 23 神经网络前沿<ul><li>GAN</li><li>Attention(q,k,v)<ul><li>Softmax</li></ul></li></ul></li></ul><h2 id="计算机视觉复习"><a href="#计算机视觉复习" class="headerlink" title="计算机视觉复习"></a>计算机视觉复习</h2><p>找到一个学长的复习笔记如下</p><h3 id="图像和图像滤波"><a href="#图像和图像滤波" class="headerlink" title="图像和图像滤波"></a>图像和图像滤波</h3><ul><li><p>什么是滤波</p><blockquote><p>形成一个新的图像，其像素是原始像素的组合</p></blockquote></li><li><p>什么时候利用滤波</p><ul><li>&#x3D;&#x3D;<strong>增强图像：</strong>&#x3D;&#x3D; 降噪、锐化</li><li><strong>&#x3D;&#x3D;提取信息：&#x3D;&#x3D;</strong> 提取边缘或轮廓</li></ul></li></ul><p><strong>滤波的种类：</strong></p><ul><li><p>线性滤波：用相邻的线性组合 （加权和）替换每个像素</p><ul><li>线性组合的系数称为权重核</li></ul><p><strong>卷积：</strong>(权重核反转（水平和垂直）)<br>$$<br>G [ i , j ] &#x3D; \sum _ { u &#x3D; - k } ^ { k } \sum _ { v &#x3D; - k } ^ { k } H [ u , v ] F [ i - u , j - v ]<br>$$<br>记为<br>$$<br>G&#x3D;H*F<br>$$<br><strong>相关：</strong><br>$$<br>G [ i , j ] &#x3D; \sum _ { u &#x3D; - k } ^ { k } \sum _ { v &#x3D; - k } ^ { k } H [ u , v ] F [ i + u , j + v ]<br>$$<br>记为：<br>$$<br>G &#x3D; H \otimes F<br>$$</p></li><li><p>高斯滤波</p><blockquote><p>&#x3D;&#x3D;从图像中删除 「高频」分量 （低通滤波器）&#x3D;&#x3D;</p></blockquote><p>&#x3D;&#x3D;高斯核函数&#x3D;&#x3D;：<br>$$<br>G _ { \sigma } &#x3D; \frac { 1 } { 2 \pi \sigma ^ { 2 } } e ^ { - \frac { \left( x ^ { 2 } + y ^ { 2 } \right) } { 2 \sigma ^ { 2 } } }<br>$$</p></li></ul><p><strong>滤波的应用</strong></p><ul><li><p>锐化滤波器：<br>$$<br>F + \alpha (F-F*H)<br>$$</p></li><li><p>阈值滤波器<br>$$<br>g ( m , n ) &#x3D; \left{ \begin{array} { c c } { 255 , } &amp; { f ( m , n ) &gt; A } \ { 0 } &amp; { \text { otherwise } } \end{array} \right.<br>$$<br>&#x3D;&#x3D;阈值滤波器不是线性滤波&#x3D;&#x3D;</p></li><li><p>相关和卷积的定义和关系</p></li><li><p>高斯核</p><ul><li>调节哪个参数</li></ul></li><li><p>什么是线性滤波器</p></li><li><p>去燥使用什么滤波</p></li></ul><h3 id="边缘检测"><a href="#边缘检测" class="headerlink" title="边缘检测"></a>边缘检测</h3><h4 id="边缘的特征"><a href="#边缘的特征" class="headerlink" title="边缘的特征"></a>边缘的特征</h4><blockquote><p>怎样通过导数来反映边缘</p></blockquote><ul><li>&#x3D;&#x3D;对于图像强度的一阶导数，边缘对应于导数的极值&#x3D;&#x3D;</li></ul><p><strong>如何计算数字图像的导数？</strong></p><ol><li><p>重建连续图像，然后计算导数</p></li><li><p>采用离散导数（有限差分）: &#x3D;&#x3D;图像的梯度相当于两个相邻像素之间的差值&#x3D;&#x3D;<br>$$<br>\frac { \partial f } { \partial x } [ x , y ] \approx F [ x + 1 , y ] - F [ x , y ]<br>$$<br>可以使用线性滤波器实现</p><p>&#x3D;&#x3D;梯度的方向 <strong>垂直于边缘的方向</strong>&#x3D;&#x3D;，梯度的方向是 图像函数 f(x,y) 变化最快的方向，当图像中存在边缘时，一定有较大的梯度</p></li></ol><h4 id="图像梯度"><a href="#图像梯度" class="headerlink" title="图像梯度"></a>图像梯度</h4><p>图像梯度是图像函数在 x ,y 两个方向的导数，</p><p>幅值:<br>$$<br>| \nabla f | &#x3D; \sqrt { \left( \frac { \partial f } { \partial x } \right) ^ { 2 } + \left( \frac { \partial f } { \partial y } \right) ^ { 2 } }<br>$$<br>方向：<br>$$<br>\theta &#x3D; \tan ^ { - 1 } \left( \frac { \partial f } { \partial y } &#x2F; \frac { \partial f } { \partial x } \right)<br>$$<br><strong>&#x3D;&#x3D;要计算图像梯度，首先要图像去噪，使用高斯核在图像上卷积，平滑图像&#x3D;&#x3D;</strong></p><p>可以将两次滤波 （高斯滤波、差分滤波）合成一步实现</p><p><img src="http://media.sumblog.cn/blog/20190102/XhVYP5it42Yb.png?imageslim" alt="mark"></p><h5 id="二维边缘检测使用的图像算子："><a href="#二维边缘检测使用的图像算子：" class="headerlink" title="二维边缘检测使用的图像算子："></a>二维边缘检测使用的图像算子：</h5><ol><li><p>Sobel 算子</p><p><img src="http://media.sumblog.cn/blog/20190102/PIUiMGyShLVT.png?imageslim" alt="mark"></p></li></ol><h4 id="非最大抑制"><a href="#非最大抑制" class="headerlink" title="非最大抑制"></a>非最大抑制</h4><p>检查像素是否为<strong>沿梯度方向的局部最大值</strong> （需要进行像素差值？）</p><ol start="2"><li><p>&#x3D;&#x3D;Canny 边缘检测器&#x3D;&#x3D;</p><ol><li>用高斯导数滤波</li><li>获得梯度的幅值和方向</li><li>非最大抑制</li><li>连接与滞后阈值化：<ul><li>定义高低两个阈值</li><li>用&#x3D;&#x3D;高阈值来寻找边缘曲线的起点，用低阈值来确定后继点&#x3D;&#x3D;，进行连接</li></ul></li></ol><p><strong>Canny 边缘检测器的参数：</strong></p><ul><li>$\sigma:$ 高斯模糊的宽度：大的 $\sigma$ 可以检测大尺度边缘，$\sigma$ &#x3D;&#x3D;越小，能检测到的细微边缘就越多&#x3D;&#x3D;</li><li>高阈值</li><li>低阈值</li></ul></li></ol><ul><li>图像的导数</li><li>图像的梯度是什么 （两个方向的导数）（复制和方向）</li><li>去噪</li><li>二维边缘检测<ul><li>列举几个图像算子</li></ul></li><li>费最大值抑制</li><li>边缘检测器</li></ul><h3 id="图像的插值和重采样"><a href="#图像的插值和重采样" class="headerlink" title="图像的插值和重采样"></a>图像的插值和重采样</h3><h4 id="图像采样"><a href="#图像采样" class="headerlink" title="图像采样"></a>图像采样</h4><ul><li><p>采样率</p><p>&#x3D;&#x3D;<strong>奈奎斯特采样率：</strong> 采样率 &gt;&#x3D; 2*图像中的最大频率&#x3D;&#x3D;</p></li></ul><p><strong>若原始图像的频率过高，先对图像滤波，然后子采样</strong>，构建高斯金字塔</p><h4 id="图像插值"><a href="#图像插值" class="headerlink" title="图像插值"></a>图像插值</h4><ul><li>最近邻差值：重复 n 次</li><li><strong>双线性插值</strong>： 利用输入图像中与输出图像像素点映射位置最邻近的4个像素点的颜色值(或灰度值)计算输出图像中像素点的颜色值(或灰度值)</li><li>双三次插值：为了得到更精确的(x’,y’)的颜色值(或灰度值)g(x’,y’),就不仅需要考虑与(x’,y’)点最邻近的四个点对它的影响,还要考虑到该点周围16个相邻点的颜色值(或灰度值)对它的影响。</li></ul><h3 id="角点检测"><a href="#角点检测" class="headerlink" title="角点检测"></a>角点检测</h3><p>Harris 角点检测：将窗口平移，比较平移前后 w 内每个像素的差异平方和（SSD）<br>$$<br>E ( u , v ) &#x3D; \sum _ { ( x , y ) \in W } [ I ( x + u , y + v ) - I ( x , y ) ] ^ { 2 }<br>$$</p><p>$$<br>\begin{aligned} E ( u , v ) &#x3D; &amp; \sum _ { ( x , y ) \in W } [ I ( x + u , y + v ) - I ( x , y ) ] ^ { 2 } \ \approx &amp; \sum _ { ( x , y ) \in W } \left[ I ( x , y ) + I _ { x } u + I _ { y } v - I ( x , y ) \right] ^ { 2 } \ \approx &amp; \sum _ { ( x , y ) \in W } \left[ I _ { x } u + I _ { y } v \right] ^ { 2 }\  \approx Au^2+2Buv +Cv^2\ \end{aligned}<br>$$</p><p>$$<br>A &#x3D; \sum _ { ( x , y ) \in W } I _ { x } ^ { 2 } \quad B &#x3D; \sum _ { ( x , y ) \in W } I _ { x } I _ { y } \quad C &#x3D; \sum _ { ( x , y ) \in W } I _ { y } ^ { 2 }<br>$$</p><p><strong>算法实现：</strong></p><ol><li><p>计算图像在 X， Y 两个方向的梯度</p></li><li><p>计算两个方向上梯度的乘积</p></li><li><p>使用高斯函数对 $I_x^2,I_y^2,I_xI_y$ 进行高斯加权，生成矩阵的元素 A，B，C</p></li><li><p>计算每个像素的 Harris 响应值 R， 并对小于某个阈值的 R 置 0<br>$$<br>R &#x3D; \left{ R : \operatorname { det } M - \alpha ( \operatorname { trace } M ) ^ { 2 } &lt; t \right}<br>$$</p></li><li><p>在邻域内进行非最大抑制，局部最大值即为图像的角点</p></li></ol><h3 id="特征不变性"><a href="#特征不变性" class="headerlink" title="特征不变性"></a>特征不变性</h3><p>我们希望角点的位置对光度变换具有不变性 （图像变换之后，角点位置不变），对几何变换具有协变性 （相应位置检测到同一特征）</p><p><strong>不变性：</strong></p><ul><li>对平移、旋转协变</li><li>对强度平移具有不变性，对强度缩放不具有不变性</li><li>对缩放不具有不变性<ul><li>需要同时在位置和尺度上查找：自动尺度选择</li></ul></li></ul><p><strong>自动尺度选择：</strong></p><ul><li>在高斯金字塔中使用固定大小的窗口，寻找具有局部最大值的尺度</li></ul><p><strong>斑点检测：</strong></p><blockquote><p>斑点是指二维图像中和周围颜色有颜色差异和灰度差异的区域,因为斑点代表的是一个区域,所以其相对于单纯的角点,具有更好的稳定性和更好的抗干扰能力.</p></blockquote><ul><li><p>核函数：</p><ul><li><p>高斯拉普拉斯：<br>$$<br>\nabla ^ { 2 } g &#x3D; \frac { \partial ^ { 2 } g } { \partial x ^ { 2 } } + \frac { \partial ^ { 2 } g } { \partial y ^ { 2 } }<br>$$</p></li><li><p>高斯差分函数<br>$$<br>D o G &#x3D; G ( x , y , k \sigma ) - G ( x , y , \sigma )<br>$$</p></li></ul></li><li><p>当 $$\sigma &#x3D; r&#x2F;\sqrt{2}$$ 时，响应最大，图像黑白反向时，响应最小，因此将高斯拉普拉斯算子响应达到峰值的 $\sigma$ 值，称为特征尺度</p></li><li><p>怎么实现特征的不变</p></li><li><p>Harris 检测的步骤</p></li></ul><h3 id="特征描述与匹配"><a href="#特征描述与匹配" class="headerlink" title="特征描述与匹配"></a>特征描述与匹配</h3><h4 id="特征描述符"><a href="#特征描述符" class="headerlink" title="特征描述符"></a>特征描述符</h4><ul><li><p><strong>MOPS</strong>:</p><ol><li>选取特征点周围 40*40 的方形窗口</li><li>缩放到 1&#x2F;5 大小</li><li>旋转特征向量方向到水平</li><li>在以特征为中心的 8*8 方形窗口内采样</li><li>规格化 （强度减去平均值，除以标准差，均值为0，方差为1）</li></ol></li><li><p><strong>SIFT：</strong>尺度不变特征转换</p><p><img src="http://media.sumblog.cn/blog/20190102/52PLX111WYbj.png?imageslim" alt="mark"></p><ol><li>在所检测的特征周围取 16*16 的窗口</li><li>为每个像素计算边缘方向</li><li>去除弱的边缘方向（设定阈值）</li><li>为剩余边缘方向建立直方图</li></ol></li></ul><h4 id="特征匹配"><a href="#特征匹配" class="headerlink" title="特征匹配"></a>特征匹配</h4><ul><li><p>特征距离</p><ul><li><p>更好的方法：距离比</p><p>$f_2$ 是 $f_1$ 在 $I_2$ 中最好的 SSD 匹配，$f_2^\prime$ 次之<br>$$<br>距离比 &#x3D; \frac{||f_1-f_2||}{||f_1-f_2^\prime||}<br>$$</p></li></ul></li><li><p>测量特征匹配的性能</p><ul><li>真正例率（TPR） （召回率） &#x3D; 匹配到的真正例数 &#x2F; 所有真正例数</li><li>假正例率 （FPR） &#x3D; 匹配到的假正例数&#x2F;所有真正例数</li><li>ROC 曲线：以 FPR 为横轴，TPR 为纵轴</li><li>AUC：曲线下的面积，越大越好</li></ul></li></ul><h3 id="变换与卷绕"><a href="#变换与卷绕" class="headerlink" title="变换与卷绕"></a>变换与卷绕</h3><p>什么是图像卷绕：<strong>更改图像的定义域</strong></p><p><strong>常见的变换</strong></p><ul><li>平移</li><li>欧式变换：平移+旋转</li><li>相似变换：平移+旋转+等比放缩</li><li>仿射变换：平移+旋转+等比放缩+剪切</li><li>投影变换：原来平行的线不再平行，但还是保持直线性</li></ul><h4 id="线性变换"><a href="#线性变换" class="headerlink" title="线性变换"></a>线性变换</h4><ul><li>等比缩放： 比例S</li><li>旋转角度 </li><li>剪切</li><li>镜像</li></ul><blockquote><p><strong>线性变换的性质</strong></p><p>原点到原点</p><p>直线到直线</p><p>平行线保持平行</p><p>比率被保持</p><p>线性变换的组合是线性变换</p></blockquote><p>平移不是 2D 坐标上的线性变换，我们需要 <strong>添加一个坐标</strong> -&gt; <strong>齐次坐标</strong></p><h3 id="仿射变换"><a href="#仿射变换" class="headerlink" title="仿射变换"></a>仿射变换</h3><p><strong>任何最后一行 为 [0,0,1] 的 3·3 矩阵表示的转换称为仿射变换</strong>，<strong>仿射变换是线性变换和平移的组合</strong></p><p>变换完成后，平面位置不变</p><p>基本的仿射变换：</p><ul><li><p><strong>平移、缩放、2D 平面旋转、剪切</strong> </p><p><img src="http://media.sumblog.cn/blog/20190105/Je0CygVwaYrM.png?imageslim" alt="mark"></p></li><li><p><strong>仿射变换是线性变换 + 平移</strong></p></li></ul><p><strong>性质</strong></p><ul><li>原点不一定到原点</li><li>直线到直线</li><li>平行还平行</li><li>保持比率</li><li>闭包</li></ul><h3 id="透视变换、投影变换、同态映射"><a href="#透视变换、投影变换、同态映射" class="headerlink" title="透视变换、投影变换、同态映射"></a>透视变换、投影变换、同态映射</h3><blockquote><p>最后一元素固定为1 ，共有8个参数， <strong>是成像平面的变换</strong>，仿射变换是特例</p></blockquote><ul><li>原点不一定映射到原点</li><li>平行线不一定保持平行</li><li>不保持比率</li><li>闭包</li></ul><h4 id="卷绕"><a href="#卷绕" class="headerlink" title="卷绕"></a>卷绕</h4><p>卷绕有两种：</p><ol><li>前向卷绕</li><li>反向卷绕</li></ol><p>变换后的像素位置如果不是整数： <strong>将像素值分配给四个最近邻，记录每个点的权重并在最后归一化</strong></p><blockquote><p>效果：混叠与模糊</p></blockquote><ul><li><p><strong>反向卷绕</strong></p><p>先获取每个像素在原图像中对应的位置处的像素值 （逆变换）</p><p>如果像素位置不是整数，利用原来相邻像素值插值</p><ul><li>可能的插值滤波器<ul><li>最近邻</li><li>双线性</li><li>双三次</li><li>窗 sinc</li></ul></li><li>需要防止锯齿和混叠（需要预先滤波）</li></ul></li><li><p>变换有哪几种</p></li><li><p>卷绕有两种</p><p>卷绕之后产生了非整数值怎么办</p></li><li><p>常见的变换</p><ul><li>旋转</li><li>平移</li><li>基本仿射变换</li><li><strong>仿射变换的含义是什么</strong></li></ul></li></ul><h3 id="图像配准"><a href="#图像配准" class="headerlink" title="图像配准"></a>图像配准</h3><p>配准算法的流程，怎么实现</p><ul><li>特征提取</li><li>匹配</li><li>反向变换</li><li>插值</li></ul><p>优化方式</p><p><strong>最小二乘法</strong></p><h4 id="图像配准算法"><a href="#图像配准算法" class="headerlink" title="图像配准算法"></a>图像配准算法</h4><p><strong>给定图像 A 和 B</strong></p><ol><li>计算 A、B 的图像特征</li><li>匹配 A、B 之间的特征</li><li>使用匹配集计算 A 到 B 的单应映射矩阵的最小二乘解</li></ol><h4 id="最小化残差平方和"><a href="#最小化残差平方和" class="headerlink" title="最小化残差平方和"></a>最小化残差平方和</h4><p>定义残差：<br>$$<br>\begin{array} { l } { r _ { \mathbf { x } _ { i } } \left( \mathbf { x } _ { t } \right) &#x3D; \left( \mathbf { x } _ { i } + \mathbf { x } _ { t } \right) - \mathbf { x } _ { i } ^ { \prime } } \ { r _ { \mathbf { y } _ { i } } \left( \mathbf { y } _ { t } \right) &#x3D; \left( \mathbf { y } _ { i } + \mathbf { y } _ { t } \right) - \mathbf { y } _ { i } ^ { \prime } } \end{array}<br>$$<br>将 n 个点形成的 2n 个方程写成矩阵方程：<br>$$<br>\left[ \begin{array} { l l } { 1 } &amp; { 0 } \ { 0 } &amp; { 1 } \ { 1 } &amp; { 0 } \ { 0 } &amp; { 1 } \ { 0 } &amp; { 1 } \ { \vdots } \ { 1 } &amp; { 0 } \ { 0 } &amp; { 1 } \end{array} \right] \left[ \begin{array} { l } { x _ { t } }  \ { y _ { t } } \end{array} \right] &#x3D; \left[ \begin{array} { c } { x _ { 1 } ^ { \prime } - x _ { 1 } } \ { y _ { 1 } ^ { \prime } - y _ { 1 } } \ { x _ { 1 } ^ { \prime } - x _ { 2 } } \ { y _ { 2 } ^ { \prime } - y _ { 2 } } \ { \vdots } \ { x _ { n } ^ { \prime } - x _ { n } } \ { y _ { n } ^ { \prime } - y _ { n } } \end{array} \right]<br>$$</p><p>$$<br>At &#x3D;b<br>$$</p><p>找到 t ，最大限度的减少<br>$$<br>| \mathbf { A } \mathbf { t } - \mathbf { b } | ^ { 2 }<br>$$</p><p>$$<br>\begin{array} { c } { \mathbf { A } ^ { \mathrm { T } } \mathbf { A } \mathbf { t } &#x3D; \mathbf { A } ^ { \mathrm { T } } \mathbf { b } } \ { \mathbf { t } &#x3D; \left( \mathbf { A } ^ { \mathrm { T } } \mathbf { A } \right) ^ { - 1 } \mathbf { A } ^ { \mathrm { T } } \mathbf { b } } \end{array}<br>$$</p><p>对于仿射变换：<br>$$<br>\left[ \begin{array} { l } { x ^ { \prime } } \ { y ^ { \prime } } \ { 1 } \end{array} \right] &#x3D; \left[ \begin{array} { l l l } { a } &amp; { b } &amp; { c } \ { d } &amp; { e } &amp; { f } \ { 0 } &amp; { 0 } &amp; { 1 } \end{array} \right] \left[ \begin{array} { l } { x } \ { y } \ { 1 } \end{array} \right]<br>$$<br>有六个未知数，每个匹配有两个方程，我们需要三个匹配</p><p>残差：<br>$$<br>\begin{aligned} r _ { x _ { i } } ( a , b , c , d , e , f ) &amp; &#x3D; \left( a x _ { i } + b y _ { i } + c \right) - x _ { i } ^ { \prime } \ r _ { y _ { i } } ( a , b , c , d , e , f ) &amp; &#x3D; \left( d x _ { i } + e y _ { i } + f \right) - y _ { i } ^ { \prime } \end{aligned}<br>$$<br>对于同态映射（透视变换）<br>$$<br>\left[ \begin{array} { c } { x _ { i } ^ { \prime } } \ { y _ { i } ^ { \prime } } \ { 1 } \end{array} \right] \cong \left[ \begin{array} { l l l } { h _ { 00 } } &amp; { h _ { 01 } } &amp; { h _ { 02 } } \ { h _ { 10 } } &amp; { h _ { 11 } } &amp; { h _ { 12 } } \ { h _ { 20 } } &amp; { h _ { 21 } } &amp; { h _ { 22 } } \end{array} \right] \left[ \begin{array} { c } { x _ { i } } \ { y _ { i } } \ { 1 } \end{array} \right]<br>$$</p><p>$$<br>\begin{aligned} x _ { i } ^ { \prime } \left( h _ { 20 } x _ { i } + h _ { 21 } y _ { i } + h _ { 22 } \right) &amp; &#x3D; h _ { 00 } x _ { i } + h _ { 01 } y _ { i } + h _ { 02 } \ y _ { i } ^ { \prime } \left( h _ { 20 } x _ { i } + h _ { 21 } y _ { i } + h _ { 22 } \right) &amp; &#x3D; h _ { 10 } x _ { i } + h _ { 11 } y _ { i } + h _ { 12 } \end{aligned}<br>$$</p><p><img src="http://media.sumblog.cn/blog/20190105/LyDbpPwVzvUz.png?imageslim" alt="mark"></p><p>Ah &#x3D; 0 的非平凡最小二乘解，即为 $A^TA$ 具有最小特征值的特征向量</p><h3 id="RANSAC-随机抽样一致"><a href="#RANSAC-随机抽样一致" class="headerlink" title="RANSAC 随机抽样一致"></a>RANSAC 随机抽样一致</h3><p>如何计算</p><ul><li>随机抽取</li><li>计算匹配误差</li></ul><h4 id="Ransac-算法"><a href="#Ransac-算法" class="headerlink" title="Ransac 算法"></a>Ransac 算法</h4><ol><li>随机选择 S 个样本<ul><li>通常 s 等于可以求解模型的最少样本数量</li></ul></li><li>使用这 s 个样本求得一个解</li><li>计数符合模型的 inliers 数</li><li>重复 N 次</li><li>选择具有最多 inliers 数的模型</li><li>使用所有的 inliers 点，采用最小平方拟合</li></ol><h4 id="实验轮数的确定"><a href="#实验轮数的确定" class="headerlink" title="实验轮数的确定"></a>实验轮数的确定</h4><ul><li>$p$ 数内点的概率</li><li>$s$ 是每次实验使用样本点的数目</li><li>$P$ 为实验最终成功找到正确解的概率</li><li>$R$ 为实验轮数</li></ul><p>$$<br>\begin{array} { l } </p>]]></content>
    
    
    <summary type="html">这学期报了计算机视觉这门课，和大一停留在理论上的导论课比起来总算是多了一些实质性的内容和算法。几个lab设计也不错，对理解其本质有所帮助，就是这个讲课和PPT有点(*/ω＼*)</summary>
    
    
    
    
    <category term="Python" scheme="https://mxts.jiujiuer.xyz/tags/Python/"/>
    
    <category term="计算机视觉" scheme="https://mxts.jiujiuer.xyz/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/"/>
    
  </entry>
  
  <entry>
    <title>如何搭建一个本地镜像源</title>
    <link href="https://mxts.jiujiuer.xyz/2023/10/16/setup-local-linux-mirror/"/>
    <id>https://mxts.jiujiuer.xyz/2023/10/16/setup-local-linux-mirror/</id>
    <published>2023-10-16T15:23:51.000Z</published>
    <updated>2024-06-04T16:42:26.930Z</updated>
    
    <content type="html"><![CDATA[<p>最近好哥们沉迷pocketchip，但是苦于架构比较古老（ARM-V7a但是能跑Linux Mainline），所以镜像站特别稀少，只有个国外的站点还开着。所以嘛，闲着也是闲着，就打算自己搭建一个镜像站咯。</p><p>顺便还能好好玩玩那个ESXi服务器。毕竟现在就只跑了一个OpenWRT和一个Ubuntu Server，实在没利用起来（</p><p>或许回头整个本地镜像源还能试试刷新一下Arch安装速度记录（逃</p><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>首先需要足够的硬盘空间和一个Linux计算机，以及差不多的网络环境。</p><p>然后是一些<del>神秘妙妙</del>工具：<code>apache2, debmirror, gnupg, xz-utils, rsync(recommend)</code></p><h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><p>首先，因为同步的数据量会比较大，所以建议使用一块单独的硬盘或者看具体情况分个区都行。硬盘处理好后，可以将它挂载到<code>/mount/</code>下，随后创建我们的镜像站仓库目录们。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /mirror/debmirror/&#123;amd64,keyring&#125;</span><br><span class="line"><span class="built_in">mkdir</span> -p /mirror/scripts        <span class="comment"># 各种镜像站工具脚本</span></span><br></pre></td></tr></table></figure><p>随后安装GPG keyrnig：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --no-default-keyring --keyring /mirror/debmirror/mirrorkeyring/trustedkeys.gpg --import /usr/share/keyrings/ubuntu-archive-keyring.gpg</span><br></pre></td></tr></table></figure><p>安装完成后，在Web服务器站点根目录创建符号链接：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/www/html</span><br><span class="line"><span class="built_in">ln</span> -s /mirror/debmirror/amd64 ubuntu</span><br></pre></td></tr></table></figure><p>在这之后，我们还需要配置debmirror才能实现自动同步upstream等功能。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /mirror/scripts</span><br><span class="line">wget https://louwrentius.com/files/debmirroramd64.sh.txt -O debmirroramd64.sh </span><br><span class="line"><span class="built_in">chmod</span> +x debmirroramd64.sh</span><br></pre></td></tr></table></figure><p>接着修改脚本设置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> GNUPGHOME=/mirror/debmirror/mirrorkeyring</span><br><span class="line">release=focal,focal-security,focal-updates,focal-backports,jammy,jammy-security,jammy-updates,jammy-backports</span><br><span class="line">server=nl.archive.ubuntu.com</span><br><span class="line">proto=rsync</span><br><span class="line">outPath=/mirror/debmirror/amd64</span><br><span class="line"><span class="comment">#bwlimit=1000               # 设置rsync的带宽限速为1000KB/s，如果要启用这个限制，还需要取消注释下面的行：</span></span><br><span class="line">--rsync-options <span class="string">&quot;-aIL --partial --bwlimit=<span class="variable">$bwlimit</span>&quot;</span> \</span><br></pre></td></tr></table></figure><p>完成后，你可以先运行一次脚本来完成第一次同步。<strong>同步完成后</strong>，再在crontab里边加上自动任务（不然你的同步进程时间过长，可能会干扰cron任务）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 1 * * * /mirror/scripts/debmirroramd64.sh</span><br></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><blockquote><p><a href="https://louwrentius.com/how-to-setup-a-local-or-private-ubuntu-mirror.html">Louwrentius - How to Setup a Local or Private Ubuntu Mirror</a><br><a href="https://www.debian.org/mirror/ftpmirror">Debian - Setting up a Debian archive mirror</a></p></blockquote>]]></content>
    
    
    <summary type="html">来玩pocketchip(OWO)</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>CSDN复制解禁</title>
    <link href="https://mxts.jiujiuer.xyz/2023/10/12/csdn-copy/"/>
    <id>https://mxts.jiujiuer.xyz/2023/10/12/csdn-copy/</id>
    <published>2023-10-12T06:18:34.000Z</published>
    <updated>2024-06-04T16:42:26.930Z</updated>
    
    <content type="html"><![CDATA[<p>省流不看：F12开发者工具终端执行<code>document.designMode=&#39;on&#39;</code>。</p><p>原理嘛，就是利用浏览器的DOM启用设计模式来允许选择元素。关于DOM的详细介绍在下边：</p><h2 id="DOM简介"><a href="#DOM简介" class="headerlink" title="DOM简介"></a>DOM简介</h2><p>在浏览器中，<code>document</code>对象是一个非常重要的对象，它代表了当前页面的文档。<code>document.DesignMode</code>属性是<code>document</code>对象的一个属性，它用于指定页面的设计模式。</p><p>设计模式主要有两种：</p><ol><li>模式（常态）：页面在正常模式下运行，用户可以正常查看和操作页面元素。  </li><li>layouter 模式（布局模式）：页面在 layouter 模式下运行，用户无法正常查看和操作页面元素，只能查看页面的布局和结构。</li></ol><p>这两种设计模式主要用于开发者调试和测试网页布局。通常，开发者会在开发过程中将页面切换到 layouter 模式，以便更好地查看和调整页面布局。当开发完成后，页面会自动切换回正常模式。</p><p>在页面加载时，浏览器会自动设置<code>document.DesignMode</code>属性的值。开发者也可以通过 JavaScript 代码来修改这个属性的值，从而实现在不同设计模式之间的切换。</p><p>除了<code>DesignMode</code>属性之外，<code>document</code>对象还有许多其他的属性和方法，它们可以用来完成各种网页开发任务。例如：</p><ol><li><code>document.body</code>：表示页面的主体部分，包含了所有的 HTML 元素。  </li><li><code>document.title</code>：表示页面的标题，通常显示在浏览器的标签页上。  </li><li><code>document.getElementById()</code>：通过元素的 ID 获取指定元素。  </li><li><code>document.getElementsByClassName()</code>：通过元素的类名获取指定元素集合。  </li><li><code>document.getElementsByTagName()</code>：通过元素的标签名获取指定元素集合。  </li><li><code>document.querySelector()</code>：通过 CSS 选择器获取指定元素。  </li><li><code>document.querySelectorAll()</code>：通过 CSS 选择器获取指定元素集合。</li></ol><p>此外，<code>document</code>对象还提供了许多用于操作 DOM 的方法，如<code>createElement()</code>、<code>appendChild()</code>、<code>removeChild()</code>、<code>insertBefore()</code>等，以及用于处理事件的方法，如<code>addEventListener()</code>、<code>removeEventListener()</code>等。</p><p>总之，<code>document</code>对象是浏览器中最重要的对象之一，它为网页开发者提供了丰富的属性和方法，使得开发者可以更加方便地完成各种网页开发任务。</p>]]></content>
    
    
    <summary type="html">(*/ω＼*)</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>联邦学习的投毒和攻防方法</title>
    <link href="https://mxts.jiujiuer.xyz/2023/10/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%8A%95%E6%AF%92%E5%92%8C%E6%94%BB%E9%98%B2%E6%96%B9%E6%B3%95/"/>
    <id>https://mxts.jiujiuer.xyz/2023/10/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%8A%95%E6%AF%92%E5%92%8C%E6%94%BB%E9%98%B2%E6%96%B9%E6%B3%95/</id>
    <published>2023-10-11T10:59:46.000Z</published>
    <updated>2024-06-04T16:42:26.942Z</updated>
    
    <content type="html"><![CDATA[<p>十分的交叉学科。具体而言就是机器学习领域的数据安全问题。</p><p>首先是标题 说的大概是一种新的人工智能学习范式。在这种防方式里也有攻击方式和相应的防御方式。</p><h2 id="联邦学习简介"><a href="#联邦学习简介" class="headerlink" title="联邦学习简介"></a>联邦学习简介</h2><ul><li>definition 联邦学习：一种分布式学习方法。解决的问题主要针对数据量不够&#x2F;数据获取途径（成本问题），数据难以集中(法律问题和隐私问题)。一种时间方法是在本地进行小规模训练，然后将训练得到的模型参数上传汇总。不但规避了隐私版权问题，也保证了训练效果。</li></ul><p>根据以样本和特征分别作为基准，联邦学习又分为横向&#x2F;纵向：同特征不同样本&#x2F;同样本不同特征。它们各自有着相当不同的模型参数聚合方法。后者通常发生在大型企业之间，而前者通常发生在用户&#x2F;公司之间，双方并非信任关系。</p><p>前者的聚合方法有简单的加权平均FedAvg，有离群点修复FedProx，还有SCAFFOLD等。而后者则利用隐私求交集PSI来完成加密实体对齐。典型的纵向联邦学习框架有SecureBoost。</p><p>但是数据特征仍然是反映在梯度参数中的，通过深度梯度泄漏方法DLG，可以恢复训练数据，这样就间接泄漏了训练数据的隐私。</p><h2 id="隐私数据保护方法"><a href="#隐私数据保护方法" class="headerlink" title="隐私数据保护方法"></a>隐私数据保护方法</h2><p>防止梯度泄露的方法主要是两类：密码学方法和差分隐私（Differential Privacy）.前者有MPC和HE等，通信开销和计算量较大，但是精度较高。后者则有噪声问题的困扰。</p><h2 id="联邦学习的攻击方法"><a href="#联邦学习的攻击方法" class="headerlink" title="联邦学习的攻击方法"></a>联邦学习的攻击方法</h2><p>目的就是使训练模型很难收敛，破坏联邦学习模型的性能和可信度。</p><ul><li>投毒攻击，给本地数据添加错误，来弱化学习效果；或者更改分布式训练的模型参数。攻击者的知识、能力越强则攻击能力越强</li></ul><p>但是太离谱的数据会被数据清洗过滤掉，太小的数据又没啥效果。</p><ul><li><p>目标&#x2F;非目标攻击：针对特定&#x2F;随即目标进行数据编造投毒攻击。</p></li><li><p>数据打乱：比如对于不同群体的用户数据，互换他们attribute的结果，最终使得结果在不同群体上相反。</p></li></ul><h2 id="投毒攻击的检测"><a href="#投毒攻击的检测" class="headerlink" title="投毒攻击的检测"></a>投毒攻击的检测</h2><p>这种检测难度不小：投毒攻击检测和隐私保护间的矛盾、数据非独立分布、攻击隐蔽性。</p><p>比较朴素的思路就是使用数据挖掘的清洗方法，对离群点等进行清洗。比如说有一些聚合方法：Krum, Bulyan, Trimmed mean（修整均值）, Medium（中位数）等，都是一些经典的鲁棒性聚合规则。</p><h2 id="防御方法"><a href="#防御方法" class="headerlink" title="防御方法"></a>防御方法</h2><p>首先是基于统计学的方法。但是它的局限性是只有少部分客户端被控制。</p><p>其次是用验证用数据集进行验证。不过这样纯粹的数据集很难找。</p><p>再者就是用机器学习方法1-AE进行检验。它首先在本地预训练一个自编码器模型，然后正式训练过程中基于自编码器计算各节点模型更新的重构误差。</p><p>2-GAN：可以用GAN尝试恢复出来训练样本来生成本地训练集，从而验证模型参数是否正常。但是缺陷是，无法应对在训练初期就发动攻击的方式。</p><p>区块链1-FLChain：由部分节点进行数据检测再进行上传，从而保证参数的正确性。问题是这部分节点如何选择，以及是否正常。解决方法可以是动态更新这部分成员结点，通过一系列置信度去更新这部分节点。</p><h2 id="研究成果：神经网络模型水印"><a href="#研究成果：神经网络模型水印" class="headerlink" title="研究成果：神经网络模型水印"></a>研究成果：神经网络模型水印</h2><p>初始模型嵌入水印，并对水印进行检测。缺点是上传的模型不能加密。当然也可以允许加密，不过可以聚合模型，用聚合后的模型检验上传者。或者，可以比对上传者的历史行为数据，以此检测上传节点是否异常。</p><p>时间有限，基本就到这里了。</p>]]></content>
    
    
    <summary type="html">(*/ω＼*)</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>Golang代码复用-分页最佳实践</title>
    <link href="https://mxts.jiujiuer.xyz/2023/10/07/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Golang/Golang%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%94%A8-%E5%88%86%E9%A1%B5%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"/>
    <id>https://mxts.jiujiuer.xyz/2023/10/07/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Golang/Golang%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%94%A8-%E5%88%86%E9%A1%B5%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/</id>
    <published>2023-10-07T13:59:46.000Z</published>
    <updated>2024-06-04T16:42:26.938Z</updated>
    
    <content type="html"><![CDATA[<p>分页是查询的一个基本要求之一。这部分代码大多重复，适合复用。下面是一种最佳实践：</p><p>这是一个传有分页数据的Gin Handler，它需要对数据库进行分页查询：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p propertyRepository)</span></span> GetPagedAndFiltered (limit, page <span class="type">int</span>)&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>随后我们定义一个<code>gorm</code>中间件去对数据库进行分页：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;gorm.io/gorm&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">type</span> paginate <span class="keyword">struct</span> &#123;  </span><br><span class="line">limit <span class="type">int</span>  </span><br><span class="line">page <span class="type">int</span>  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newPaginate</span><span class="params">(limit <span class="type">int</span>, page <span class="type">int</span>)</span></span> *paginate &#123;  </span><br><span class="line"><span class="keyword">return</span> &amp;paginate&#123;limit: limit,page: page&#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *paginate)</span></span> paginatedResult(db *gorm.DB) *gorm.DB &#123;  </span><br><span class="line">offset := (p.page - <span class="number">1</span>) * p.limit  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">return</span> db.Offset(offset).  </span><br><span class="line">Limit(p.limit)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>随后，就可以在数据库中使用分页了：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p propertyRepository)</span></span> GetPagedAndFiltered(limit, page <span class="type">int</span>) ([]Property, <span class="type">error</span>) &#123;  </span><br><span class="line"><span class="keyword">var</span> properties []Property  </span><br><span class="line">  </span><br><span class="line">err := p.db.Scopes(newPaginate(limit,page).paginatedResult).Find(&amp;properties).Error  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">return</span> properties, err  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当然，我对上面的代码进行了进一步的集成。虽然损失了低耦合性质，但是只是在Gin使用的话体验拉满：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Pagination <span class="keyword">struct</span> &#123;</span><br><span class="line">PageSize <span class="type">int</span></span><br><span class="line">PageNum  <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GetPagination Get pagination info</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetPagination</span><span class="params">(c *gin.Context)</span></span> Pagination &#123;</span><br><span class="line"><span class="keyword">var</span> data Pagination</span><br><span class="line">pageSize, _ := strconv.Atoi(c.Query(<span class="string">&quot;pagesize&quot;</span>))</span><br><span class="line">pageNum, _ := strconv.Atoi(c.Query(<span class="string">&quot;pagenum&quot;</span>))</span><br><span class="line"><span class="keyword">switch</span> &#123;</span><br><span class="line"><span class="keyword">case</span> pageSize &gt;= <span class="number">100</span>:</span><br><span class="line">data.PageSize = <span class="number">100</span></span><br><span class="line"><span class="keyword">case</span> pageSize &lt;= <span class="number">0</span>:</span><br><span class="line">data.PageSize = <span class="number">10</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> pageNum &lt;= <span class="number">0</span> &#123;</span><br><span class="line">data.PageNum = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> data</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Pagination)</span></span> PaginatedResults(db *gorm.DB) *gorm.DB &#123;</span><br><span class="line">offset := (p.PageNum - <span class="number">1</span>) * p.PageSize</span><br><span class="line"><span class="keyword">return</span> db.Offset(offset).Limit(p.PageSize)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用方法就是在Gin Handler中用<code>GetPagination</code>获取分页参数，然后在<code>model</code>的具体数据库实现操作中使用<code>db.Scopes(page.PaginatedResult).xxx</code>直接分页。</p><p>应该是一种最佳实践。</p>]]></content>
    
    
    <summary type="html">简简单单，一行分页。回头甚至能水个库？</summary>
    
    
    
    
    <category term="Golang" scheme="https://mxts.jiujiuer.xyz/tags/Golang/"/>
    
    <category term="开发" scheme="https://mxts.jiujiuer.xyz/tags/%E5%BC%80%E5%8F%91/"/>
    
    <category term="Web" scheme="https://mxts.jiujiuer.xyz/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>Vim备忘录</title>
    <link href="https://mxts.jiujiuer.xyz/2023/09/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Vim%E5%A4%87%E5%BF%98%E5%BD%95/"/>
    <id>https://mxts.jiujiuer.xyz/2023/09/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Vim%E5%A4%87%E5%BF%98%E5%BD%95/</id>
    <published>2023-09-29T21:30:53.000Z</published>
    <updated>2024-06-04T16:42:26.934Z</updated>
    
    <content type="html"><![CDATA[<h2 id="How-to-Exit"><a href="#How-to-Exit" class="headerlink" title="How to Exit"></a>How to Exit</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>:q[uit]</td><td>Quit Vim. This fails when changes have been made.</td></tr><tr><td>:q[uit]!</td><td>Quit without writing.</td></tr><tr><td>:cq[uit]</td><td>Quit always, without writing.</td></tr><tr><td>:wq</td><td>Write the current file and exit.</td></tr><tr><td>:wq!</td><td>Write the current file and exit always.</td></tr><tr><td>:wq {file}</td><td>Write to {file}. Exit if not editing the last</td></tr><tr><td>:wq! {file}</td><td>Write to {file} and exit always.</td></tr><tr><td>:[range]wq[!]</td><td>[file] Same as above, but only write the lines in [range].</td></tr><tr><td>ZZ</td><td>Write current file, if modified, and exit.</td></tr><tr><td>ZQ</td><td>Quit current file and exit (same as “:q!”).</td></tr></tbody></table><h2 id="Editing-a-File"><a href="#Editing-a-File" class="headerlink" title="Editing a File"></a>Editing a File</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>:e[dit]</td><td>Edit the current file. This is useful to re-edit the current file, when it has been changed outside of Vim.</td></tr><tr><td>:e[dit]!</td><td>Edit the current file always. Discard any changes to the current buffer. This is useful if you want to start all over again.</td></tr><tr><td>:e[dit] {file}</td><td>Edit {file}.</td></tr><tr><td>:e[dit]! {file}</td><td>Edit {file} always. Discard any changes to the current buffer.</td></tr><tr><td>gf</td><td>Edit the file whose name is under or after the cursor. Mnemonic: “goto file”.</td></tr></tbody></table><h2 id="Inserting-Text"><a href="#Inserting-Text" class="headerlink" title="Inserting Text"></a>Inserting Text</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>a</td><td>Append text after the cursor [count] times.</td></tr><tr><td>A</td><td>Append text at the end of the line [count] times.</td></tr><tr><td>i</td><td>Insert text before the cursor [count] times.</td></tr><tr><td>I</td><td>Insert text before the first non-blank in the line [count] times.</td></tr><tr><td>gI</td><td>Insert text in column 1 [count] times.</td></tr><tr><td>o</td><td>Begin a new line below the cursor and insert text, repeat [count] times.</td></tr><tr><td>O</td><td>Begin a new line above the cursor and insert text, repeat [count] times.</td></tr></tbody></table><h2 id="Inserting-a-file"><a href="#Inserting-a-file" class="headerlink" title="Inserting a file"></a>Inserting a file</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>:r[ead] [name]</td><td>Insert the file [name] below the cursor.</td></tr><tr><td>:r[ead] !{cmd}</td><td>Execute {cmd} and insert its standard output below the cursor.</td></tr></tbody></table><h2 id="Deleting-Text"><a href="#Deleting-Text" class="headerlink" title="Deleting Text"></a>Deleting Text</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>&lt;Del&gt; or x</td><td>Delete [count] characters under and after the cursor</td></tr><tr><td>X</td><td>Delete [count] characters before the cursor</td></tr><tr><td>d{motion}</td><td>Delete text that {motion} moves over</td></tr><tr><td>dd</td><td>Delete [count] lines</td></tr><tr><td>D</td><td>Delete the characters under the cursor until the end of the line</td></tr><tr><td>{Visual}x or  <br>{Visual}d</td><td>Delete the highlighted text (for {Visual} see <a href="http://fprintf.net/vimCheatSheet.html#select">Selecting Text</a>).</td></tr><tr><td>{Visual}CTRL-H or  <br>{Visual}</td><td>When in Select mode: Delete the highlighted text</td></tr><tr><td>{Visual}X or  <br>{Visual}D</td><td>Delete the highlighted lines</td></tr><tr><td>:[range]d[elete]</td><td>Delete [range] lines (default: current line)</td></tr><tr><td>:[range]d[elete] {count}</td><td>Delete {count} lines, starting with [range]</td></tr></tbody></table><hr><h2 id="Changing-or-Replacing-Text"><a href="#Changing-or-Replacing-Text" class="headerlink" title="Changing (or Replacing) Text"></a>Changing (or Replacing) Text</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>r{char}</td><td>replace the character under the cursor with {char}.</td></tr><tr><td>R</td><td>Enter Insert mode, replacing characters rather than inserting</td></tr><tr><td>~</td><td>Switch case of the character under the cursor and move the cursor to the right. If a [count] is given, do that many characters.</td></tr><tr><td>~{motion}</td><td>switch case of {motion} text.</td></tr><tr><td>{Visual}~</td><td>Switch case of highlighted text</td></tr></tbody></table><hr><h2 id="Substituting"><a href="#Substituting" class="headerlink" title="Substituting"></a>Substituting</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>:[range]s[ubstitute]&#x2F;{pattern}&#x2F;{string}&#x2F;[c][e][g][p][r][i][I] [count]</td><td>For each line in [range] replace a match of {pattern} with {string}.</td></tr><tr><td>:[range]s[ubstitute] [c][e][g][r][i][I] [count] :[range]&amp;[c][e][g][r][i][I] [count]</td><td>Repeat last :substitute with same search pattern and substitute string, but without the same flags. You may add extra flags</td></tr></tbody></table><p>The arguments that you can use for the substitute commands:<br>[c]  Confirm each substitution.  Vim positions the cursor on the matching<br>  string.  You can type:<br>      ‘y’      to substitute this match<br>      ‘n’      to skip this match<br>         to skip this match<br>      ‘a’      to substitute this and all remaining matches {not in Vi}<br>      ‘q’      to quit substituting {not in Vi}<br>      CTRL-E  to scroll the screen up {not in Vi}<br>      CTRL-Y  to scroll the screen down {not in Vi}.<br>[e]     When the search pattern fails, do not issue an error message and, in<br>  particular, continue in maps as if no error occurred.<br>[g]  Replace all occurrences in the line.  Without this argument,<br>  replacement occurs only for the first occurrence in each line.<br>[i]  Ignore case for the pattern.<br>[I]  Don’t ignore case for the pattern.<br>[p]  Print the line containing the last substitute.</p><hr><h2 id="Copying-and-Moving-Text"><a href="#Copying-and-Moving-Text" class="headerlink" title="Copying and Moving Text"></a>Copying and Moving Text</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>“{a-zA-Z0-9.%#:-“}</td><td>Use register {a-zA-Z0-9.%#:-“} for next delete, yank or put (use uppercase character to append with delete and yank) ({.%#:} only work with put).</td></tr><tr><td>:reg[isters]</td><td>Display the contents of all numbered and named registers.</td></tr><tr><td>:reg[isters] {arg}</td><td>Display the contents of the numbered and named registers that are mentioned in {arg}.</td></tr><tr><td>:di[splay] [arg]</td><td>Same as :registers.</td></tr><tr><td>[“x]y{motion}</td><td>Yank {motion} text [into register x].</td></tr><tr><td>[“x]yy</td><td>Yank [count] lines [into register x]</td></tr><tr><td>[“x]Y</td><td>yank [count] lines [into register x] (synonym for yy).</td></tr><tr><td>{Visual}[“x]y</td><td>Yank the highlighted text [into register x] (for {Visual} see <a href="http://fprintf.net/vimCheatSheet.html#select">Selecting Text</a>).</td></tr><tr><td>{Visual}[“x]Y</td><td>Yank the highlighted lines [into register x]</td></tr><tr><td>:[range]y[ank] [x]</td><td>Yank [range] lines [into register x].</td></tr><tr><td>:[range]y[ank] [x] {count}</td><td>Yank {count} lines, starting with last line number in [range] (default: current line), [into register x].</td></tr><tr><td>[“x]p</td><td>Put the text [from register x] after the cursor [count] times.</td></tr><tr><td>[“x]P</td><td>Put the text [from register x] before the cursor [count] times.</td></tr><tr><td>[“x]gp</td><td>Just like “p”, but leave the cursor just after the new text.</td></tr><tr><td>[“x]gP</td><td>Just like “P”, but leave the cursor just after the new text.</td></tr><tr><td>:[line]pu[t] [x]</td><td>Put the text [from register x] after [line] (default current line).</td></tr><tr><td>:[line]pu[t]! [x]</td><td>Put the text [from register x] before [line] (default current line).</td></tr></tbody></table><hr><h2 id="Undo-x2F-Redo-x2F-Repeat"><a href="#Undo-x2F-Redo-x2F-Repeat" class="headerlink" title="Undo&#x2F;Redo&#x2F;Repeat"></a>Undo&#x2F;Redo&#x2F;Repeat</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>u</td><td>Undo [count] changes.</td></tr><tr><td>:u[ndo]</td><td>Undo one change.</td></tr><tr><td>CTRL-R</td><td>Redo [count] changes which were undone.</td></tr><tr><td>:red[o]</td><td>Redo one change which was undone.</td></tr><tr><td>U</td><td>Undo all latest changes on one line. {Vi: while not moved off of it}</td></tr><tr><td>.</td><td>Repeat last change, with count replaced with [count].</td></tr></tbody></table><hr><h2 id="Moving-Around"><a href="#Moving-Around" class="headerlink" title="Moving Around"></a>Moving Around</h2><p>Basic motion commands:</p><pre><code>    k                h   l              j             </code></pre><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>h or</td><td>[count] characters to the left (exclusive).</td></tr><tr><td>l or  <br>or</td><td>[count] characters to the right (exclusive).</td></tr><tr><td>k or  <br>or  <br>CTRL-P</td><td>[count] lines upward</td></tr><tr><td>j or  <br>or  <br>CTRL-J or  <br>or  <br>CTRL-N</td><td>[count] lines downward (linewise).</td></tr><tr><td>0</td><td>To the first character of the line (exclusive).</td></tr><tr><td><Home></td><td>To the first character of the line (exclusive).</td></tr><tr><td>^</td><td>To the first non-blank character of the line</td></tr><tr><td>$ or  <br><End></td><td>To the end of the line and [count - 1] lines downward</td></tr><tr><td>g0 or  <br>g<Home></td><td>When lines wrap (‘wrap on): To the first character of the screen line (exclusive). Differs from “0” when a line is wider than the screen. When lines don’t wrap (‘wrap’ off): To the leftmost character of the current line that is on the screen. Differs from “0” when the first character of the line is not on the screen.</td></tr><tr><td>g^</td><td>When lines wrap (‘wrap’ on): To the first non-blank character of the screen line (exclusive). Differs from “^” when a line is wider than the screen. When lines don’t wrap (‘wrap’ off): To the leftmost non-blank character of the current line that is on the screen. Differs from “^” when the first non-blank character of the line is not on the screen.</td></tr><tr><td>g$ or  <br>g&lt;End&amp;gr;</td><td>When lines wrap (‘wrap’ on): To the last character of the screen line and [count - 1] screen lines downward (inclusive). Differs from “$” when a line is wider than the screen. When lines don’t wrap (‘wrap’ off): To the rightmost character of the current line that is visible on the screen. Differs from “$” when the last character of the line is not on the screen or when a count is used.</td></tr><tr><td>f{char}</td><td>To [count]’th occurrence of {char} to the right. The cursor is placed on {char} (inclusive).</td></tr><tr><td>F{char}</td><td>To the [count]’th occurrence of {char} to the left. The cursor is placed on {char} (inclusive).</td></tr><tr><td>t{char}</td><td>Till before [count]’th occurrence of {char} to the right. The cursor is placed on the character left of {char} (inclusive).</td></tr><tr><td>T{char}</td><td>Till after [count]’th occurrence of {char} to the left. The cursor is placed on the character right of {char} (inclusive).</td></tr><tr><td>;</td><td>Repeat latest f, t, F or T [count] times.</td></tr><tr><td>,</td><td>Repeat latest f, t, F or T in opposite direction [count] times.</td></tr><tr><td>- <minus></td><td>[count] lines upward, on the first non-blank character (linewise).</td></tr><tr><td>+ or  <br>CTRL-M or  <br><CR></td><td>[count] lines downward, on the first non-blank character (linewise).</td></tr><tr><td>_ <underscore></td><td>[count] - 1 lines downward, on the first non-blank character (linewise).</td></tr><tr><td><C-End> or  <br>G</td><td>Goto line [count], default last line, on the first non-blank character.</td></tr><tr><td><C-Home> or  <br>gg</td><td>Goto line [count], default first line, on the first non-blank character.</td></tr><tr><td><S-Right> or  <br>w</td><td>[count] words forward</td></tr><tr><td><C-Right> or  <br>W</td><td>[count] WORDS forward</td></tr><tr><td>e</td><td>Forward to the end of word [count]</td></tr><tr><td>E</td><td>Forward to the end of WORD [count]</td></tr><tr><td><S-Left> or  <br>b</td><td>[count] words backward</td></tr><tr><td><C-Left> or  <br>B</td><td>[count] WORDS backward</td></tr><tr><td>ge</td><td>Backward to the end of word [count]</td></tr><tr><td>gE</td><td>Backward to the end of WORD [count]</td></tr></tbody></table><p>These commands move over words or WORDS.</p><p>A word consists of a sequence of letters, digits and underscores, or a sequence of other non-blank characters, separated with white space (spaces, tabs, ). This can be changed with the ‘iskeyword’ option.</p><p>A WORD consists of a sequence of non-blank characters, separated with white space. An empty line is also considered to be a word and a WORD.</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>(</td><td>[count] sentences backward</td></tr><tr><td>)</td><td>[count] sentences forward</td></tr><tr><td>{</td><td>[count] paragraphs backward</td></tr><tr><td>}</td><td>[count] paragraphs forward</td></tr><tr><td>]]</td><td>[count] sections forward or to the next ‘{‘ in the first column. When used after an operator, then the ‘}’ in the first column.</td></tr><tr><td>][</td><td>[count] sections forward or to the next ‘}’ in the first column</td></tr><tr><td>[[</td><td>[count] sections backward or to the previous ‘{‘ in the first column</td></tr><tr><td>[]</td><td>[count] sections backward or to the previous ‘}’ in the first column</td></tr></tbody></table><p>Screen movement commands</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>z.</td><td>Center the screen on the cursor</td></tr><tr><td>zt</td><td>Scroll the screen so the cursor is at the top</td></tr><tr><td>zb</td><td>Scroll the screen so the cursor is at the bottom</td></tr></tbody></table><hr><h2 id="Marks"><a href="#Marks" class="headerlink" title="Marks"></a>Marks</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>m{a-zA-Z}</td><td>Set mark {a-zA-Z} at cursor position (does not move the cursor, this is not a motion command).</td></tr><tr><td>m’ or  <br>m&#96;</td><td>Set the previous context mark. This can be jumped to with the “‘’” or “&#96;&#96;” command (does not move the cursor, this is not a motion command).</td></tr><tr><td>:[range]ma[rk] {a-zA-Z}</td><td>Set mark {a-zA-Z} at last line number in [range], column 0. Default is cursor line.</td></tr><tr><td>:[range]k{a-zA-Z}</td><td>Same as :mark, but the space before the mark name can be omitted.</td></tr><tr><td>‘{a-z}</td><td>To the first non-blank character on the line with mark {a-z} (linewise).</td></tr><tr><td>‘{A-Z0-9}</td><td>To the first non-blank character on the line with mark {A-Z0-9} in the correct file</td></tr><tr><td>&#96;{a-z}</td><td>To the mark {a-z}</td></tr><tr><td>&#96;{A-Z0-9}</td><td>To the mark {A-Z0-9} in the correct file</td></tr><tr><td>:marks</td><td>List all the current marks (not a motion command).</td></tr><tr><td>:marks {arg}</td><td>List the marks that are mentioned in {arg} (not a motion command). For example:</td></tr></tbody></table><hr><h2 id="Searching"><a href="#Searching" class="headerlink" title="Searching"></a>Searching</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>&#x2F;{pattern}[&#x2F;]</td><td>Search forward for the [count]’th occurrence of {pattern}</td></tr><tr><td>&#x2F;{pattern}&#x2F;{offset}</td><td>Search forward for the [count]’th occurrence of {pattern} and go {offset} lines up or down.</td></tr><tr><td>&#x2F;<CR></td><td>Search forward for the [count]’th latest used pattern</td></tr><tr><td>&#x2F;&#x2F;{offset}<CR></td><td>Search forward for the [count]’th latest used pattern with new. If {offset} is empty no offset is used.</td></tr><tr><td>?{pattern}[?]<CR></td><td>Search backward for the [count]’th previous occurrence of {pattern}</td></tr><tr><td>?{pattern}?{offset}<CR></td><td>Search backward for the [count]’th previous occurrence of {pattern} and go {offset} lines up or down</td></tr><tr><td>?<CR></td><td>Search backward for the [count]’th latest used pattern</td></tr><tr><td>??{offset}<CR></td><td>Search backward for the [count]’th latest used pattern with new {offset}. If {offset} is empty no offset is used.</td></tr><tr><td>n</td><td>Repeat the latest “&#x2F;“ or “?” [count] times.</td></tr><tr><td>N</td><td>Repeat the latest “&#x2F;“ or “?” [count] times in opposite direction.</td></tr></tbody></table><hr><h2 id="Selecting-Text-Visual-Mode"><a href="#Selecting-Text-Visual-Mode" class="headerlink" title="Selecting Text (Visual Mode)"></a>Selecting Text (Visual Mode)</h2><p>To select text, enter visual mode with one of the commands below, and use <a href="http://fprintf.net/vimCheatSheet.html#motion">motion commands</a> to highlight the text you are interested in. Then, use some command on the text.</p><p>The operators that can be used are:<br>  ~  switch case<br>  d  delete<br>  c  change<br>  y  yank</p><blockquote><p> shift right<br>  &lt;  shift left<br>  !  filter through external command<br>  &#x3D;  filter through ‘equalprg’ option command<br>  gq  format lines to ‘textwidth’ length </p></blockquote><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>v</td><td>start Visual mode per character.</td></tr><tr><td>V</td><td>start Visual mode linewise.</td></tr><tr><td><Esc></td><td>exit Visual mode without making any changes</td></tr></tbody></table><hr><h2 id="How-to-Suspend"><a href="#How-to-Suspend" class="headerlink" title="How to Suspend"></a>How to Suspend</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>CTRL-Z</td><td>Suspend Vim, like “:stop”. Works in Normal and in Visual mode. In Insert and Command-line mode, the CTRL-Z is inserted as a normal character.</td></tr><tr><td>:sus[pend][!] or  <br>:st[op][!]</td><td>Suspend Vim. If the ‘!’ is not given and ‘autowrite’ is set, every buffer with changes and a file name is written out. If the ‘!’ is given or ‘autowrite’ is not set, changed buffers are not written, don’t forget to bring Vim back to the foreground later!</td></tr></tbody></table><hr><p><a href="http://www.catb.org/hacker-emblem/"><img src="http://www.catb.org/hacker-emblem/glider.png"></a></p><p>Daniel Gryniewicz &#x2F; <a href="mailto:dang@fprintf.net">dang@fprintf.net</a></p>]]></content>
    
    
    <summary type="html">Cheat sheet，翻译过来也就是“打小抄”。入门时用来记命令倒是挺方便的</summary>
    
    
    
    
    <category term="工具" scheme="https://mxts.jiujiuer.xyz/tags/%E5%B7%A5%E5%85%B7/"/>
    
    <category term="文本编辑器" scheme="https://mxts.jiujiuer.xyz/tags/%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>基于Bash的目录级环境配置工具</title>
    <link href="https://mxts.jiujiuer.xyz/2023/09/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/%E5%9F%BA%E4%BA%8EBash%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BA%A7%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E5%B7%A5%E5%85%B7/"/>
    <id>https://mxts.jiujiuer.xyz/2023/09/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/%E5%9F%BA%E4%BA%8EBash%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BA%A7%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E5%B7%A5%E5%85%B7/</id>
    <published>2023-09-26T15:46:55.000Z</published>
    <updated>2024-06-04T16:42:26.934Z</updated>
    
    <content type="html"><![CDATA[<p>最近对于Bash愈发迷恋，几乎任何会花费我超过30秒时间的任务，我都会考虑<del>打个脚先</del>写个脚本搞定。再比如说写博客，这种纯输出流就很适合Vim啊，作为一个Vim<del>批</del>必然是原教旨主义最好啊：</p><p><img src="/img/Pasted%20image%2020230926235753.png" alt="算了截图还是用Obsidian粘吧"></p><p>但是除了截图粘贴不方便外，还有一些比较难受的地方。在Obsidian里边我是能直接用插件的各种功能快速编写博客的，虽然在Bash终端环境下编写脚本确实更方便了，但是脚本一多，目录就乱的不能看力：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 强迫症是病，得治</span></span><br><span class="line">.</span><br><span class="line">├── about</span><br><span class="line">├── _archive</span><br><span class="line">├── deploy.sh</span><br><span class="line">├── _draft</span><br><span class="line">├── how-much-did-i-write.sh</span><br><span class="line">├── img</span><br><span class="line">├── img-uri-process.sh</span><br><span class="line">├── _inbox</span><br><span class="line">├── links</span><br><span class="line">├── new-post.sh</span><br><span class="line">├── _posts</span><br><span class="line">└── _scaffolds</span><br><span class="line"></span><br><span class="line">9 directories, 4 files</span><br></pre></td></tr></table></figure><p>三个脚本，一个是统计字数的，一个是用<code>sed</code>处理图片链接的，还有一个是从模板新建博客的。每次打开目录看到这仨在中间总觉得很别扭。</p><p>除了这，还有就是用起来也不方便：前面要是不加<code>./</code>就能直接用就好了<del>懒也是病得治</del></p><p>所以，需求大概就是这样：目录级别的环境变量配置，并且支持还得够完善，不能离开目录了配置还在生效，不然脚本在其他目录跑飞了想想就恐怖。</p><h2 id="Basic-Implementation"><a href="#Basic-Implementation" class="headerlink" title="Basic Implementation"></a>Basic Implementation</h2><p>首先定位清楚，这个对<code>cd</code>的Hook只是在指令完成后，加载或者取消配置局部环境变量。因此大概实现方式和结构都有合适的选择。</p><ul><li>程序扔<code>~/.bashrc</code>里，或者<code>/etc/profile</code>里。不过我一般在GUI用konsole比较多，所以就放<code>.bashrc</code>里了，也方便dotfile管理。</li><li>把具体实现用<code>alias</code>赋别名为<code>cd</code>达到重载（或者说Hook)<code>cd</code>的目的。</li></ul><p>基于上面这两条，这是我写一个粗略实现（没干掉bash基本使用就是能用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">cd_hook</span></span>() &#123;</span><br><span class="line">    <span class="comment"># The normal cd</span></span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$#</span> == 0 ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">cd</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> </span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">    <span class="comment"># If the dir contains bashrc, launch the sub shell and load it</span></span><br><span class="line">    <span class="keyword">if</span> [ -f <span class="string">&quot;.bashrc&quot;</span> ] &amp;&amp; [ <span class="string">&quot;<span class="subst">$(pwd)</span>&quot;</span> != <span class="string">&quot;<span class="subst">$(getent passwd $USER | awk -F &#x27;:&#x27; &#x27;&#123;print $6&#125;&#x27;)</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">pushd</span> .  &gt; /dev/null</span><br><span class="line">        bash --init-file &lt;(<span class="built_in">cat</span> /etc/profile ~/.bashrc .bashrc)</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">alias</span> <span class="built_in">cd</span>=<span class="string">&#x27;cd_hook&#x27;</span></span><br></pre></td></tr></table></figure><p>上面有依托用来检测是否是家目录的指令来避免套娃（虽然理论上充重复加载家目录配置应该没啥）,然后是检测当前目录下（因为是先<code>cd</code>过去的嘛，所以<code>pwd</code>已经变了）是否有<code>.bashrc</code>，有的话就把它作为子参数，和家目录下的bashrc一起传给子bash，然后启动它。</p><p>这样就能实现cd后自动加载目录下的配置了。赶紧试试：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># My blog&#x27;s utiilties and aliases</span></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line">TMPL=$(find ./_scaffolds | grep .md)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">deploy</span></span>() &#123;</span><br><span class="line">    <span class="built_in">cd</span> ..</span><br><span class="line">    (</span><br><span class="line">        <span class="built_in">rm</span> -rf deploy &amp;&amp; <span class="built_in">cp</span> -r blog deploy</span><br><span class="line">        <span class="built_in">cd</span> deploy &amp;&amp; git checkout deploy</span><br><span class="line">        <span class="built_in">cp</span> -r blog deploy/source</span><br><span class="line">        <span class="built_in">cd</span> deploy &amp;&amp; pnpm i &amp;&amp; pnpm run server</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">image_url_proc</span></span>() &#123;</span><br><span class="line">    find . -<span class="built_in">type</span> f -name <span class="string">&quot;*.md&quot;</span> -<span class="built_in">exec</span> sed -i <span class="string">&#x27;s/\!\[\[\(.*\)\/\(.*\)\]\]/\!\[\2\]\(\/img\/\2\)/gi&#x27;</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">new_post</span></span>() &#123;</span><br><span class="line">    sed -e <span class="string">&quot;s/&#123;&#123;title&#125;&#125;/<span class="variable">$1</span>/&quot;</span> -e <span class="string">&quot;s/&#123;&#123;date&#125;&#125; &#123;&#123;time&#125;&#125;/<span class="subst">$(date &#x27;+%Y-%m-%d %H:%M:%S&#x27;)</span>/&quot;</span> <span class="variable">$TMPL</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">line_count</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;You have wrote <span class="subst">$(find _* -name *.md | xargs cat 2&gt;/dev/null | wc -l)</span> lines in total!&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>cd到目录里边试试<code>line_count</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xeonds@ark-station-breeze:~/Documents/blog$ line_count</span><br><span class="line">You have wrote 36570 lines <span class="keyword">in</span> total!</span><br><span class="line">xeonds@ark-station-breeze:~/Documents/blog$ </span><br></pre></td></tr></table></figure><p>好好好，再看看目录结构：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── .bashrc</span><br><span class="line">├── about</span><br><span class="line">├── _archive</span><br><span class="line">├── _draft</span><br><span class="line">├── img</span><br><span class="line">├── _inbox</span><br><span class="line">├── links</span><br><span class="line">├── _posts</span><br><span class="line">└── _scaffolds</span><br><span class="line"></span><br><span class="line"> 9 directories, 1 files</span><br></pre></td></tr></table></figure><p>爽死。</p><p>慢着，里边还有一行<code>pushd</code>呢。嗯，这是后面用来实现自动退出子Shell的关键。具体实现等到下一部分再说吧，先睡了。</p><p>后来感觉这样有点太麻烦了，于是就把脚本简化了一下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">cd</span></span>() &#123;</span><br><span class="line">    <span class="built_in">builtin</span> <span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line">    <span class="keyword">if</span> [[ -f <span class="string">&quot;<span class="variable">$PWD</span>/.bashrc&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">exec</span> bash --rcfile &lt;(<span class="built_in">cat</span> ~/.bashrc <span class="string">&quot;<span class="variable">$PWD</span>/.bashrc&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">exec</span> bash --rcfile &lt;(<span class="built_in">cat</span> ~/.bashrc)</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>逻辑很简单，先直通参数执行完内置<code>cd</code>，然后判断目的目录底下有没有<code>.bashrc</code>，有的话直接<code>exec</code>一个新的bash来加载这个配置文件和<code>~/</code>下的默认配置；如果没有的话，也<code>exec</code>一个新的bash替换当前进程。</p><p>之所以到一个新目录都要开一个新的进程替换当前进程，是为了使得只有在当前目录底下才可以使用当前文件夹的环境变量。不过这也带来了新的问题：那就是执行一些包含<code>cd</code>的脚本时，会因为<code>exec</code>用新的进程覆盖了当前进程的原因，导致脚本执行终止。</p><p>最后想了下，Makefile不也挺好用的（笑）。</p>]]></content>
    
    
    <summary type="html">这不比Windows爽</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>SSH学习笔记</title>
    <link href="https://mxts.jiujiuer.xyz/2023/09/25/ssh-usage/"/>
    <id>https://mxts.jiujiuer.xyz/2023/09/25/ssh-usage/</id>
    <published>2023-09-25T06:16:18.000Z</published>
    <updated>2024-06-04T16:42:26.930Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>文章是我和GPT一块写的，回头再慢慢丰富润色。</p></blockquote><p>OpenSSH是一种强大的远程登录和数据传输工具，也是SSH协议目前最流行的实现。它提供了许多安全功能，如数据加密、身份验证和会话完整性。安全性上，SSH能吊着明文传输的Telnet打。并且SSH的配置也相对容易，目前基本所有主流Linux发行版都默认安装了OpenSSH，Win10&#x2F;11也自带了OpenSSH Cilent。</p><p>追求效率提升，首先需要看看日常重复次数最多的操作，然后试着优化——比如SSH，虽然每次只有1,2秒，但累积起来节省的时间也不少。配置好了基本能实现无感登陆那种程度，让你几乎忘掉这个环节，还是挺爽的。除了效率，提升点安全性也是挺好的：公网服务器改用密钥登陆，又无感又安全——只要密钥别丢。</p><h2 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h2><h3 id="远程登录"><a href="#远程登录" class="headerlink" title="远程登录"></a>远程登录</h3><p>基本格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh [options] [username]@[hostname]  </span><br></pre></td></tr></table></figure><p><code>[username]</code> 是远程主机的用户名，<code>[hostname]</code> 是远程主机的主机名或 IP 地址。</p><p><code>[options]</code> 是可选的参数，例如 <code>-i</code> 指定要使用的私钥文件，<code>-L</code> 指定要使用的本地端口转发，<code>-R</code> 指定要使用的远程端口转发等。</p><p>一般用的最多的是默认端口密码登陆：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh username@hostname &lt;-p 22&gt;</span><br></pre></td></tr></table></figure><p>后面的<code>-p 22</code>是缺省参数，可以不加。</p><p>不过密码登陆安全性并不太高，建议重要场合上密钥登陆。例如，用密钥文件 <code>id_rsa</code> 以用户 <code>username</code> 登录远程主机 <code>example.com</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -i id-rsa username@example.com</span><br></pre></td></tr></table></figure><p>密钥和公钥就像锁和钥匙一一对应，你可以用同一对公钥密钥登陆多个主机，不过显然不太安全。建议一对公密钥只用于一个服务器的登陆。</p><p>它们的创建很简单，使用 <code>OpenSSH</code> 自带的 <code>ssh-keygen</code> 命令即可：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">xeonds@ark-station:~$ ssh-keygen </span><br><span class="line">Generating public/private ed25519 key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/home/xeonds/.ssh/id_ed25519): example-key     <span class="comment"># 指定公钥私钥保存在哪</span></span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase):                                         <span class="comment"># 指定私钥使用密码</span></span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved <span class="keyword">in</span> example-key</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> example-key.pub</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:tFoZLdZFg3HDMqGG6rC5jq+zysxClfBCUvffMYgS5GY xeonds@ark-station</span><br><span class="line">The key<span class="string">&#x27;s randomart image is:</span></span><br><span class="line"><span class="string">+--[ED25519 256]--+</span></span><br><span class="line"><span class="string">| ...+     o**    |</span></span><br><span class="line"><span class="string">|.o o o o =+o.o   |</span></span><br><span class="line"><span class="string">|o o E + O =o     |</span></span><br><span class="line"><span class="string">| . * o = * o     |</span></span><br><span class="line"><span class="string">|  + .   S .      |</span></span><br><span class="line"><span class="string">| . =   o         |</span></span><br><span class="line"><span class="string">|. o . .          |</span></span><br><span class="line"><span class="string">|*. .             |</span></span><br><span class="line"><span class="string">|BX+              |</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br><span class="line"><span class="string">xeonds@ark-station:~$ ls | grep example</span></span><br><span class="line"><span class="string">example-key</span></span><br><span class="line"><span class="string">example-key.pub</span></span><br></pre></td></tr></table></figure><p>上面带<code>.pub</code>后缀的就是公钥，私钥是不带后缀的那个。创建完成之后，可以用 <code>ssh-copy-id</code> 把公钥传给你要登陆的服务器，把私钥妥善保管好：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id -i example-key.pub username@example.com</span><br></pre></td></tr></table></figure><p>还可以用<code>-p xxxx</code>指定端口。传完之后就能用前面的指令登陆服务器了。但是这样也挺麻烦的对吧。你别急，还有办法：把下面的内容保存到你的<code>~/.ssh/config</code>文件中：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Host my-server</span><br><span class="line">    HostName example.com</span><br><span class="line">    User username</span><br><span class="line">    Port 22                             # 端口默认22的话可以不写</span><br><span class="line">    IdentityFile ~/.ssh/example-key     # 指向你的密钥路径</span><br><span class="line">    PreferredAuthentications publickey  # 指定优先使用公钥</span><br></pre></td></tr></table></figure><p>现在就可以直接用下面的指令登陆了：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh my-server</span><br></pre></td></tr></table></figure><p>直接登陆，几乎无感。当然要是你给私钥设置密码了就得在登陆的时候再输入一遍密码。</p><blockquote><p>不过跟现代计算机系统比起来，还是人参与的环节更加脆弱，最终还是得小心社工手段。</p></blockquote><h3 id="断开连接"><a href="#断开连接" class="headerlink" title="断开连接"></a>断开连接</h3><p>因为忘了断开另一个开发机的ssh连接导致我有几个端口一直被占用着，所以得想办法断开另一台机器的连接：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">w <span class="comment"># 查看所有连接</span></span><br><span class="line">pkill -<span class="built_in">kill</span> -t pts/x <span class="comment"># 断开编号为x的连接</span></span><br><span class="line">pkill -9 -t pts/x <span class="comment"># 和上边一样，不过是强制断联</span></span><br></pre></td></tr></table></figure><p>不过不知道为啥好像远程shell的服务还活着，只能手动杀掉了。下次建议用tmux，省事省心。</p><h3 id="传输文件"><a href="#传输文件" class="headerlink" title="传输文件"></a>传输文件</h3><p>OpenSSH 还提供了一种安全传输文件的方法，称为 SFTP（SSH 文件传输协议）。要使用 SFTP 传输文件，您需要使用以下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sftp [options] [username]@[hostname]  </span><br></pre></td></tr></table></figure><p>其中，<code>[options]</code> 是可选的参数，例如 <code>-i</code> 指定要使用的私钥文件，<code>-L</code> 指定要使用的本地端口转发，<code>-R</code> 指定要使用的远程端口转发等。<code>[username]</code> 是远程主机的用户名，<code>[hostname]</code> 是远程主机的主机名或 IP 地址。<br>例如，如果您要使用密钥文件 <code>id_rsa</code> 将本地文件 <code>file.txt</code> 传输到远程主机 <code>example.com</code>，可以使用以下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sftp -i id_rsa example.com  </span><br></pre></td></tr></table></figure><h2 id="高级用法"><a href="#高级用法" class="headerlink" title="高级用法"></a>高级用法</h2><h3 id="1-端口转发"><a href="#1-端口转发" class="headerlink" title="1. 端口转发"></a>1. 端口转发</h3><blockquote><p>ref:<a href="https://zhuanlan.zhihu.com/p/57630633">SSH命令的三种代理功能 - 韦易笑</a></p></blockquote><p>OpenSSH 提供了一种称为端口转发的功能，允许您将本地端口与远程端口进行映射。这使得您可以在本地网络上使用远程服务，而无需将服务暴露给外部网络。要使用端口转发，您需要使用以下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -L [local_port:]local_host [username]@[hostname]  </span><br></pre></td></tr></table></figure><p>其中，<code>[local_port]</code> 是本地端口的名称，<code>local_host</code> 是本地主机的名称或 IP 地址，<code>[username]</code> 是远程主机的用户名，<code>[hostname]</code> 是远程主机的主机名或 IP 地址。<br>例如，如果您要将本地端口 8080 映射到远程主机的 SSH 服务（端口 22），可以使用以下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -L 8080:localhost username@example.com  </span><br></pre></td></tr></table></figure><p>上面的指令就能很轻易实现基于<code>xxx over SSH</code>的内网穿透。举个例子，前面我配置好了我的服务器的<code>ssh config</code>，假设我的服务器配置项名为<code>server</code>，在局域网中有一台地址为<code>1.14.5.14</code>的Windows服务器，那么我就可以使用一行指令通过SSH跳转连接到这台Windows服务器的远程桌面：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -L 3389:1.14.5.14:3389 server -N &amp; rdesktop localhost</span><br></pre></td></tr></table></figure><p>假设我的这台服务器<code>server</code>在层层内网中，需要经过多重跳板才能从公网进行访问，一般的远程桌面面对这种网络环境可能比较困难，但是对于上面的<code>RDP over SSH</code>，这种方法既能享受<code>SSH</code>的安全性，又能相对便利地进行访问——只要配置好这台<code>server</code>服务器的<code>ProxyJump</code>路径和登陆就行。</p><p>端口转发有三种方式，上边的<code>-L</code>是正向代理，也就是在本地启动端口，把本地的数据转发到远端。上面转发桌面的例子就是这样，把本地3389端口的RDP请求转发到了远端的3389端口，从而实现了从本地访问远程服务器所在局域网的计算机的需求。另外两种分别是反向代理<code>-R</code>和socks5代理<code>-D</code>。这个一般可以作为兜底方案，长期需求建议上服务器。</p><p>按照正向代理的思路，反向代理就是把远端端口的访问请求转发到本地的计算机上。比如访问一个公网计算机的1234端口，就可以通过<code>-R</code>启动反向代理将这个端口的请求转发到本地的任意端口（比如4514）从而将内网的某个服务映射到公网中。这一点特别适合临时给某个服务搭建一个预览平台。</p><p>另外就是socks5转发，可以直接点上边链接看原文，这种我还没用过就不做阐述了。</p><p>下面用指令总结下这几种代理方式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转发本地请求到远端，例如访问远程局域网的远程桌面</span></span><br><span class="line">ssh -L [本地主机所在局域网任意主机:端口]:[目标主机所在局域网任意主机:端口] 要连接的主机</span><br><span class="line"><span class="comment"># 转发远端请求到本地，例如穿透本机某端口的服务到公网</span></span><br><span class="line">ssh -R [远端主机:端口]:[本地主机局域网任意主机:端口] 远端主机</span><br><span class="line"><span class="comment"># 本地socks5代理，效果大概就是让远端主机成为自己1080端口的上网代理？</span></span><br><span class="line"><span class="comment"># 完成之后，在浏览器代理设置里边设置代理为socks5，地址为localhost:1080就行</span></span><br><span class="line">ssh -D localhost:1080 远端主机</span><br></pre></td></tr></table></figure><ol start="2"><li>连接后执行一条指令后断开</li></ol><p>直接在连接命令后边跟上要执行的指令就行。</p><ol start="3"><li>在远程主机运行X程序</li></ol><p>连接命令加上<code>-X</code>参数，然后主机就会开启X转发。用<code>-x</code>则是关闭X转发。没用过，不过看起来像是服务器上跑进程，本地跑GUI的做法？</p>]]></content>
    
    
    <summary type="html">节省生命从小事做起</summary>
    
    
    
    
    <category term="Linux" scheme="https://mxts.jiujiuer.xyz/tags/Linux/"/>
    
    <category term="SSH" scheme="https://mxts.jiujiuer.xyz/tags/SSH/"/>
    
  </entry>
  
  <entry>
    <title>Flutter速通指南</title>
    <link href="https://mxts.jiujiuer.xyz/2023/09/16/flutter-intro/"/>
    <id>https://mxts.jiujiuer.xyz/2023/09/16/flutter-intro/</id>
    <published>2023-09-16T08:34:35.000Z</published>
    <updated>2024-06-04T16:42:26.930Z</updated>
    
    <content type="html"><![CDATA[<p>2023 XDU-OSC Community - Presented with love by BenderBlog&#x2F;SuperBart</p><p>借助Flutter，他重新实现了校内十分流行的工具软件电表，使得用iOS的同学也有了自己的电表可用。开源和Flutter带来的，对于开发工作的简化<del>以及SuperBart的超级肝力</del>都成为了它能迅速上架iOS并迅速迭代的原因。</p><p>原生的电表iOS版本使用了iOS Native开发，在开发效率上略低于先天统一了不同平台实现的Flutter。在运行效率上的提升在业务都相对比较简单的情况下并没有很显著的优势。</p><p>其实上面这点也是现在原生客户端开发面对的问题。原生带来了更细致入微的操作粒度，带来更极致的原生性能利用率的同时，对于开发者心智的负担要求很高，也对开发者的能力深入性和熟练度提出了很高的要求；应对这一点的解决方案，有使用Web技术统一全端（就是性能问题和资源利用率一直饱受诟病），也有使用像Flutter这样的混合跨平台框架。后者性能损失相对没那么严重，跨平台能力也相对不错，但是动态程序的本质让它对于低性能设备的友好度较低（比如现在的百度贴吧客户端就是Flutter客户端，面对长列表的加载等场景偶尔会出现崩溃等问题）。</p><p>开发效率和程序运行表现基本是一对负相关的参数，其中的取舍就是开发者需要考虑的问题。在程序开发领域，没有银弹。</p><h2 id="SuperBart的讲座"><a href="#SuperBart的讲座" class="headerlink" title="SuperBart的讲座"></a>SuperBart的讲座</h2><h3 id="Flutter概要"><a href="#Flutter概要" class="headerlink" title="Flutter概要"></a>Flutter概要</h3><p>一套代码 (<code>./lib</code>), 多平台运行.</p><blockquote><p>android, windows, linux, ios等.</p></blockquote><ul><li>面向客户端</li><li>平台无关</li><li>上手简单</li></ul><p>Flutter的开发语言是Dart，初见印象：Dart&#x3D; JS&#x2F;C++(语言友好度和性能上) + Java(代码风格上) + Dart VM</p><h3 id="Basic-code-format"><a href="#Basic-code-format" class="headerlink" title="Basic code format"></a>Basic code format</h3><p>tldr</p><ul><li>Empty safety: <code>type?</code> means var is nullable</li></ul><p>This will trigger empty check, avoid npe</p><ul><li>late init</li></ul><p>Just like Kotlin</p><ul><li>Async</li></ul><h3 id="Basic-layouts"><a href="#Basic-layouts" class="headerlink" title="Basic layouts"></a>Basic layouts</h3><ul><li>Widget</li><li>Text</li><li>Warp</li><li>Row-Column</li><li>Container</li></ul><h3 id="Basic-scaffolds"><a href="#Basic-scaffolds" class="headerlink" title="Basic scaffolds"></a>Basic scaffolds</h3><ul><li>AppBar</li><li>Action</li><li>TItle</li><li>TabBar</li><li>Body</li><li>BottomBar</li></ul><h3 id="Network"><a href="#Network" class="headerlink" title="Network"></a>Network</h3><p>主要使用<code>Flutter</code>的<code>Dio</code>。不过我用<code>http/http.dart</code>更多。</p><h2 id="开发笔记"><a href="#开发笔记" class="headerlink" title="开发笔记"></a>开发笔记</h2><p>评价是Flutter这玩意搓东西真的快。</p><p>Flutter使用的dart语言，强类型和可写性平衡的挺舒服的。语法上，Dart算是JavaScript的继承，语法大差不差，改进了JavaScript混乱的类型系统，还封装了不少挺不错的语法特性，比如那个Future，用着还行。还有内置的高级数据结构之类的，用着挺省心。</p><p>不过写这东西，我好像很少单独注意语法层面的东西，一般都是定义个返回Widget的build函数完事。另外这语言比较像DSL，没见过别处有用这玩意的。</p><h3 id="关于WebViewWidget"><a href="#关于WebViewWidget" class="headerlink" title="关于WebViewWidget"></a>关于WebViewWidget</h3><p>这玩意比较坑的一点是它只支持Android和iOS平台，对于Windows&#x2F;Linux&#x2F;Web平台，这玩意都是不支持的。。</p><p>所以review同学的代码的时候，发现在我用Linux平台跑的时候报错了。搜了下才发现这问题。</p><p>不过也无所谓了，反正这玩意本来就只是在Android&#x2F;iOS上跑的。</p><h3 id="关于TextEditController"><a href="#关于TextEditController" class="headerlink" title="关于TextEditController"></a>关于TextEditController</h3><p>声明一个文本框时，它会默认初始化一个TextEditController。如果你传递给它你定义的Controller，它就会使用你提供的而不是自己创建。另外特别注意，给TextField赋值这一项的行为不是常量表达式，不能在它和它的父结构中使用<code>const</code>关键字。</p><h3 id="关于sqflite"><a href="#关于sqflite" class="headerlink" title="关于sqflite"></a>关于sqflite</h3><p>这玩意有大坑（关于平台兼容性上的）。反正我目前尝试之后发现要么支持Windows&#x2F;Linux&#x2F;Mac等桌面端，要么支持Android&#x2F;iOS等移动端的SQLite使用。</p><h3 id="关于ListView"><a href="#关于ListView" class="headerlink" title="关于ListView"></a>关于ListView</h3><p>关于这个东西，得注意的就是嵌套使用。嵌套的子<code>ListView</code>，需要设置如下两个属性来避免滚定判定失效：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shrinkWrap: true,</span><br><span class="line">physics: const NeverScrollableScrollPhysics(),</span><br></pre></td></tr></table></figure><h3 id="关于项目结构"><a href="#关于项目结构" class="headerlink" title="关于项目结构"></a>关于项目结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">lib/</span><br><span class="line">  |- models/                  // Define your data entities here</span><br><span class="line">     |- entity1.dart</span><br><span class="line">     |- entity2.dart</span><br><span class="line">  |- services/                // Implement background service here</span><br><span class="line">     |- background_service.dart</span><br><span class="line">  |- screens/                 // Screens of your app</span><br><span class="line">     |- screen1/              // Screen 1 related files</span><br><span class="line">         |- screen1.dart</span><br><span class="line">         |- screen1_bloc.dart // If you&#x27;re using BLoC pattern</span><br><span class="line">     |- screen2/              // Screen 2 related files</span><br><span class="line">         |- screen2.dart</span><br><span class="line">         |- screen2_bloc.dart // If you&#x27;re using BLoC pattern</span><br><span class="line">     |- settings/             // Settings related pages</span><br><span class="line">         |- settings.dart</span><br><span class="line">         |- sub_setting1.dart</span><br><span class="line">         |- sub_setting2.dart</span><br><span class="line">  |- widgets/                 // Reusable widgets</span><br><span class="line">  |- providers/               // Provider setup and providers for data and services</span><br><span class="line">     |- app_provider.dart     // Main provider setup</span><br><span class="line">     |- data_provider.dart    // Provider for CRUD actions on data entities</span><br><span class="line">     |- service_provider.dart // Provider for background service</span><br><span class="line">  |- main.dart                // Entry point of the app</span><br></pre></td></tr></table></figure><p>功能划分基本就这几块：UI，状态管理服务，数据实体，后台服务。代码嘛，能简洁点最好。</p><p>另外就我的开发经验而言，最好不要过早规范化工程化。早期过于强调规范和过程的收益是负的。</p><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><ul><li>Invalid kernel binary version</li></ul><p>解决方法：清理<code>flutter/bin/cache</code> 下缓存。在Arch Linux下，通过pacman安装的flutter的缓存目录位于<code>/usr/lib/flutter/bin/cache</code>，可以用<code>whereis</code>命令找到。</p>]]></content>
    
    
    <summary type="html">Presented by BenderBlog/SuperBart，感谢学长带咱入坑(OwO)</summary>
    
    
    
    
    <category term="Flutter" scheme="https://mxts.jiujiuer.xyz/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>C++-STL速通</title>
    <link href="https://mxts.jiujiuer.xyz/2023/09/14/cpp-stl/"/>
    <id>https://mxts.jiujiuer.xyz/2023/09/14/cpp-stl/</id>
    <published>2023-09-14T14:09:12.000Z</published>
    <updated>2024-06-04T16:42:26.930Z</updated>
    
    <content type="html"><![CDATA[<p>C++用的比较少，最近准备试试CSP。于是就得赶紧学学STL。以前是用过，但是没咋记下来。</p><p>想查看所有std实体的话，使用下面的指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apropos -r <span class="string">&#x27;^std&#x27;</span> | vim -</span><br></pre></td></tr></table></figure><p>关于<code>apropos</code>，它是LINUX系统中的一个命令，用来通过关键字查找定位手册页的名字和描述。 它相当于使用带有-k选项的man命令。 每个手册页里都有一个简短的描述。 apropos在这个描述中查找keyword。这是使用<code>man</code> 帮助文档的一个好工具。</p><h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><ul><li>顺序式：<code>vector, list, deque</code></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">begin</span>()</span><br><span class="line"><span class="built_in">end</span>()</span><br><span class="line"><span class="built_in">rbegin</span>()</span><br><span class="line"><span class="built_in">rend</span>()</span><br><span class="line"><span class="built_in">front</span>()</span><br><span class="line"><span class="built_in">back</span>()</span><br><span class="line"><span class="built_in">erase</span>()</span><br><span class="line"><span class="built_in">clear</span>()</span><br><span class="line"><span class="built_in">push_back</span>()</span><br><span class="line"><span class="built_in">pop_back</span>()</span><br><span class="line"><span class="built_in">insert</span>()</span><br></pre></td></tr></table></figure><h3 id="Vector"><a href="#Vector" class="headerlink" title="Vector"></a>Vector</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br></pre></td></tr></table></figure><p>简而言之就是数组，但是优化过，缝合了诸如队列、栈一类的特性。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; vec; <span class="comment">// 声明一个空的vector</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">vec</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">vec</span><span class="params">(<span class="number">10</span>, <span class="number">1</span>)</span></span>; <span class="comment">// 大小为10, 初始值为1</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">vec</span><span class="params">(oldVec)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">vec</span><span class="params">(oldVec.begin(), dolVec.begin()+<span class="number">3</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> arr[<span class="number">5</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">vec</span><span class="params">(arr, arr+<span class="number">5</span>)</span></span>; <span class="comment">// 用数组初始化vec</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">vec</span><span class="params">(&amp;arr[<span class="number">0</span>], &amp;arr[<span class="number">5</span>])</span></span>; <span class="comment">// 用数组初始化vec, 注意这里是超尾, 与end相对应</span></span><br></pre></td></tr></table></figure><p>那么如果我希望直接在下标为5的位置直接放入这个3呢，那不是需要先往里塞入5个0才可以么？这种情况，我们就可以定义一下vector的长度，然后就可以当做数组一样用了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">a[<span class="number">5</span>] = <span class="number">3</span>;</span><br></pre></td></tr></table></figure><h3 id="List"><a href="#List" class="headerlink" title="List"></a>List</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br></pre></td></tr></table></figure><p>双向链表。因此并不支持随机访问。尾部插入元素效率很高。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">list&lt;<span class="type">int</span>&gt; l;</span><br><span class="line"><span class="function">list&lt;<span class="type">int</span>&gt; <span class="title">l</span><span class="params">(<span class="number">5</span>)</span></span>; <span class="comment">// 含有5个元素的list, 初始值为0</span></span><br><span class="line"><span class="function">list&lt;<span class="type">int</span>&gt; <span class="title">l</span><span class="params">(<span class="number">10</span>, <span class="number">1</span>)</span></span>; <span class="comment">// 含有10个元素的list, 初始值为1</span></span><br><span class="line"><span class="function">list&lt;<span class="type">int</span>&gt; <span class="title">l</span><span class="params">(oldL)</span></span>; <span class="comment">// 复制构造</span></span><br><span class="line"><span class="function">list&lt;<span class="type">int</span>&gt; <span class="title">l</span><span class="params">(oldL.begin(), oldL.end())</span></span>;</span><br><span class="line"><span class="type">int</span> arr[<span class="number">5</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line"><span class="function">list&lt;<span class="type">int</span>&gt; <span class="title">l</span><span class="params">(arr, arr+<span class="number">5</span>)</span></span>; <span class="comment">// 用数组初始化list</span></span><br><span class="line"><span class="function">list&lt;<span class="type">int</span>&gt; <span class="title">l</span><span class="params">(&amp;arr[<span class="number">1</span>], &amp;arr[<span class="number">5</span>])</span></span>; <span class="comment">// 用数组初始化list</span></span><br><span class="line"></span><br><span class="line">list.<span class="built_in">merge</span>() <span class="comment">// 合并两个list</span></span><br><span class="line">list.<span class="built_in">remove</span>()</span><br><span class="line">list.<span class="built_in">remove_if</span>() <span class="comment">// 按指定条件删除元素</span></span><br><span class="line">list.<span class="built_in">reverse</span>() <span class="comment">// 逆置list元素</span></span><br><span class="line">list.<span class="built_in">sort</span>() <span class="comment">// 排序</span></span><br><span class="line">list.<span class="built_in">unique</span>() <span class="comment">// 删除重复元素</span></span><br><span class="line">list.<span class="built_in">splice</span>() <span class="comment">// 从另一个 list 中移动元素</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Most used functions</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">push_front</span>() <span class="comment">// vector 没有该函数</span></span><br><span class="line"><span class="built_in">pop_front</span>() <span class="comment">// vector 没有该函数</span></span><br></pre></td></tr></table></figure><h3 id="Deque"><a href="#Deque" class="headerlink" title="Deque"></a>Deque</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;deque&gt;</span></span></span><br></pre></td></tr></table></figure><p>双端队列。每个元素在内存上是连续的，类似vector，是它的升级版。它有高效的首尾插入&#x2F;删除操作。实现方法相当于list和vector的折衷。</p><p>它支持随机访问和<code>at()</code>。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">push_back</span>()</span><br><span class="line"><span class="built_in">pop_back</span>()</span><br><span class="line"><span class="built_in">push_front</span>() <span class="comment">// vector 没有该函数</span></span><br><span class="line"><span class="built_in">pop_front</span>() <span class="comment">// vector 没有该函数</span></span><br></pre></td></tr></table></figure><ul><li>关联式容器： <code>map, unordered_map, multimap, unordered_multimap, set, unordered_set, multiset, unordered_multiset</code></li></ul><h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br></pre></td></tr></table></figure><p>一种基于红黑树的键值对数据结构。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数据插入, 复杂度为 logn</span></span><br><span class="line">map.<span class="built_in">insert</span>(&#123;key, value&#125;);</span><br><span class="line">map[key] = value;</span><br><span class="line"><span class="comment">// 移除, 复杂度为 logn</span></span><br><span class="line">map.<span class="built_in">erase</span>(key)</span><br><span class="line"><span class="comment">// 搜索, 复杂度为 logn</span></span><br><span class="line">map.<span class="built_in">find</span>()</span><br><span class="line">map[key]</span><br><span class="line"></span><br><span class="line">map.<span class="built_in">count</span>() <span class="comment">// 返回匹配特定键的元素数量, 对数复杂度</span></span><br><span class="line">map.<span class="built_in">contains</span>()</span><br><span class="line">map.<span class="built_in">equal_range</span>()</span><br><span class="line">map.<span class="built_in">lower_bound</span>()</span><br><span class="line">map.<span class="built_in">upper_bound</span>()</span><br></pre></td></tr></table></figure><h3 id="Unordered-Map"><a href="#Unordered-Map" class="headerlink" title="Unordered-Map"></a>Unordered-Map</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span></span></span><br></pre></td></tr></table></figure><p>区别于前者使用红黑树实现，它使用哈希函数实现，因此元素无序。</p><p>注意，默认情况下，它只支持使用<code>int</code>作为键，其他类型是不合法的。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数据插入, 复杂度为 logn</span></span><br><span class="line">map.<span class="built_in">insert</span>(&#123;key, value&#125;);</span><br><span class="line">map[key] = value;</span><br><span class="line"><span class="comment">// 移除, 复杂度为 logn</span></span><br><span class="line">map.<span class="built_in">erase</span>(key)</span><br><span class="line"><span class="comment">// 搜索, 复杂度为 logn</span></span><br><span class="line">map.<span class="built_in">find</span>()</span><br><span class="line">map[key]</span><br><span class="line"></span><br><span class="line">map.<span class="built_in">count</span>() <span class="comment">// 返回匹配特定键的元素数量, 对数复杂度</span></span><br><span class="line">map.<span class="built_in">contains</span>()</span><br><span class="line">map.<span class="built_in">equal_range</span>()</span><br><span class="line">map.<span class="built_in">lower_bound</span>()</span><br><span class="line">map.<span class="built_in">upper_bound</span>()</span><br></pre></td></tr></table></figure><h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br></pre></td></tr></table></figure><p>set 是一个关键字集合, 其中的关键字 不可重复, 其底层采用红黑树实现, 因此集合中的元素是 有序 的, 在 set 容器上进行的搜索, 插入和移除等操作都是<strong>对数复杂度</strong>的.</p><p>特有操作：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">lower_bound</span>() <span class="comment">// 返回指向首个不小于给定键的元素的迭代器</span></span><br><span class="line"><span class="built_in">upper_bound</span>() <span class="comment">// 返回指向首个大于给定键的元素的迭代器</span></span><br><span class="line"><span class="built_in">erase_if</span>()</span><br></pre></td></tr></table></figure><h3 id="Stack"><a href="#Stack" class="headerlink" title="Stack"></a>Stack</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line">stack&lt;<span class="type">int</span>&gt; s;</span><br><span class="line">s.<span class="built_in">push</span>(data);</span><br><span class="line">s.<span class="built_in">pop</span>();</span><br><span class="line">s.<span class="built_in">top</span>();    <span class="comment">// get value of top</span></span><br><span class="line">s.<span class="built_in">empty</span>()   <span class="comment">// judge whether stack is empty</span></span><br></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://stackoverflow.com/questions/5293737/where-are-the-man-pages-for-c">StackOverflow - Where are the man pages for C++? [closed]</a></li><li><a href="https://forever97.top/2020/10/21/Re0-2/">forever97</a></li><li><a href="https://baike.baidu.com/item/apropos/15852795">百度百科 - apropos</a></li></ul>]]></content>
    
    
    <summary type="html">(*/ω＼*)</summary>
    
    
    
    
    <category term="C++" scheme="https://mxts.jiujiuer.xyz/tags/C/"/>
    
    <category term="STL" scheme="https://mxts.jiujiuer.xyz/tags/STL/"/>
    
  </entry>
  
  <entry>
    <title>Arch Linux折腾笔记</title>
    <link href="https://mxts.jiujiuer.xyz/2023/09/05/arch-linux%E6%8A%98%E8%85%BE%E7%AC%94%E8%AE%B0/"/>
    <id>https://mxts.jiujiuer.xyz/2023/09/05/arch-linux%E6%8A%98%E8%85%BE%E7%AC%94%E8%AE%B0/</id>
    <published>2023-09-05T13:39:57.000Z</published>
    <updated>2024-06-04T16:42:26.930Z</updated>
    
    <content type="html"><![CDATA[<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>参考 Arch Wiki 或者参考这个简化版教程：<a href="https://arch.icekylin.online/">https://arch.icekylin.online/</a>。过程按照教程一步步折腾就ok，只要注意区分清楚各个分区，别不小心把数据分区给格式化了就行。联网是安装Arch的必须项，所以请保持网络畅通。另外，建议<strong>安装镜像最好在安装完成后继续保留着</strong>，应急情况下（比如滚挂了）可以用<code>arch-chroot</code>来应急重装内核之类的。</p><blockquote><p>至于Arch经常被吐槽滚挂了的原因，主要是源自Arch的更新策略比较激进，更新完成后，会直接删除老内核，比起一般的更新策略更容易出现依赖问题造成“滚挂了“。</p></blockquote><p>桌面环境、cn源、透明代理之类的配置，也可以参考上面的教程。关于透明代理，也可以参考<a href="https://blog.linioi.com/posts/clash-on-arch/">这篇文章</a>。</p><h2 id="美化"><a href="#美化" class="headerlink" title="美化"></a>美化</h2><p>这点上因人而异。我装了layan主题之后，再换个壁纸，装个latte就差不多了。我的原则是，美化差不多就行，但是前提是别影响到系统性能。</p><h2 id="显示适配"><a href="#显示适配" class="headerlink" title="显示适配"></a>显示适配</h2><p>单显示器的配置很简单，改下dpi缩放就基本ok。如果是多显示器的话，就会复杂一些。参考下面的公式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 假设HiDPI显示器的分辨率是AxB，普通分辨率显示器的分辨率是CxD </span></span><br><span class="line"><span class="comment"># 并且外置显示器的缩放比率是ExF</span></span><br><span class="line">xrandr --output eDP-1 --auto --output HDMI-1 --auto --panning [C*E]x[D*F]+[A]+0 --scale [E]x[F] --right-of eDP-1</span><br></pre></td></tr></table></figure><p>根据上面的公式来设置，基本上能搞定。当然，如果想调整的是内置HiDPI显示器分辨率，就得调整最后<code>panning</code>的A为Ax[A的缩放比率]。</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul><li>[1] <a href="https://nmgit.net/2020/139/">Barry的笔记</a></li><li>[2] <a href="https://harttle.land/2019/12/24/auto-xrandr.html">X11 多显示器配置：玩转 XRandR</a></li></ul><h2 id="pacman入门"><a href="#pacman入门" class="headerlink" title="pacman入门"></a>pacman入门</h2><p>问了问GPT，大概做了下笔记如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Sy                     <span class="comment"># 更新软件包数据库</span></span><br><span class="line">sudo pacman -S package_name         <span class="comment"># 安装软件包，可批量安装</span></span><br><span class="line">sudo pacman -R package_name         <span class="comment"># 删除软件包但保留配置</span></span><br><span class="line">sudo pacman -Rn package_name        <span class="comment"># 删除包和配置</span></span><br><span class="line">sudo pacman -Syu                    <span class="comment"># 升级所有已安装的包</span></span><br><span class="line">sudo pacman -Sc                     <span class="comment"># 清理pacman缓存的旧包</span></span><br><span class="line">sudo pacman -Ss search_term         <span class="comment"># 查找软件包</span></span><br><span class="line">sudo pacman -Si package_name        <span class="comment"># 查找软件包信息</span></span><br><span class="line">sudo pacman -Rns $(pacman -Qdtq)    <span class="comment"># 删除未使用依赖包</span></span><br></pre></td></tr></table></figure><p>另外，<code>Syu</code>和<code>Syyu</code>的区别在于后者强制刷新了软件仓库缓存。后者虽然更新比较及时，但是用得多对于软件源仓库并不友好，而且浪费资源，不宜过于频繁使用。</p><p>最底下那个移除孤儿包的操作少用，用的时候手动确认是否包括重要依赖。</p><p>另外还有个操作，就是完整备份安装过的包列表，然后在新的系统上重新安装，这个用<code>pacman</code>可以做到。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pacman -Qqe &gt; installed_packages.txt                <span class="comment"># 备份当前系统上所有已经明确安装的包</span></span><br><span class="line">sudo pacman -S --needed - &lt; installed_packages.txt  <span class="comment"># 只安装其中没有安装过的包</span></span><br></pre></td></tr></table></figure><p>不过使用这个操作的时候，记得得保证清单的实时性，因为arch滚动更新，系统一直是新的，备份列表太久没更新的话在新系统上安装会有依赖，兼容等等问题。</p><h2 id="启用外部ssh连接"><a href="#启用外部ssh连接" class="headerlink" title="启用外部ssh连接"></a>启用外部ssh连接</h2><p>如果想从外部连接到Arch的电脑上，只要安装了openssh就行。Arch默认不会启动<code>sshd</code>，所以我们得手动开启：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start sshd</span><br></pre></td></tr></table></figure><h2 id="在命令行连接Wi-Fi"><a href="#在命令行连接Wi-Fi" class="headerlink" title="在命令行连接Wi-Fi"></a>在命令行连接Wi-Fi</h2><p>在完成安装后，启动NetworkManager：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> --now NetworkManager</span><br></pre></td></tr></table></figure><p>然后使用<code>nmcli</code>来连接Wi-Fi：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nmcli dev wifi list</span><br><span class="line"><span class="comment"># 后面的password部分不指定的话，会自动要求输入</span></span><br><span class="line">nmcli dev wifi connect <span class="string">&quot;SSID&quot;</span> password <span class="string">&quot;password&quot;</span></span><br></pre></td></tr></table></figure><h2 id="使用TimeShift备份系统"><a href="#使用TimeShift备份系统" class="headerlink" title="使用TimeShift备份系统"></a>使用TimeShift备份系统</h2><p>TimeShift是一个很好用的系统备份软件，特别是结合了btrfs之后，备份的体积比借助<code>rsync</code>时更小。</p><p>折腾系统时不时可能滚挂，这种时候有个定期创建的映像就很有用了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo timeshift --list <span class="comment"># 获取快照列表</span></span><br><span class="line">sudo timeshift --restore --snapshot <span class="string">&#x27;20XX-XX-XX_XX-XX-XX&#x27;</span> --skip-grub <span class="comment"># 选择一个快照进行还原，并跳过 GRUB 安装，一般来说 GRUB 不需要重新安装</span></span><br></pre></td></tr></table></figure><p>如果恢复后无法使用，用安装盘通过<code>arch-chroot</code>进去系统，然后手动更改<code>subvolid</code>来手动修复，或者直接删除<code>subvolid</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取subvolid</span></span><br><span class="line">sudo btrfs sub list -u /</span><br><span class="line"><span class="comment"># 编辑,根据自己情况，修复</span></span><br><span class="line">vim /etc/fstab</span><br></pre></td></tr></table></figure><h2 id="重启显示管理器（Xorg-x2F-Wayland）"><a href="#重启显示管理器（Xorg-x2F-Wayland）" class="headerlink" title="重启显示管理器（Xorg&#x2F;Wayland）"></a>重启显示管理器（Xorg&#x2F;Wayland）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart display-manager</span><br></pre></td></tr></table></figure><h2 id="Vim"><a href="#Vim" class="headerlink" title="Vim"></a>Vim</h2><p>装上Arch之后我很快就把Vim装上了。结果发现没法和系统剪贴板联动。在Vim里边检查<code>has(clipboard)</code>之后发现，好像这个Vim不支持剪贴板。</p><p>解决方法：装<code>gvim</code>：<code>sudo pacman -S gvim</code>。会提示你是否卸载Vim，选是，配置不会删除所以放心删。安装完了之后你就会发现Vim还能用，而且剪贴板功能好了：</p><p><img src="/img/Pasted%20image%2020230926210217.png"></p><h2 id="桌面目录映射"><a href="#桌面目录映射" class="headerlink" title="桌面目录映射"></a>桌面目录映射</h2><p>今天看到群里一个老哥家目录下的文件都堆到桌面了，顺便了解了一下关于桌面目录映射的问题。因为有时候中文模式创建的家目录下的文件夹都是中文，那个老哥就是改成英文目录的时候遇到了这个问题。</p><p><code>XDG_DESKTOP_DIR</code>这个环境变量的介绍，在archWiki上也能翻到。</p><blockquote><p><a href="https://wiki.archlinux.org/title/XDG_Base_Directory">XDG_DESKTOP_DIR是一个环境变量，用于指定用户的桌面文件夹的位置。它是XDG Base Directory规范</a><a href="https://wiki.archlinux.org/title/XDG_Base_Directory">1</a><a href="https://wiki.archlinux.org/title/XDG_user_directories">的一部分，该规范定义了一些标准的用户目录，如音乐、图片、下载等，以及一些用于存储配置、缓存、数据和状态的目录。XDG_DESKTOP_DIR的默认值是$HOME&#x2F;Desktop，但用户可以通过编辑~&#x2F;.config&#x2F;user-dirs.dirs文件或使用xdg-user-dirs-update命令来修改它</a><a href="https://wiki.archlinux.org/title/XDG_user_directories">2</a>。</p><p><a href="https://wiki.archlinux.org/title/Desktop_entries">KDE桌面环境遵循XDG Base Directory规范，并使用XDG_DESKTOP_DIR变量来确定桌面文件夹的位置。如果用户更改了XDG_DESKTOP_DIR的值，KDE会自动更新桌面设置，并将桌面文件夹更改为新的位置。这样，用户可以灵活地管理自己的桌面文件夹，而不影响其他应用程序或桌面环境</a><a href="https://wiki.archlinux.org/title/Desktop_entries">3</a>。</p></blockquote><p>所以出问题的话看看<code>.config</code>底下配置炸没炸就行。</p><h2 id="添加多系统启动项"><a href="#添加多系统启动项" class="headerlink" title="添加多系统启动项"></a>添加多系统启动项</h2><p>在安装Arch的时候，会发现中间有一步是<code>sudo vim /etc/default/grub</code>然后<code>grub-mkconfig -o /boot/grub/grub.cfg</code>。这一步就是先编辑grub的配置，然后生成grub文件到<code>/boot/grub/</code>下的配置文件中。因此，我们如果突然心血来潮想装个Windows玩玩<del>谁装啊</del>，就可以改改grub配置让它为我们添加启动项。</p><p>因为最终的配置项是由<code>grub-mkconfig</code>生成的，所以并不推荐直接修改这个文件。更好的做法是安装<code>os-prober</code>，然后挂载其他系统的分区，并编辑grub配置文件启用os探测，最后再用<code>grub-mkconfig</code>生成新的grub启动项文件。</p><blockquote><p>至于为啥grub现在默认禁用掉了os-prober，注释里边说的是因为安全问题所以禁用掉了。</p></blockquote><h2 id="代理配置"><a href="#代理配置" class="headerlink" title="代理配置"></a>代理配置</h2><p>既然都上Arch了，那代理软件不得整个自由点的？直接扔了cfw，拥抱clash-core。具体配置教程参考<a href="https://blog.linioi.com/posts/clash-on-arch/">这篇</a>，我给个简洁版的：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 实在懒得sudo了</span></span><br><span class="line"><span class="comment"># 不过记得看清命令再回车</span></span><br><span class="line">sudo su</span><br><span class="line">pacman -S clash</span><br><span class="line"><span class="built_in">mkdir</span> -p /etc/clash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 然后从provider那里下载yaml配置文件</span></span><br><span class="line"><span class="comment"># 假设文件名为config.yaml</span></span><br><span class="line"><span class="built_in">mv</span> ./config.yaml /etc/clash/</span><br><span class="line"><span class="comment"># 设置控制面板路径</span></span><br><span class="line"><span class="comment"># 我这里的控制面板路径在/etc/clash/clash-dashboard</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;external-ui: clash-dashboard&#x27;</span> &gt;&gt; /etc/clash/config.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置环境变量，配完了记得重启/重新登陆一下</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt;&gt; /etc/environment</span></span><br><span class="line"><span class="string">https_proxy=http://127.0.0.1:7890</span></span><br><span class="line"><span class="string">http_proxy=http://127.0.0.1:7890</span></span><br><span class="line"><span class="string">all_proxy=http://127.0.0.1:7890</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置systemd服务项</span></span><br><span class="line"><span class="comment"># 配完了就能开机自启动了哦</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt; /etc/systemd/system/clash.service</span></span><br><span class="line"><span class="string">[Unit]</span></span><br><span class="line"><span class="string">Description=Clash daemon, A rule-based proxy in Go.</span></span><br><span class="line"><span class="string">After=network.target</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Service]</span></span><br><span class="line"><span class="string">Type=simple</span></span><br><span class="line"><span class="string">Restart=always</span></span><br><span class="line"><span class="string">ExecStart=/usr/bin/clash -d /etc/clash # /usr/bin/clash 为绝对路径，请根据你实际情况修改</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Install]</span></span><br><span class="line"><span class="string">WantedBy=multi-user.target</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###############</span></span><br><span class="line"><span class="comment"># clash，启动！</span></span><br><span class="line"><span class="comment">###############</span></span><br><span class="line">systemctl <span class="built_in">enable</span> --now clash.service</span><br></pre></td></tr></table></figure><p>里边比较重要的一步是配置环境变量env，上回配置的时候忘了加<code>http</code>前缀，结果系统里边啥玩意都不认我的代理设置。</p><p>哦对，配置完成之后还得在系统里边设置好代理：</p><p><img src="/img/Pasted%20image%2020231023164736.png"></p><blockquote><p>悲：cfw跑路之后clash-core也跑路了<br>然后所有client都跑路了<br>为clash家族 + 1s<br>以及我的评价是：<br><img src="/img/Pasted%20image%2020231103203831.png"><br>以及某作者的睿频：<br>最适合这个民族的其实是一群小<br>白围着大大转，大大通过小白的夸奖获得自我满足，然后小白的吃喝拉撒都包给大大解决的模式。通过这个项目我感觉我已经彻底认识到这个民族的前面为什么会有一堵墙了。没有墙哪来的大大。所以到处都是什么附件回帖可见，等级多少用户组可见，一个论坛一个大大供小白跪舔，不需要政府造墙，网民也会自发造墙。这尼玛连做个翻墙软件都要造墙，真是令人叹为观止。这是一个造了几干年墙的保守的农耕民族，缺乏对别人的基本尊重，不愿意分享，喜欢遮遮掩掩，喜欢小圈子抱团，大概这些传统是改不掉了吧。</p></blockquote><p>另外还有一个，就是切换节点必须得使用clash的控制端口（在<code>config.yaml</code>中给出，一般是<code>9090</code>），所以还必须得有个控制面板。一般Windows平台都是用<del>已经似了的</del>Clash For Windows作为控制面板的，而Linux这边使用<a href="https://clash.razord.top/">https://clash.razord.top/</a>也就是<del>也已经似了的</del><a href="https://github.com/Dreamacro/clash-dashboard/">Clash的官方控制面板</a>作为控制面板的。实在不行了可以用命令行下的TUI工具<code>clashctl</code>来手动切换节点，应该也能用。</p><h2 id="RDP连接Windows"><a href="#RDP连接Windows" class="headerlink" title="RDP连接Windows"></a>RDP连接Windows</h2><p>用Arch多了，有时候得偶尔远程一下Windows。配置了半天<code>Remmina</code>+<code>freerdp</code>，可能这玩意和我风水不合吧，半天跑不起来。遂尝试了下<code>rdesktop</code>，秒连（也不知道为啥）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S rdesktop</span><br><span class="line">rdesktop 114.5.1.4</span><br></pre></td></tr></table></figure><p>然后输账号密码登陆就行了。因为暂时这样就够用所以就没咋折腾。</p><h2 id="X11迁移Wayland"><a href="#X11迁移Wayland" class="headerlink" title="X11迁移Wayland"></a>X11迁移Wayland</h2><p>主要动机：支持一下双屏不同缩放的功能，不然一个高分屏+一个普通1080p的组合太痛苦了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pacman -Qi wayland  <span class="comment"># 已安装则继续，否则安装</span></span><br><span class="line">sudo pacman -S --needed wayland</span><br><span class="line">yay -S sddm-git     <span class="comment"># 必须得是sddm-git，其他版本好像没完善的Wayland支持</span></span><br><span class="line">pacman -S --needed xorg-xwayland xorg-xlsclients qt5-wayland glfw-wayland</span><br><span class="line">pacman -S --needed plasma kde-applications</span><br><span class="line">pacman -S --needed plasma-wayland-session</span><br></pre></td></tr></table></figure><p>按照<a href="https://linux.cn/article-16171-1.html">这里</a>给出的流程，装完上面的包之后，Logout之后应该就能在左下角看到登陆<code>Plasma(Wayland)</code>的提示了。</p><blockquote><p>你还能通过查看 <code>$XDG_SESSION_TYPE</code> 变量来 核实你是否在运行 <code>Wayland</code>。</p></blockquote><p>先去装了，一会回来记录。</p><p>装完了，兼容性没啥大问题，我甚至没重启，只是重新登陆了下。就是<code>latte-dock</code>的图标缩放看着怪怪的，而且桌面小组件也乱飞了。以及，输入法好像不太对劲，在firefox以外的地方皮肤会丢失。</p><p>刚重新设置了下屏幕排列，现在能单独设置两块屏幕的缩放了，爽。就是高分屏看着有点糊，以及字体缩放问题，还有这个fcitx也不太对劲。</p><p>关于fcitx，系统给了一段报错：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Fcitx should be launched by KWin under KDE Wayland in order to use Wayland input method frontend. This can improve the experience when using Fcitx on Wayland. To configure this, you need to go to &quot;System Settings&quot; -&gt; &quot;Virtual keyboard&quot; and select &quot;Fcitx 5&quot; from it. You may also need to disable tools that launches input method, such as imsettings on Fedora, or im-config on Debian/Ubuntu. For more details see https://fcitx-im.org/wiki/Using_Fcitx_5_on_Wayland#KDE_Plasma </span><br></pre></td></tr></table></figure><p>先重启下看看吧。</p><p>草了，重启回来变回x11 seession了。找找默认值在哪保存着吧。</p><p>找到了，在<code>/usr/lib/sddm/sddm.conf.d/default.conf</code>里边，有一个<code>DisplayServer=x11</code>的项，把<code>x11</code>改为<code>wayland</code>应该就行了。重启看看。</p><p>好像不太行，而且现在切不过去Wayland了，坏。</p><p>把设置都改回去了，现在好像能进去了。但是还是默认进入x11的plasma桌面。</p><p>哎，把用户空间的那个sddm configuration改了一下，删了里边的[Autologin]底下的session&#x3D;的值，重启下试试。以及又得到了一段关于fcitx的建议：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Detect GTK_IM_MODULE and QT_IM_MODULE being set and Wayland Input method frontend is working. It is recommended to unset GTK_IM_MODULE and QT_IM_MODULE and use Wayland input method frontend instead. For more details see https://fcitx-im.org/wiki/Using_Fcitx_5_on_Wayland#KDE_Plasma</span><br></pre></td></tr></table></figure><p>好好好搞定了。按照上面的设置先屏蔽了俩环境变量，然后删除了默认值，现在系统已经处于完全可用的状态。回头有时间了整理整理过程。</p><blockquote><p>Fri 22 Dec 2023 05:14:55 PM CST</p></blockquote><p>编辑：这个选项不用在命令行里修改，直接去系统设置里边的<code>Startup nad shutdown-&gt;Login Screen-&gt;Behavior</code>里边修改<code>...with session = </code>的选项就行了。</p><h2 id="又出问题了"><a href="#又出问题了" class="headerlink" title="又出问题了"></a>又出问题了</h2><p>小笔记本上的arch的kde以至于其中的所有程序突然都变得特别卡。最奇怪的是这会的系统资源专用状况完全没有多高，CPU%，MEM37.4%的占用率应该很健康了吧。</p><p>觉得的卡顿是因为我发现就连tmux里边开个vim写文档都卡得不行了才觉得不对劲。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">systemd-+-NetworkManager</span><br><span class="line">        |-bluetoothd</span><br><span class="line">        |-clash</span><br><span class="line">        |-dbus-daemon</span><br><span class="line">        |-polkitd</span><br><span class="line">        |-rtkit-daemon</span><br><span class="line">        |-sddm-+-Xorg</span><br><span class="line">        |      `-sddm-helper---startplasma-x11</span><br><span class="line">        |-systemd-+-(sd-pam)</span><br><span class="line">        |         |-adb</span><br><span class="line">        |         |-agent</span><br><span class="line">        |         |-at-spi-bus-laun---dbus-daemon</span><br><span class="line">        |         |-at-spi2-registr</span><br><span class="line">        |         |-chrome_crashpad</span><br><span class="line">        |         |-dbus-daemon</span><br><span class="line">        |         |-dconf-service</span><br><span class="line">        |         |-fcitx5</span><br><span class="line">        |         |-gmenudbusmenupr</span><br><span class="line">        |         |-gvfs-udisks2-vo</span><br><span class="line">        |         |-gvfsd-+-gvfsd-dnssd</span><br><span class="line">        |         |       |-gvfsd-network</span><br><span class="line">        |         |       `-gvfsd-trash</span><br><span class="line">        |         |-gvfsd-fuse</span><br><span class="line">        |         |-gvfsd-metadata</span><br><span class="line">        |         |-kaccess</span><br><span class="line">        |         |-kactivitymanage</span><br><span class="line">        |         |-kded5</span><br><span class="line">        |         |-kglobalaccel5</span><br><span class="line">        |         |-konsole---bash---tmux: client</span><br><span class="line">        |         |-krunner---qq-+-qq---qq</span><br><span class="line">        |         |              |-qq---2*[qq]</span><br><span class="line">        |         |              `-qq</span><br><span class="line">        |         |-kscreen_backend</span><br><span class="line">        |         |-ksmserver---DiscoverNotifie</span><br><span class="line">        |         |-ksystemstats</span><br><span class="line">        |         |-kwalletd5</span><br><span class="line">        |         |-kwin_x11</span><br><span class="line">        |         |-latte-dock</span><br><span class="line">        |         |-linuxqq</span><br><span class="line">        |         |-obexd</span><br><span class="line">        |         |-org_kde_powerde</span><br><span class="line">        |         |-pipewire</span><br><span class="line">        |         |-pipewire-media-</span><br><span class="line">        |         |-plasmashell---crow</span><br><span class="line">        |         |-polkit-kde-auth</span><br><span class="line">        |         |-pulseaudio---gsettings-helpe</span><br><span class="line">        |         |-tmux: server-+-2*[bash---vim]</span><br><span class="line">        |         |              `-bash---sudo---sudo---pstree</span><br><span class="line">        |         |-2*[xdg-desktop-por]</span><br><span class="line">        |         |-xdg-document-po---fusermount3</span><br><span class="line">        |         |-xdg-permission-</span><br><span class="line">        |         `-xembedsniproxy</span><br><span class="line">        |-systemd-journal</span><br><span class="line">        |-systemd-logind</span><br><span class="line">        |-systemd-udevd</span><br><span class="line">        |-udisksd</span><br><span class="line">        |-upowerd</span><br><span class="line">        `-wpa_supplicant</span><br></pre></td></tr></table></figure><p>上面是<code>sudo pstree -T</code>的输出，感觉这种卡顿可能就是de内存溢出了。理论上我感觉只要重启一下sddm马上就能变流畅。但是在这之前我想知道更详细的信息。</p><p>先把qq关了试试。不出所料还是很卡。上google搜一下吧。</p><p>草了，看到一个哥们系统偶尔卡顿最后发现是SSD挂掉的前兆。想起来这个本子用的是三星的老固态，系统盘的文件系统是btrfs；前几天还看群里某群u吐槽说btrfs在他那边对于固态寿命损伤挺严重的。也不知道是不是btrfs的问题。不过好在重要数据都有备份，丢了也不心疼，全从服务器上sync下来就行了。</p><p>不过应该这次不是固态的问题，应该还是sddm本身的问题，不然很难解释怎么所有gui里边的东西都开始卡顿了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">TIME                           PID  UID  GID SIG     COREFILE EXE                           SIZE</span><br><span class="line">Sun 2023-10-29 23:52:21 CST   2030 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Thu 2023-11-02 13:07:56 CST   3084    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Thu 2023-11-02 17:15:49 CST  36261 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Thu 2023-11-02 23:44:53 CST   1795 1000 1000 SIGTRAP missing  /tmp/.mount_linuxqFrCYKS/qq      -</span><br><span class="line">Sat 2023-11-04 18:43:36 CST   1640 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Sat 2023-11-04 18:45:41 CST   2255    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Sat 2023-11-04 18:46:34 CST   2300    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Sun 2023-11-05 18:16:28 CST  19274 1000 1000 SIGABRT missing  /opt/vscodium-bin/codium         -</span><br><span class="line">Sun 2023-11-05 18:16:30 CST  19330 1000 1000 SIGABRT missing  /opt/vscodium-bin/codium         -</span><br><span class="line">Sun 2023-11-05 22:13:13 CST  14279 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Thu 2023-11-09 23:30:51 CST  14724 1000 1000 SIGTRAP missing  /qq                              -</span><br><span class="line">Thu 2023-11-09 23:38:16 CST  15804 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Fri 2023-11-10 01:08:53 CST  14773 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Tue 2023-11-14 09:04:45 CST   5996 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Tue 2023-11-14 09:47:58 CST  10033 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Tue 2023-11-14 10:15:41 CST  75599 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Tue 2023-11-14 10:30:25 CST  13990 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Tue 2023-11-14 17:47:23 CST    575 1000 1000 SIGABRT missing  /usr/bin/plasmashell             -</span><br><span class="line">Tue 2023-11-14 21:00:24 CST  18347 1000 1000 SIGABRT missing  /usr/bin/plasmashell             -</span><br><span class="line">Wed 2023-11-15 00:34:08 CST  26489 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Wed 2023-11-15 01:14:11 CST  28479 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Wed 2023-11-15 11:34:37 CST  19955 1000 1000 SIGSEGV missing  /usr/bin/plasmashell             -</span><br><span class="line">Wed 2023-11-15 23:54:02 CST  36282 1000 1000 SIGSEGV missing  /opt/visual-studio-code/code     -</span><br><span class="line">Fri 2023-11-17 00:45:55 CST  16467 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Fri 2023-11-17 00:45:56 CST  40168 1000 1000 SIGTRAP missing  /qq                              -</span><br><span class="line">Sat 2023-11-18 01:12:06 CST  17969 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:06 CST  15257 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:06 CST  17286 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:56 CST  19088 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:56 CST  19770 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:56 CST  18906 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:56 CST  19731 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:56 CST  19689 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:12:57 CST  19591 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:13:10 CST  25066 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:13:11 CST  25053 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:13:11 CST  20320 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:13:11 CST  24308 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:13:13 CST  25240 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:13:13 CST  25205 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 01:13:14 CST  25646 1000 1000 SIGABRT missing  /usr/bin/ccze                    -</span><br><span class="line">Sat 2023-11-18 22:14:12 CST    576 1000 1000 SIGABRT missing  /usr/bin/plasmashell             -</span><br><span class="line">Sat 2023-11-18 23:37:15 CST   2175 1000 1000 SIGABRT missing  /usr/bin/plasmashell             -</span><br><span class="line">Sun 2023-11-19 12:59:47 CST   4430    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Sun 2023-11-19 13:00:33 CST   4459    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Sun 2023-11-19 13:00:34 CST   4469    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Sun 2023-11-19 13:06:05 CST   5821    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Mon 2023-11-20 20:53:13 CST    588 1000 1000 SIGSEGV missing  /usr/bin/plasmashell             -</span><br><span class="line">Mon 2023-11-20 20:56:33 CST   6077 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Mon 2023-11-20 22:56:05 CST   5427 1000 1000 SIGABRT missing  /usr/bin/plasmashell             -</span><br><span class="line">Mon 2023-11-20 22:59:54 CST  18385    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Tue 2023-11-21 23:30:23 CST  12137 1000 1000 SIGBUS  missing  /qq                              -</span><br><span class="line">Tue 2023-11-21 23:30:25 CST  12093 1000 1000 SIGBUS  missing  /qq                              -</span><br><span class="line">Tue 2023-11-21 23:30:26 CST  17572 1000 1000 SIGBUS  missing  /qq                              -</span><br><span class="line">Tue 2023-11-21 23:30:26 CST  12015 1000 1000 SIGBUS  missing  /qq                              -</span><br><span class="line">Tue 2023-11-21 23:30:26 CST  12016 1000 1000 SIGBUS  missing  /qq                              -</span><br><span class="line">Tue 2023-11-21 23:30:27 CST  12459 1000 1000 SIGBUS  missing  /qq                              -</span><br><span class="line">Tue 2023-11-21 23:30:27 CST  12003 1000 1000 SIGBUS  missing  /qq                              -</span><br><span class="line">Tue 2023-11-21 23:30:28 CST  12043 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Fri 2023-11-24 00:01:53 CST  14600 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Sat 2023-11-25 02:40:58 CST  32138 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Tue 2023-11-28 23:33:11 CST  41077 1000 1000 SIGTRAP missing  /qq                              -</span><br><span class="line">Wed 2023-11-29 11:43:44 CST  43973 1000 1000 SIGABRT missing  /usr/bin/adb                     -</span><br><span class="line">Wed 2023-11-29 11:44:06 CST  45189 1000 1000 SIGABRT missing  /usr/bin/adb                     -</span><br><span class="line">Wed 2023-11-29 23:29:56 CST  53151 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Wed 2023-11-29 23:45:58 CST  55228 1000 1000 SIGSEGV missing  /opt/visual-studio-code/code     -</span><br><span class="line">Thu 2023-11-30 00:13:43 CST  42637 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Sat 2023-12-02 01:12:16 CST  56991 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Mon 2023-12-04 10:28:09 CST  77126 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Mon 2023-12-04 15:18:23 CST  99034    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Mon 2023-12-04 15:19:05 CST  99068    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Mon 2023-12-04 15:20:45 CST  99231    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Mon 2023-12-04 15:54:13 CST 104472 1000 1000 SIGSEGV missing  /home/xeonds/code/pizip/pi       -</span><br><span class="line">Mon 2023-12-04 15:54:45 CST 104495 1000 1000 SIGSEGV missing  /home/xeonds/code/pizip/pi       -</span><br><span class="line">Mon 2023-12-04 15:55:06 CST 104521 1000 1000 SIGSEGV missing  /home/xeonds/code/pizip/pi       -</span><br><span class="line">Mon 2023-12-04 15:55:36 CST 104541 1000 1000 SIGSEGV missing  /home/xeonds/code/pizip/pi       -</span><br><span class="line">Mon 2023-12-04 17:28:20 CST 104920 1000 1000 SIGBUS  missing  /chrome_crashpad_handler         -</span><br><span class="line">Mon 2023-12-04 23:36:35 CST 119295 1000 1000 SIGSEGV missing  /opt/visual-studio-code/code     -</span><br><span class="line">Wed 2023-12-06 11:18:53 CST  16426    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Mon 2023-12-11 19:56:40 CST  97572 1000 1000 SIGTRAP missing  /tmp/.mount_linuxqSV6RFp/qq      -</span><br><span class="line">Tue 2023-12-12 01:01:33 CST 123670 1000 1000 SIGTRAP missing  /opt/visual-studio-code/code     -</span><br><span class="line">Fri 2023-12-15 14:50:41 CST  17039 1000 1000 SIGTRAP missing  /tmp/.mount_linuxqkQn53G/qq      -</span><br><span class="line">Sat 2023-12-16 23:55:13 CST  19892 1000 1000 SIGTRAP missing  /opt/visual-studio-code/code     -</span><br><span class="line">Mon 2023-12-18 13:16:16 CST  28074    0    0 SIGABRT none     /usr/bin/fcitx5-remote           -</span><br><span class="line">Mon 2023-12-18 15:08:22 CST  41701 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Tue 2023-12-19 21:37:06 CST  17530 1000 1000 SIGFPE  missing  /home/xeonds/code/c4/a.out       -</span><br><span class="line">Tue 2023-12-19 23:39:47 CST  20684 1000 1000 SIGTRAP missing  /tmp/.mount_linuxqllS3Xz/qq      -</span><br><span class="line">Wed 2023-12-20 12:31:27 CST  23806 1000 1000 SIGABRT missing  /usr/bin/clashctl                -</span><br><span class="line">Sun 2023-12-24 19:26:26 CST   5873 1000 1000 SIGTRAP present  /qq                           1.6M</span><br><span class="line">Mon 2023-12-25 01:59:52 CST   5951 1000 1000 SIGBUS  present  /chrome_crashpad_handler     42.5K</span><br></pre></td></tr></table></figure><p>上面是<code>coredumpctl</code>的输出。好像sddm还没崩溃呢。再看看journal：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">Dec 24 02:28:08 ark-station-breeze systemd[1]: Started Simple Desktop Display Manager.</span><br><span class="line">░░ Subject: A start job <span class="keyword">for</span> unit sddm.service has finished successfully</span><br><span class="line">░░ Defined-By: systemd</span><br><span class="line">░░ Support: https://lists.freedesktop.org/mailman/listinfo/systemd-devel</span><br><span class="line">░░ </span><br><span class="line">░░ A start job <span class="keyword">for</span> unit sddm.service has finished successfully.</span><br><span class="line">░░ </span><br><span class="line">░░ The job identifier is 108.</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Initializing...</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Starting...</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Logind interface found</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Adding new display...</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Loaded empty theme configuration</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Xauthority path: <span class="string">&quot;/run/sddm/xauth_bDCTVn&quot;</span></span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Using VT 2</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Display server starting...</span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Writing cookie to <span class="string">&quot;/run/sddm/xauth_bDCTVn&quot;</span></span><br><span class="line">Dec 24 02:28:08 ark-station-breeze sddm[407]: Running: /usr/bin/X -dpi 120 -background none -seat seat0 vt2 -auth /run/sddm/xauth_bDCTVn -noreset -displayfd 16</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm[407]: Setting default cursor</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm[407]: Running display setup script  <span class="string">&quot;/usr/share/sddm/scripts/Xsetup&quot;</span></span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm[407]: Display server started.</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm[407]: Reading from <span class="string">&quot;/usr/local/share/xsessions/plasma.desktop&quot;</span></span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm[407]: Reading from <span class="string">&quot;/usr/share/xsessions/plasma.desktop&quot;</span></span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm[407]: Session <span class="string">&quot;/usr/share/xsessions/plasma.desktop&quot;</span> selected, <span class="built_in">command</span>: <span class="string">&quot;/usr/bin/startplasma-x11&quot;</span> <span class="keyword">for</span> VT 2</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: [PAM] Starting...</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: [PAM] Authenticating...</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: pam_kwallet5(sddm-autologin:auth): pam_kwallet5: pam_sm_authenticate</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: [PAM] Preparing to converse...</span><br><span class="line">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: pam_kwallet5(sddm-autologin:auth): pam_kwallet5: Couldn<span class="string">&#x27;t get password (it is empty)</span></span><br><span class="line"><span class="string">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: [PAM] Conversation with 1 messages</span></span><br><span class="line"><span class="string">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: pam_kwallet5(sddm-autologin:auth): pam_kwallet5: Empty or missing password, doing nothing</span></span><br><span class="line"><span class="string">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: [PAM] returning.</span></span><br><span class="line"><span class="string">Dec 24 02:28:09 ark-station-breeze sddm[407]: Authentication for user  &quot;xeonds&quot;  successful</span></span><br><span class="line"><span class="string">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: pam_kwallet5(sddm-autologin:setcred): pam_kwallet5: pam_sm_setcred</span></span><br><span class="line"><span class="string">Dec 24 02:28:09 ark-station-breeze sddm-helper[433]: pam_unix(sddm-autologin:session): session opened for user xeonds(uid=1000) by xeonds(uid=0)</span></span><br><span class="line"><span class="string">Dec 24 02:28:10 ark-station-breeze sddm-helper[433]: pam_kwallet5(sddm-autologin:session): pam_kwallet5: pam_sm_open_session</span></span><br><span class="line"><span class="string">Dec 24 02:28:10 ark-station-breeze sddm-helper[433]: pam_kwallet5(sddm-autologin:session): pam_kwallet5: open_session called without kwallet5_key</span></span><br><span class="line"><span class="string">Dec 24 02:28:10 ark-station-breeze sddm-helper[433]: Writing cookie to &quot;/tmp/xauth_XpVcsc&quot;</span></span><br><span class="line"><span class="string">Dec 24 02:28:10 ark-station-breeze sddm-helper[433]: Starting X11 session: &quot;&quot; &quot;/usr/share/sddm/scripts/Xsession \&quot;/usr/bin/startplasma-x11\&quot;&quot;</span></span><br><span class="line"><span class="string">Dec 24 02:28:10 ark-station-breeze sddm[407]: Session started true</span></span><br></pre></td></tr></table></figure><p>哦还有xorg的：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-- No entries --</span><br></pre></td></tr></table></figure><p>好吧空的。那看看top</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[?1h=[?25l[H[J[mtop - 15:10:25 up 1 day, 12:42,  1 user,  load average: 1.40, 1.33, 1.29[m[39;49m[m[39;49m[K</span><br><span class="line">任务:[m[39;49m[1m 204 [m[39;49mtotal,[m[39;49m[1m   3 [m[39;49mrunning,[m[39;49m[1m 201 [m[39;49msleeping,[m[39;49m[1m   0 [m[39;49mstopped,[m[39;49m[1m   0 [m[39;49mzombie[m[39;49m[m[39;49m[K</span><br><span class="line">%Cpu(s):[m[39;49m[1m 28.6 [m[39;49mus,[m[39;49m[1m  0.0 [m[39;49msy,[m[39;49m[1m  0.0 [m[39;49mni,[m[39;49m[1m 71.4 [m[39;49mid,[m[39;49m[1m  0.0 [m[39;49mwa,[m[39;49m[1m  0.0 [m[39;49mhi,[m[39;49m[1m  0.0 [m[39;49msi,[m[39;49m[1m  0.0 [m[39;49mst[m[39;49m[m [m[39;49m[m[39;49m[K</span><br><span class="line">MiB Mem :[m[39;49m[1m   7835.3 [m[39;49mtotal,[m[39;49m[1m    584.1 [m[39;49mfree,[m[39;49m[1m   3807.3 [m[39;49mused,[m[39;49m[1m   4760.9 [m[39;49mbuff/cache[m[39;49m[m [m[39;49m[m    [m[39;49m[m[39;49m[K</span><br><span class="line">MiB Swap:[m[39;49m[1m      0.0 [m[39;49mtotal,[m[39;49m[1m      0.0 [m[39;49mfree,[m[39;49m[1m      0.0 [m[39;49mused.[m[39;49m[1m   4028.0 [m[39;49mavail Mem [m[39;49m[m[39;49m[K</span><br><span class="line">[K</span><br><span class="line">[7m 进程号 USER      PR  NI    VIRT    RES    SHR    %CPU  %MEM     TIME+ COMMAND  [m[39;49m[K</span><br><span class="line">[m[1m    411 root      20   0  859280  87628  30916 R  90.9   1.1 248:56.68 Xorg     [m[39;49m[K</span><br><span class="line">[m[1m  19316 xeonds    20   0 4028616 892492 271492 R  72.7  11.1   0:17.50 firefox  [m[39;49m[K</span><br><span class="line">[m  19461 xeonds    20   0 2713128 171852  88252 S  18.2   2.1   0:06.27 WebExte+ [m[39;49m[K</span><br><span class="line">[m[1m  19901 xeonds    20   0   15440   5760   3584 R   9.1   0.1   0:00.01 top      [m[39;49m[K</span><br><span class="line">[m      1 root      20   0   22220  10228   7028 S   0.0   0.1   0:02.61 systemd  [m[39;49m[K</span><br><span class="line">[m      2 root      20   0       0      0      0 S   0.0   0.0   0:00.04 kthreadd [m[39;49m[K</span><br><span class="line">[m      3 root      20   0       0      0      0 S   0.0   0.0   0:00.00 pool_wo+ [m[39;49m[K</span><br><span class="line">[m      4 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker+ [m[39;49m[K</span><br><span class="line">[m      5 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker+ [m[39;49m[K</span><br><span class="line">[m      6 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker+ [m[39;49m[K</span><br><span class="line">[m      7 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker+ [m[39;49m[K</span><br><span class="line">[m      9 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker+ [m[39;49m[K</span><br><span class="line">[m     12 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker+ [m[39;49m[K</span><br><span class="line">[m     14 root      20   0       0      0      0 I   0.0   0.0   0:00.00 rcu_tas+ [m[39;49m[K</span><br><span class="line">[m     15 root      20   0       0      0      0 I   0.0   0.0   0:00.00 rcu_tas+ [m[39;49m[K</span><br><span class="line">[m     16 root      20   0       0      0      0 I   0.0   0.0   0:00.00 rcu_tas+ [m[39;49m[K</span><br><span class="line">[m     17 root      20   0       0      0      0 S   0.0   0.0   0:30.95 ksoftir+ [m[39;49m[K[?1l&gt;[25;1H</span><br><span class="line">[34h[?25h[K</span><br></pre></td></tr></table></figure><p>抽象是抽象了点，但是能看出来好像是Xorg在发电，试试去tty重启xorg看看。</p><p>最后发现Xorg是sddm启动的，没办法直接重启了下sddm，问题解决，但是最不爽的是不知道问题到底是咋解决的。</p><p>找到一个博客，发现好像不是xorg的问题，而是kwin的问题：暂停恢复合成时，会导致kwin卡顿，这时候重启一下kwin_x11就行了。</p><p>这就好说了：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl --user restart plasma-kwin_x11</span><br></pre></td></tr></table></figure><p>或者这个</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setsid kwin_x11 --replace &amp;</span><br></pre></td></tr></table></figure><blockquote><p>ref:<a href="https://www.glowmem.com/archives/archlinux-note#toc-head-7">律回彼境</a></p></blockquote><p>试了试，问题完美解决，CPU占用也正常了。</p><p> 参考：<a href="https://blog.mynook.info/post/kde-gui-sluggish-workaround/">KDE解决GUI界面卡顿的问题</a></p><h2 id="组合键"><a href="#组合键" class="headerlink" title="组合键"></a>组合键</h2><p>其实主要是KDE Plasma的相关组合键。偶尔会意外发现一些组合键，就记录在这里了。</p><ul><li>切换桌面：<code>ctrl+F*</code></li><li>无极缩放：<code>win+ctrl</code>+鼠标滚轮，真的好丝滑QAQ</li></ul><h2 id="莫得休眠Hibernate选项"><a href="#莫得休眠Hibernate选项" class="headerlink" title="莫得休眠Hibernate选项"></a>莫得休眠Hibernate选项</h2><p>找了半天发现是系统安装的时候没设置swap交换分区。不过暂时默认的睡眠也够用了，之后再考虑吧。</p><h2 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h2><blockquote><p>ref:<a href="https://sspai.com/post/78916">现代化的 Archlinux 安装，Btrfs、快照、休眠以及更多。</a></p></blockquote><p>其一就是软件列表备份。<code>pacman -Qe &gt;&gt; installed.txt</code>就可以备份已安装软件列表</p><p>其二就是备份根目录数据。其中的<code>-avrh</code>用于保留文件权限。以及似乎必须得注意路径末尾的斜杠问题，rsync好像会区分这两个路径。<code>sudo rsync -avrh --progress /home/ /mnt/backup/</code></p><h2 id="关机等待时间"><a href="#关机等待时间" class="headerlink" title="关机等待时间"></a>关机等待时间</h2><p>一直忘了改这个东西了。有时候等待一些服务停止的时候等到倒计时结束才会停止。可以适当减少倒计时的时长环节这个问题。</p><p>对应的参数在<code>/etc/systemd/system.conf</code>，更改<code>DefaultTimeoutStopSec=90s</code>为你想要的等待时间，我改成10s了。</p><h2 id="记一次内核卡死"><a href="#记一次内核卡死" class="headerlink" title="记一次内核卡死"></a>记一次内核卡死</h2><p>挺草的说起来。征兆是先是firefox崩了，然后把kwin也爆了。第二次是kwin自己爆炸了，然后玩mc java的时候就OOM+CPU 100%了。问了下群里老哥，发现没开SysRq，不然的话就能在内核卡死的时候使用一些组合键来让内核执行一些有限操作。</p><p>等待了大概40min，无果，只能以&gt;2min的不规律时间响应键盘中断，老哥推测可能是活锁，而且OOM也没来得及出动。所以就含泪重启，跟自己tmux里边一堆窗口告别了。</p><p>重启，看看内核日志：<code>sudo journalctl -k -b-1</code>查看上次启动的日志：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line">Jan 16 10:43:33 ark-station kernel: Bluetooth: hci0: Malformed MSFT vendor event: 0x02</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: Bluetooth: hci0: Found Intel DDC parameters: intel/ibt-0040-4150.ddc</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: Bluetooth: hci0: Applying Intel DDC parameters completed</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: Bluetooth: hci0: Firmware timestamp 2023.42 buildtype 1 build 73111</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: Microcode SW error detected. Restarting 0x0.</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: Start IWL Error Log Dump:</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: Transport status: 0x0000004A, valid: 6</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: Loaded firmware version: 83.e8f84e98.0 so-a0-hr-b0-83.ucode</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000071 | NMI_INTERRUPT_UMAC_FATAL    </span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x000002F0 | trm_hw_status0</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | trm_hw_status1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x004D9024 | branchlink2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x004CF2F2 | interruptlink1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x004CF2F2 | interruptlink2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00015346 | data1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000010 | data2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | data3</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x0022F89E | beacon time</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x001E1C6F | tsf low</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | tsf hi</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | time gp1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x001ED6DD | time gp2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000001 | uCode revision type</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000053 | uCode version major</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0xE8F84E98 | uCode version minor</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000370 | hw version</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00C80002 | board version</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x80DDFC04 | hcmd</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00020000 | isr0</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | isr1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x48F00002 | isr2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00C3000C | isr3</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | isr4</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x001C0103 | last cmd Id</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00015346 | wait_event</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000010 | l2p_control</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000020 | l2p_duration</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x0000003F | l2p_mhvalid</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | l2p_addr_match</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000009 | lmpm_pmg_sel</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | timestamp</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00004870 | flow_handler</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: Start IWL Error Log Dump:</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: Transport status: 0x0000004A, valid: 7</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x2010190E | ADVANCED_SYSASSERT</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | umac branchlink1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x804703E0 | umac branchlink2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0xC0081500 | umac interruptlink1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | umac interruptlink2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x0101971C | umac data1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0xDEADBEEF | umac data2</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0xDEADBEEF | umac data3</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000053 | umac major</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0xE8F84E98 | umac minor</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x001ED6D7 | frame pointer</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0xC0886BE0 | stack pointer</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x0024010D | last host cmd</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000000 | isr status reg</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: IML/ROM dump:</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000B03 | IML/ROM error/state</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x0000518C | IML/ROM data1</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000090 | IML/ROM WFPM_AUTH_KEY_0</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: Fseq Registers:</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x60000000 | FSEQ_ERROR_CODE</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00350002 | FSEQ_TOP_INIT_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00150001 | FSEQ_CNVIO_INIT_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x0000A482 | FSEQ_OTP_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00000003 | FSEQ_TOP_CONTENT_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x4552414E | FSEQ_ALIVE_TOKEN</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00080400 | FSEQ_CNVI_ID</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x01300504 | FSEQ_CNVR_ID</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00080400 | CNVI_AUX_MISC_CHIP</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x01300504 | CNVR_AUX_MISC_CHIP</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x05B0905B | CNVR_SCU_SD_REGS_SD_REG_DIG_DCDC_VTRIM</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x0000025B | CNVR_SCU_SD_REGS_SD_REG_ACTIVE_VDIG_MIRROR</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00150001 | FSEQ_PREV_CNVIO_INIT_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00350002 | FSEQ_WIFI_FSEQ_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x00350002 | FSEQ_BT_FSEQ_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: 0x000000DC | FSEQ_CLASS_TP_VERSION</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: UMAC CURRENT PC: 0x8048f214</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: LMAC1 CURRENT PC: 0xd0</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: iwlwifi 0000:00:14.3: WRT: Collecting data: ini trigger 4 fired (delay=0ms).</span><br><span class="line">Jan 16 10:43:33 ark-station kernel: ieee80211 phy0: Hardware restart was requested</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: iwlwifi 0000:00:14.3: WRT: Invalid buffer destination</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: Bluetooth: MGMT ver 1.22</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: Bluetooth: hci0: Bad flag given (0x1) vs supported (0x0)</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: iwlwifi 0000:00:14.3: WFPM_UMAC_PD_NOTIFICATION: 0x20</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: iwlwifi 0000:00:14.3: WFPM_LMAC2_PD_NOTIFICATION: 0x1f</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: iwlwifi 0000:00:14.3: WFPM_AUTH_KEY_0: 0x90</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: iwlwifi 0000:00:14.3: CNVI_SCU_SEQ_DATA_DW9: 0x10</span><br><span class="line">Jan 16 10:43:34 ark-station kernel: iwlwifi 0000:00:14.3: RFIm is deactivated, reason = 5</span><br><span class="line">Jan 16 10:43:38 ark-station kernel: wlan0: authenticate with e2:cb:4f:01:72:a7</span><br><span class="line">Jan 16 10:43:38 ark-station kernel: wlan0: send auth to e2:cb:4f:01:72:a7 (try 1/3)</span><br><span class="line">Jan 16 10:43:38 ark-station kernel: wlan0: authenticated</span><br><span class="line">Jan 16 10:43:38 ark-station kernel: wlan0: associate with e2:cb:4f:01:72:a7 (try 1/3)</span><br><span class="line">Jan 16 10:43:38 ark-station kernel: wlan0: RX AssocResp from e2:cb:4f:01:72:a7 (capab=0x1511 status=0 aid=1)</span><br><span class="line">Jan 16 10:43:38 ark-station kernel: wlan0: associated</span><br><span class="line">Jan 16 10:47:20 ark-station kernel: kwin_wayland[901]: segfault at 0 ip 0000561fd234c33f sp 00007fff916f35c0 error 4 in kwin_wayland[561fd2348000+110000] likely on CPU 13 (core 25, socket 0)</span><br><span class="line">Jan 16 10:47:20 ark-station kernel: Code: 8b 47 58 48 8b 58 10 48 01 c3 48 63 40 04 4c 8d 24 c3 49 39 dc 75 0d eb 2a 66 90 48 83 c3 08 49 39 dc 74 1f 48 8b 3b 48 89 ee &lt;48&gt; 8b 07 ff 50 60 84 c0 74 e7 48 83 c4 08 5b 5d 41 5c 41 5d c3 0f</span><br><span class="line">Jan 16 10:49:41 ark-station systemd-fstab-generator[2389003]: Failed to create unit file &#x27;/run/systemd/generator/-.mount&#x27;, as it already exists. Duplicate entry in &#x27;/etc/fstab&#x27;?</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: deauthenticating from e2:cb:4f:01:72:a7 by local choice (Reason: 3=DEAUTH_LEAVING)</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: authenticate with f0:9b:b8:16:62:30</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: 80 MHz not supported, disabling VHT</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: send auth to f0:9b:b8:16:62:30 (try 1/3)</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: authenticated</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: associate with f0:9b:b8:16:62:30 (try 1/3)</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: RX AssocResp from f0:9b:b8:16:62:30 (capab=0x1421 status=0 aid=2)</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: associated</span><br><span class="line">Jan 16 11:15:18 ark-station kernel: wlan0: Limiting TX power to 20 (20 - 0) dBm as advertised by f0:9b:b8:16:62:30</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: disconnect from AP f0:9b:b8:16:62:30 for new auth to f0:9b:b8:16:62:40</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: authenticate with f0:9b:b8:16:62:40</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: send auth to f0:9b:b8:16:62:40 (try 1/3)</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: authenticated</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: associate with f0:9b:b8:16:62:40 (try 1/3)</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: RX ReassocResp from f0:9b:b8:16:62:40 (capab=0x1501 status=0 aid=4)</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: associated</span><br><span class="line">Jan 16 11:21:36 ark-station kernel: wlan0: Limiting TX power to 30 (30 - 0) dBm as advertised by f0:9b:b8:16:62:40</span><br><span class="line">Jan 16 11:22:44 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* Atomic update failure on pipe A (start=282494 end=282495) time 187 us, min 1579, max 1599, scanline start 1564, end 1602</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: disconnect from AP f0:9b:b8:16:62:40 for new auth to f0:9b:b8:16:5c:40</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: authenticate with f0:9b:b8:16:5c:40</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: send auth to f0:9b:b8:16:5c:40 (try 1/3)</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: authenticated</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: associate with f0:9b:b8:16:5c:40 (try 1/3)</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: RX ReassocResp from f0:9b:b8:16:5c:40 (capab=0x1501 status=0 aid=2)</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: associated</span><br><span class="line">Jan 16 11:41:50 ark-station kernel: wlan0: Limiting TX power to 23 (23 - 0) dBm as advertised by f0:9b:b8:16:5c:40</span><br><span class="line">Jan 16 18:00:05 ark-station kernel: wlan0: deauthenticating from f0:9b:b8:16:5c:40 by local choice (Reason: 3=DEAUTH_LEAVING)</span><br><span class="line">Jan 16 18:00:05 ark-station kernel: wlan0: authenticate with e2:cb:4f:01:72:a7</span><br><span class="line">Jan 16 18:00:05 ark-station kernel: wlan0: send auth to e2:cb:4f:01:72:a7 (try 1/3)</span><br><span class="line">Jan 16 18:00:05 ark-station kernel: wlan0: authenticated</span><br><span class="line">Jan 16 18:00:05 ark-station kernel: wlan0: associate with e2:cb:4f:01:72:a7 (try 1/3)</span><br><span class="line">Jan 16 18:00:05 ark-station kernel: wlan0: RX AssocResp from e2:cb:4f:01:72:a7 (capab=0x1511 status=0 aid=3)</span><br><span class="line">Jan 16 18:00:05 ark-station kernel: wlan0: associated</span><br><span class="line">Jan 16 18:41:38 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* Atomic update failure on pipe A (start=2487239 end=2487240) time 230 us, min 1579, max 1599, scanline start 1566, end 1613</span><br><span class="line">Jan 16 19:34:40 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* Atomic update failure on pipe A (start=2869004 end=2869005) time 158 us, min 1579, max 1599, scanline start 1570, end 1602</span><br><span class="line">Jan 16 20:01:05 ark-station kernel: atkbd serio0: Unknown key pressed (translated set 2, code 0x8b on isa0060/serio0).</span><br><span class="line">Jan 16 20:01:05 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00b &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:01:05 ark-station kernel: atkbd serio0: Unknown key released (translated set 2, code 0x8b on isa0060/serio0).</span><br><span class="line">Jan 16 20:01:05 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00b &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:01:07 ark-station kernel: atkbd serio0: Unknown key pressed (translated set 2, code 0x8a on isa0060/serio0).</span><br><span class="line">Jan 16 20:01:07 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00a &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:01:07 ark-station kernel: atkbd serio0: Unknown key released (translated set 2, code 0x8a on isa0060/serio0).</span><br><span class="line">Jan 16 20:01:07 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00a &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:02:39 ark-station kernel: atkbd serio0: Unknown key pressed (translated set 2, code 0x8b on isa0060/serio0).</span><br><span class="line">Jan 16 20:02:39 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00b &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:02:39 ark-station kernel: atkbd serio0: Unknown key released (translated set 2, code 0x8b on isa0060/serio0).</span><br><span class="line">Jan 16 20:02:39 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00b &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:02:51 ark-station kernel: atkbd serio0: Unknown key pressed (translated set 2, code 0x8a on isa0060/serio0).</span><br><span class="line">Jan 16 20:02:51 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00a &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:02:51 ark-station kernel: atkbd serio0: Unknown key released (translated set 2, code 0x8a on isa0060/serio0).</span><br><span class="line">Jan 16 20:02:51 ark-station kernel: atkbd serio0: Use &#x27;setkeycodes e00a &lt;keycode&gt;&#x27; to make it known.</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* GT0: GUC: Engine reset failed on 0:0 (rcs0) because 0x00000000</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] GPU HANG: ecode 12:1:84dffffb, in Render thread [3009924]</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] Resetting chip for GuC failed to reset engine mask=0x1</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* rcs0 reset request timed out: &#123;request: 00000001, RESET_CTL: 00000001&#125;</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* rcs0 reset request timed out: &#123;request: 00000001, RESET_CTL: 00000001&#125;</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] Render thread[3009924] context reset due to GPU hang</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] GT0: GuC firmware i915/adlp_guc_70.bin version 70.13.1</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] GT0: HuC firmware i915/tgl_huc.bin version 7.9.3</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] GT0: HuC: authenticated for all workloads</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] GT0: GUC: submission enabled</span><br><span class="line">Jan 16 20:18:46 ark-station kernel: i915 0000:00:02.0: [drm] GT0: GUC: SLPC enabled</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* GT0: GUC: Engine reset failed on 0:0 (rcs0) because 0x00000000</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] GPU HANG: ecode 12:1:84dffffb, in Render thread [3009924]</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] Resetting chip for GuC failed to reset engine mask=0x1</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* rcs0 reset request timed out: &#123;request: 00000001, RESET_CTL: 00000001&#125;</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] *ERROR* rcs0 reset request timed out: &#123;request: 00000001, RESET_CTL: 00000001&#125;</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] Render thread[3009924] context reset due to GPU hang</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] GT0: GuC firmware i915/adlp_guc_70.bin version 70.13.1</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] GT0: HuC firmware i915/tgl_huc.bin version 7.9.3</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] GT0: HuC: authenticated for all workloads</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] GT0: GUC: submission enabled</span><br><span class="line">Jan 16 20:45:01 ark-station kernel: i915 0000:00:02.0: [drm] GT0: GUC: SLPC enabled</span><br><span class="line">Jan 16 20:49:08 ark-station kernel: INFO: task IPC Launch:2387456 blocked for more than 122 seconds.</span><br><span class="line">Jan 16 20:49:16 ark-station kernel:       Not tainted 6.6.10-arch1-1 #1</span><br><span class="line">Jan 16 20:49:27 ark-station kernel: &quot;echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs&quot; disables this message.</span><br><span class="line">Jan 16 20:49:32 ark-station kernel: task:IPC Launch      state:D stack:0     pid:2387456 ppid:870    flags:0x00004002</span><br><span class="line">Jan 16 20:49:38 ark-station kernel: Call Trace:</span><br><span class="line">Jan 16 20:49:48 ark-station kernel:  &lt;TASK&gt;</span><br><span class="line">Jan 16 20:50:00 ark-station kernel:  __schedule+0x3e7/0x1410</span><br><span class="line">Jan 16 20:50:16 ark-station kernel:  schedule+0x5e/0xd0</span><br><span class="line">Jan 16 20:50:28 ark-station kernel:  schedule_preempt_disabled+0x15/0x30</span><br><span class="line">Jan 16 20:50:36 ark-station kernel:  rwsem_down_write_slowpath+0x203/0x690</span><br><span class="line">Jan 16 20:50:43 ark-station kernel:  ? prealloc_shrinker+0x6a/0xd0</span><br><span class="line">Jan 16 20:50:51 ark-station kernel:  ? __pfx_set_anon_super_fc+0x10/0x10</span><br><span class="line">Jan 16 20:50:57 ark-station kernel:  down_write+0x5b/0x60</span><br><span class="line">Jan 16 20:51:04 ark-station kernel:  __prealloc_shrinker+0x70/0x350</span><br><span class="line">Jan 16 20:51:11 ark-station kernel:  ? kvasprintf+0x82/0xd0</span><br><span class="line">Jan 16 20:51:17 ark-station kernel:  ? __pfx_set_anon_super_fc+0x10/0x10</span><br><span class="line">Jan 16 20:51:23 ark-station kernel:  prealloc_shrinker+0x7b/0xd0</span><br><span class="line">Jan 16 20:51:28 ark-station kernel:  alloc_super+0x272/0x2e0</span><br><span class="line">Jan 16 20:51:35 ark-station kernel:  sget_fc+0x63/0x330</span><br><span class="line">Jan 16 20:51:41 ark-station kernel:  ? __pfx_mqueue_fill_super+0x10/0x10</span><br><span class="line">Jan 16 20:51:55 ark-station kernel:  get_tree_nodev+0x27/0x90</span><br><span class="line">Jan 16 20:52:02 ark-station kernel:  vfs_get_tree+0x26/0xf0</span><br><span class="line">Jan 16 20:52:07 ark-station kernel:  ? refcount_dec_and_lock+0x11/0x70</span><br><span class="line">Jan 16 20:52:12 ark-station kernel:  fc_mount+0x12/0x40</span><br><span class="line">Jan 16 20:52:17 ark-station kernel:  mq_init_ns+0x10f/0x1b0</span><br><span class="line">Jan 16 20:52:21 ark-station kernel:  copy_ipcs+0x134/0x270</span><br><span class="line">Jan 16 20:52:26 ark-station kernel:  create_new_namespaces+0xa1/0x2e0</span><br></pre></td></tr></table></figure><p>看了一圈最后找到个issue，看样子我应该是drm&#x2F;i195受害者咯。</p><h3 id="SysRq-Keyboard-Shortcuts"><a href="#SysRq-Keyboard-Shortcuts" class="headerlink" title="SysRq: Keyboard Shortcuts"></a>SysRq: Keyboard Shortcuts</h3><blockquote><p>systemd has the SysRq permissions bitmask set to 0x10 by default, which does not allow process signalling or rebooting, among other things. To allow full use of the SysRq key on your system, add kernel.sysrq &#x3D; 1 to your sysctl configuration. Values greater than 1 can be used to selectively enable SysRq functions; see the Linux kernel documentation for details. If you want to make sure it will be enabled even before the partitions are mounted and in the initrd, then add sysrq_always_enabled&#x3D;1 to your kernel parameters.</p><p>Note that changing the setting through these methods will cause the changes to persist across reboots. If you want to try changing the SysRq settings for just your current session, you can run either sysctl kernel.sysrq&#x3D;1 or echo “1” &gt; &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;sysrq.</p><p>There are some obvious security risks involved in fully enabling the SysRq key. In addition to forcing reboots and the like, it can be used to dump the contents of the CPU registers, which could theoretically reveal sensitive information. Since using it requires physical access to the system (unless you go out of your way), most desktop users will probably consider the level of risk acceptable. That said, make sure you fully understand the implications of enabling it and the dynamics of the larger context in which your system is operating before you turn SysRq all the way on. </p></blockquote><p>上边是<a href="https://wiki.archlinux.org/title/keyboard_shortcuts">arch wiki</a>的资料链接，可以参考下开开这玩意。这玩意的快捷键可以这么记：<em>Reboot Even If System Utterly Broken</em>。用法就是<code>Alt+SysRq+这六个单词首字母缩写</code>，功能分别是</p><ul><li><code>Unraw</code>：切换键盘输入到ASCII模式，</li><li><code>Terminate</code>：给所有进程发送<code>SIGTERM</code>，</li><li><code>Kill</code>：发送<code>SIGKILL</code>给所有进程，</li><li><code>Sync</code>：写入数据到磁盘，</li><li><code>Unmount</code>：卸载然后挂载所有文件系统为只读模式，</li><li><code>Reboot</code>：重启。</li></ul><p>另外还可以用<code>f</code>来触发<code>OOM Killer</code>。</p><h2 id="开机时间优化"><a href="#开机时间优化" class="headerlink" title="开机时间优化"></a>开机时间优化</h2><blockquote><p>ref: <a href="https://www.glowmem.com/archives/archlinux-note#toc-head-7">律回彼境</a></p></blockquote><p>使用<code>sudo systemd-analyze blame</code>可以查看系统开机时间详情。</p><p>自动mount分区（也就是直接在<code>/etc/fstab</code>里边进行配置）会导致启动时间增大，所以更推荐写成一个脚本，在用户登录后自动执行挂载。脚本放置在 ~&#x2F;.config&#x2F;autostart&#x2F; 即可在用户登录后执行。</p><h2 id="又被Firefox爆了"><a href="#又被Firefox爆了" class="headerlink" title="又被Firefox爆了"></a>又被Firefox爆了</h2><blockquote><p>虽然后来看日志发现是Firefox被kwin爆了</p></blockquote><p>这几天频繁出现桌面所有进程炸掉的情况，恢复后Firefox的Crash Report自己会跳出来。。不知道为啥，但是根据群u从<code>about:crashes</code>里边提交的崩溃报告来看，应该是kwin把Firefox爆了。</p><p>根据老哥的建议，关闭了系统的自适应同步（Adaptive Sync）选项，按照他的惊叹，问题可能会少一些。</p><h2 id="传文件的姿势"><a href="#传文件的姿势" class="headerlink" title="传文件的姿势"></a>传文件的姿势</h2><blockquote><p>什么姿势，还真没见过<br>-转自archlinux-cn-依云</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar C -c ~tmp/makepkg/wayfire-lily-git/src/build/src wayfire | ssh root@kvm-archkde tar xvU -C /usr/bin/</span><br></pre></td></tr></table></figure><h2 id="文件系统迁移"><a href="#文件系统迁移" class="headerlink" title="文件系统迁移"></a>文件系统迁移</h2><blockquote><p>有条件的话，建议还是全新安装最好。</p></blockquote><p>Reference:</p><ul><li><a href="https://zhuanlan.zhihu.com/p/512761420">如何将你的文件系统转换为 Btrfs | Linux 中国</a></li><li><a href="https://github.com/BarryWanghyw/Linux_Personal_Note/blob/master/Linux%E7%B3%BB%E7%BB%9F%E4%B9%8Brsync%20%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%98%E5%8E%9F.md">Linux_Personal_Note&#x2F;Linux系统之rsync 备份与还原 - github.com</a></li><li><a href="http://blog.imlk.top/posts/migrating-to-btrfs/">从ext4迁移到btrfs - imlk’s blog</a></li><li><a href="https://superuser.com/questions/524186/grub-broken-after-conversion-to-btrfs">GRUB broken after conversion to btrfs - Superuser.com</a></li><li><a href="https://forum.manjaro.org/t/boot-on-btrfs-subvolume-error-mount-new-root-unknown-filesystem-type-btrfs/152116">Boot on btrfs subvolume error: “mount: &#x2F;new_root: unknown filesystem type ‘btrfs’ ”</a></li></ul><p>参考了几个博客，跟着感觉走最后总算是有惊无险整好了。</p><p>本来是想用<code>btrfs-convert</code>给直接原地转换的，但是奈何superblock大小太小，转换失败。没办法，自己动手丰衣足食。</p><p>首先先是把原来的系统备份好：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/nvme0n1p5 of=/path/to/another/disk/backup.img bs=4M status=progress</span><br></pre></td></tr></table></figure><p>有备份了，开整。</p><p>发现手边没有U盘，但是有个root的手机。于是就用DriveDroid+一个Arch的LiveISO让它发挥余热了。</p><p>启动挺顺利，记得把ArchISO挂载为只读USB存储设备。进去之后<strong>确保确实备份了之后格式化设备</strong>（一定要多确认几遍，）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs.btrfs -L arch-driver /dev/nvme0n1p5    <span class="comment"># 这里务必多确认几遍</span></span><br></pre></td></tr></table></figure><p>然后创建子卷，布局我用的适合<code>timeshift</code>的默认方案：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mount -t btrfs -o compress=zstd /dev/nvme0n1p5 /mnt</span><br><span class="line">btrfs subvolume create /mnt/@ <span class="comment"># 创建 / 目录子卷</span></span><br><span class="line">btrfs subvolume create /mnt/@home <span class="comment"># 创建 /home 目录子卷</span></span><br><span class="line">umount /mnt</span><br><span class="line"></span><br><span class="line">mount -t btrfs -o subvol=/@,compress=zstd /dev/nvme0n1p5 /mnt</span><br><span class="line"><span class="built_in">mkdir</span> /mnt/home</span><br><span class="line">mount -t btrfs -o subvol=/@home,compress=zstd /dev/nvme0n1p5 /mnt/home</span><br><span class="line"><span class="built_in">mkdir</span> -p /mnt/boot</span><br><span class="line">mount /dev/nvme0n1p2 /mnt/boot</span><br></pre></td></tr></table></figure><p>创建完成之后，准备迁移数据：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> ~/old-fs</span><br><span class="line">monut /path/to/your/backup/backup.img ~/old-fs</span><br><span class="line">rsync -av ~/old-fs/home/ /mnt/home/</span><br><span class="line">rsync -av --exclude=&#123;<span class="string">&quot;/proc&quot;</span>,<span class="string">&quot;/dev&quot;</span>&#125; ~/old-fs/ /mnt/</span><br></pre></td></tr></table></figure><p>等复制完成之后，就可以着手修复系统引导了。这里先用<code>iwctl</code>连上网。之后就该开始修复GRUB了：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">genfstab -U /mnt &gt; /mnt/etc/fstab</span><br><span class="line"><span class="comment"># 此时手动检查下结果是否正确</span></span><br><span class="line"><span class="comment"># 可以cat /mnt/etc/fstab看看</span></span><br><span class="line">arch-chroot /mnt</span><br><span class="line">pacman -S grub-btrfs    <span class="comment"># 安装支持btrfs版本的GRUB</span></span><br><span class="line">grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=ARCH</span><br><span class="line">sed -i <span class="string">&#x27;s/loglevel=3 quiet/loglevel=5 nowatchdog/g&#x27;</span> /etc/default/grub</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;GRUB_DISABLE_OS_PROBER=false&quot;</span> &gt;&gt; /etc/default/grub</span><br></pre></td></tr></table></figure><p>然后理论上就OK了。此时<code>ctrl+d</code>退出<code>chroot</code>然后<code>umount -R /mnt &amp;&amp; reboot</code>，重启，进入新系统看看吧。</p><p>反正解决完一堆问题，成功进系统之后，我惊悚地发现，磁盘可用空间从8G变成了30G<del>而且<code>btrfs balance /</code>之后还又多出来1G</del>。根据rx所说，btrfs对于文本的压缩效果特别好。那指不定是给我一堆<code>node_modules</code>压缩干净了？</p><p>谁知道，大概是透明压缩确实顶吧。经过测试，timeshift和其他的btrfs特性都能正常使用。</p>]]></content>
    
    
    <summary type="html">Btw I use arch.jpg</summary>
    
    
    
    
    <category term="Linux" scheme="https://mxts.jiujiuer.xyz/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Linux误删文件恢复</title>
    <link href="https://mxts.jiujiuer.xyz/2023/08/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/linux-undelete/"/>
    <id>https://mxts.jiujiuer.xyz/2023/08/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/linux-undelete/</id>
    <published>2023-08-29T18:52:00.000Z</published>
    <updated>2024-06-04T16:42:26.934Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>删了私有云上几百个文件，不过好在最后发现只是删除了数据库里边的记录。万幸万幸。</p></blockquote><p>注意，<strong>下面的操作只适用于删文件的进程已经挂了的情况，请根据自己情况选择合适的方法</strong>。</p><h2 id="首先要做的"><a href="#首先要做的" class="headerlink" title="首先要做的"></a>首先要做的</h2><p>赶紧杀掉所有进程，防止数据写入到磁盘覆盖<code>inode</code>，如果被覆盖基本就凉了。比如说，停止当前分区的服务，赶紧卸载当前分区设备，甚至直接断网都是有必要的。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">unmount /dev/sda1</span><br><span class="line"><span class="comment"># 如果设备忙的话，用下面的命令强制卸载</span></span><br><span class="line">fuser -m -v -i -k /dir</span><br></pre></td></tr></table></figure><p>然后用<code>dd</code>备份分区，防止恢复失败。比如可以用下面的指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/sda1 of=/tmp/sda1.img</span><br></pre></td></tr></table></figure><h2 id="工具准备"><a href="#工具准备" class="headerlink" title="工具准备"></a>工具准备</h2><p>根据分区类型使用<code>extundelete</code>或者<code>ntfsundelete</code>。后者直接安装<code>ntfs-3g</code>即可，前者使用apt安装<code>extundelete</code>。</p><h2 id="恢复"><a href="#恢复" class="headerlink" title="恢复"></a>恢复</h2><p><a href="https://manpages.ubuntu.com/manpages/focal/en/man8/ntfsundelete.8.html">官方文档</a></p><p>如果是ntfs分区的话，用这个命令得到文件列表：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这个-f是因为我懒得卸载卷了</span></span><br><span class="line"><span class="comment"># 正常情况下还是先unmount了再操作，比较安全</span></span><br><span class="line"><span class="comment"># 这样就不用加-f了</span></span><br><span class="line">sudo ntfsundelete -s /dev/sdc2 -f &gt; rec-list.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者还有下面这些指令</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Look for deleted files on /dev/hda1.</span></span><br><span class="line">ntfsundelete /dev/hda1</span><br><span class="line"></span><br><span class="line"><span class="comment"># Look for deleted documents on /dev/hda1.</span></span><br><span class="line">ntfsundelete /dev/hda1 -s -m <span class="string">&#x27;*.doc&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Look for deleted files between 5000 and 6000000 bytes, with  at  least  90%  of  the  data</span></span><br><span class="line"><span class="comment"># recoverable, on /dev/hda1.</span></span><br><span class="line">ntfsundelete /dev/hda1 -S 5k-6m -p 90</span><br><span class="line"></span><br><span class="line"><span class="comment"># Look for deleted files altered in the last two days</span></span><br><span class="line">ntfsundelete /dev/hda1 -t 2d</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>然后可以按删除日期来筛查文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> rec-list.txt | grep 2023-08-30 &gt; res-filtered.txt</span><br></pre></td></tr></table></figure><p>最后恢复文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Undelete inodes 2, 5 and 100 to 131 of device /dev/sda1</span></span><br><span class="line">ntfsundelete /dev/sda1 -u -i 2,5,100-131</span><br><span class="line"></span><br><span class="line"><span class="comment"># Undelete  inode number 3689, call the file &#x27;work.doc&#x27;, set it to recovered size and put it</span></span><br><span class="line"><span class="comment"># in the user&#x27;s home directory.</span></span><br><span class="line">ntfsundelete /dev/hda1 -u -T -i 3689 -o work.doc -d ~</span><br><span class="line"></span><br><span class="line"><span class="comment"># Save MFT Records 3689 to 3690 to a file &#x27;debug&#x27;</span></span><br><span class="line">ntfsundelete /dev/hda1 -c 3689-3690 -o debug</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">希望人没事.jpg</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>ChatGLM部署手记</title>
    <link href="https://mxts.jiujiuer.xyz/2023/08/22/ChatGLM%E9%83%A8%E7%BD%B2%E6%89%8B%E8%AE%B0/"/>
    <id>https://mxts.jiujiuer.xyz/2023/08/22/ChatGLM%E9%83%A8%E7%BD%B2%E6%89%8B%E8%AE%B0/</id>
    <published>2023-08-22T17:20:56.000Z</published>
    <updated>2024-06-04T16:42:26.930Z</updated>
    
    <content type="html"><![CDATA[<p>这次部署了一次量化后的模型，大概记录一下部署过程和遇到的问题。</p><p>因为显卡显存只有8G，所以部署的是6b的int4量化模型。</p><h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><p>一般是直接从Hugging Face克隆仓库下来。我当时担心速度不够从清华云盘下载的，不过后来克隆发现速度很快，一般应该是不用担心下载速度的。</p><p>首先克隆6b的仓库，然后进入仓库安装依赖：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/THUDM/ChatGLM-6B &amp;&amp; <span class="built_in">cd</span> ChatGLM-6B</span><br><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure><p>然后下载ChatGLM-6B的模型的量化版本。注意，<strong>一定要下载所有的文件</strong>。如果clone不下来，就先把其他小文件下下来，然后在清华网盘下载模型本体：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://huggingface.co/THUDM/chatglm-6b-int4</span><br><span class="line"><span class="comment"># 量化版本地址：https://cloud.tsinghua.edu.cn/d/674208019e314311ab5c/</span></span><br></pre></td></tr></table></figure><p>完成后，更改cli-demo.py和webui-demo.py中的<code>THUDM/chatglm-6b-int4</code>为你本地的路径：<code>/path/to/chatglm-6b-int4</code>即可。</p><p>最后，使用python运行即可：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 webui-demo.py</span><br></pre></td></tr></table></figure><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>如果报错的话，可能是缺少 tokenizer 的相关文件：tokenizer_config.json、special_tokens_map.json、tokenization_chatglm.py 和 ice_text.model。将这些文件（位于你下载的模型的目录中）补全即可解决。</p>]]></content>
    
    
    <summary type="html">这卡总算是用起来了</summary>
    
    
    
    
  </entry>
  
</feed>
